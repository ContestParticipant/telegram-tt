(()=>{"use strict";var e,t,n={38570:(e,t,n)=>{var s={};n.r(s),n.d(s,{Type:()=>uc,clear:()=>pc,fetch:()=>lc,isCacheApiSupported:()=>cc,remove:()=>hc,save:()=>fc});var i={};n.r(i),n.d(i,{abortChatRequests:()=>Oc,abortRequestGroup:()=>qc,acceptBotUrlAuth:()=>Vp,acceptCall:()=>bm,acceptLinkUrlAuth:()=>Wp,acceptPhoneCall:()=>sg,activateStealthMode:()=>Cg,addChatMembers:()=>Lu,allowBotSendMessages:()=>Jp,answerCallbackButton:()=>Mp,applyBoost:()=>Dg,applyGiftCode:()=>Hg,blockUser:()=>Nh,broadcastLocalDbUpdateFull:()=>Fs,changeSessionSettings:()=>Qc,changeSessionTtl:()=>Yc,changeStarsSubscription:()=>Yg,checkBotDownloadFileParams:()=>Xp,checkChatInvite:()=>Fu,checkChatUsername:()=>ch,checkChatlistInvite:()=>ol,checkGiftCode:()=>Bg,checkPassword:()=>bp,checkUsername:()=>Mh,clearPassword:()=>Sp,clearRecentReactions:()=>xm,clearRecentStickers:()=>Lf,clickSponsoredMessage:()=>df,closePoll:()=>Kl,confirmCall:()=>Sm,confirmPhoneCall:()=>ng,convertStarGift:()=>Vg,createChalistInvite:()=>cl,createChannel:()=>uu,createGroupCall:()=>fm,createGroupChat:()=>gu,createPhoneCallState:()=>Xm,createTopic:()=>Zu,deactivateAllUsernames:()=>lh,decodePhoneCallData:()=>tg,deleteChannel:()=>mu,deleteChat:()=>hu,deleteChatFolder:()=>Cu,deleteChatMember:()=>zu,deleteChatUser:()=>fu,deleteChatlistInvite:()=>ul,deleteContact:()=>Af,deleteExportedChatInvite:()=>gh,deleteHistory:()=>Rl,deleteMessages:()=>kl,deleteProfilePhotos:()=>Eh,deleteRevokedExportedChatInvites:()=>Ih,deleteSavedHistory:()=>El,deleteScheduledMessages:()=>Al,deleteStory:()=>fg,deleteTopic:()=>nl,destroy:()=>Rc,destroyPhoneCallState:()=>Zm,discardCall:()=>Im,discardGroupCall:()=>om,disconnect:()=>Ec,downloadMedia:()=>Bc,editChatFolder:()=>ju,editChatPhoto:()=>Iu,editChatlistInvite:()=>ll,editExportedChatInvite:()=>ph,editGroupCallParticipant:()=>am,editGroupCallTitle:()=>rm,editMessage:()=>Cl,editStoryPrivacy:()=>yg,editTopic:()=>il,encodePhoneCallData:()=>eg,exportChatInvite:()=>mh,exportGroupCallInvite:()=>dm,exportMessageLink:()=>bf,faveSticker:()=>qf,fetchAllStories:()=>og,fetchAnimatedEmojiEffects:()=>Wf,fetchAnimatedEmojis:()=>$f,fetchAppConfig:()=>rp,fetchAuthorizations:()=>Hh,fetchAvailableEffects:()=>Mm,fetchAvailableReactions:()=>_m,fetchBlockedUsers:()=>xh,fetchBoostList:()=>xg,fetchBoostStatus:()=>Ug,fetchBotApp:()=>Bp,fetchBotCanSendMessage:()=>Kp,fetchBotsRecommendations:()=>nm,fetchChannelMonetizationStatistics:()=>Om,fetchChannelRecommendations:()=>ml,fetchChannelStatistics:()=>Gm,fetchChat:()=>ou,fetchChatFolders:()=>bu,fetchChatInviteImporters:()=>wh,fetchChatSettings:()=>su,fetchChatlistInvites:()=>fl,fetchChats:()=>eu,fetchCollectionInfo:()=>iI,fetchCommonChats:()=>jf,fetchConfig:()=>dp,fetchContactList:()=>_f,fetchContentSettings:()=>op,fetchCountryList:()=>lp,fetchCurrentUser:()=>Fc,fetchCustomEmoji:()=>Vf,fetchCustomEmojiSets:()=>xf,fetchDefaultStatusEmojis:()=>Yf,fetchDefaultTagReactions:()=>Nm,fetchDefaultTopicIcons:()=>Qf,fetchDiscussionMessage:()=>Fl,fetchEmojiKeywords:()=>ah,fetchExportedChatInvites:()=>hh,fetchExtendedMedia:()=>Ql,fetchFactChecks:()=>Gl,fetchFavoriteStickers:()=>Hf,fetchFeaturedEmojiStickers:()=>Of,fetchFeaturedStickers:()=>Gf,fetchFullChat:()=>nu,fetchFullUser:()=>Sf,fetchGenericEmojiEffects:()=>Kf,fetchGiveawayInfo:()=>Ng,fetchGlobalPrivacySettings:()=>fp,fetchGroupCallParticipants:()=>cm,fetchGroupStatistics:()=>qm,fetchGroupsForDiscussion:()=>Gu,fetchInlineBot:()=>Ap,fetchInlineBotResults:()=>Rp,fetchLangDifference:()=>Jh,fetchLangPack:()=>Kh,fetchLangStrings:()=>Xh,fetchLanguage:()=>Yh,fetchLanguages:()=>Qh,fetchLeaveChatlistSuggestions:()=>rl,fetchMember:()=>Hu,fetchMembers:()=>Bu,fetchMessage:()=>vl,fetchMessagePublicForwards:()=>Lm,fetchMessageReactions:()=>Am,fetchMessageReactionsList:()=>Rm,fetchMessageStatistics:()=>Fm,fetchMessageViews:()=>Hl,fetchMessages:()=>yl,fetchMonetizationRevenueWithdrawalUrl:()=>Wm,fetchMyBoosts:()=>Eg,fetchNearestCountry:()=>Cf,fetchNotificationExceptions:()=>zh,fetchNotificationSettings:()=>Vh,fetchOutboxReadDate:()=>wf,fetchPaidReactionPrivacy:()=>Ol,fetchPeerColors:()=>cp,fetchPeerProfileStories:()=>rg,fetchPeerStories:()=>ag,fetchPeerStoriesByIds:()=>cg,fetchPinnedMessages:()=>tf,fetchPopularAppBots:()=>tm,fetchPremiumGifts:()=>Jf,fetchPremiumPromo:()=>Ag,fetchPreviewMedias:()=>Yp,fetchPrivacySettings:()=>ep,fetchProfilePhotos:()=>Rf,fetchQuickReplies:()=>yf,fetchRecentEmojiStatuses:()=>rh,fetchRecentReactions:()=>Um,fetchRecentStickers:()=>Bf,fetchRecommendedChatFolders:()=>Su,fetchSavedChats:()=>tu,fetchSavedGifs:()=>Zf,fetchSavedReactionTags:()=>Bm,fetchSavedStarGifts:()=>Lg,fetchScheduledHistory:()=>Zl,fetchSeenBy:()=>nf,fetchSendAs:()=>sf,fetchSponsoredMessages:()=>af,fetchStarGiftUpgradePreview:()=>tI,fetchStarGiftWithdrawalUrl:()=>sI,fetchStarGifts:()=>Fg,fetchStarsGiveawayOptions:()=>qg,fetchStarsStatus:()=>Wg,fetchStarsSubscriptions:()=>Qg,fetchStarsTopupOptions:()=>Zg,fetchStarsTransactionById:()=>Jg,fetchStarsTransactions:()=>Kg,fetchStatisticsAsyncGraph:()=>zm,fetchStickerSets:()=>Nf,fetchStickers:()=>zf,fetchStickersForEmoji:()=>oh,fetchStoriesArchive:()=>dg,fetchStoriesMaxIds:()=>bg,fetchStoriesViews:()=>gg,fetchStoryLink:()=>Ig,fetchStoryPublicForwards:()=>$m,fetchStoryStatistics:()=>Vm,fetchStoryViewList:()=>mg,fetchTemporaryPaymentPassword:()=>Rg,fetchTimezones:()=>up,fetchTopBotApps:()=>kp,fetchTopInlineBots:()=>Tp,fetchTopReactions:()=>Dm,fetchTopUsers:()=>Pf,fetchTopicById:()=>tl,fetchTopics:()=>el,fetchUniqueStarGift:()=>eI,fetchUnreadMentions:()=>ff,fetchUnreadReactions:()=>hf,fetchUsers:()=>Mf,fetchWallpapers:()=>Dh,fetchWebAuthorizations:()=>qh,fetchWebPagePreview:()=>$l,findFirstMessageIdAfterDate:()=>Xl,forwardMessages:()=>Yl,fulfillStarsSubscription:()=>Xg,getChatByPhoneNumber:()=>Mu,getChatByUsername:()=>Tu,getDhConfig:()=>gm,getGroupCall:()=>im,getPassword:()=>vp,getPasswordInfo:()=>Ip,getPaymentForm:()=>Tg,getPremiumGiftCodeOptions:()=>Gg,getReceipt:()=>kg,getStarsGiftOptions:()=>Og,getTemporaryPaymentPassword:()=>yp,hideAllChatJoinRequests:()=>vh,hideChatJoinRequest:()=>yh,hideChatReportPane:()=>bh,importChatInvite:()=>Ku,importContact:()=>Tf,installStickerSet:()=>th,invokeWebViewCustomMethod:()=>Qp,joinChannel:()=>lu,joinChatlistInvite:()=>al,joinGroupCall:()=>lm,joinGroupCallPresentation:()=>hm,launchPrepaidGiveaway:()=>$g,leaveChannel:()=>pu,leaveChatlist:()=>dl,leaveGroupCall:()=>um,leaveGroupCallPresentation:()=>mm,loadAttachBot:()=>Fp,loadAttachBots:()=>qp,loadPollOptionResults:()=>Jl,markMessageListRead:()=>Nl,markMessagesRead:()=>Bl,markStoryRead:()=>lg,migrateChat:()=>qu,oldFetchLangPack:()=>Zh,pinMessage:()=>Ml,prolongWebView:()=>Gp,provideAuthCode:()=>nc,provideAuthPassword:()=>sc,provideAuthPhoneNumber:()=>tc,provideAuthRegistration:()=>ic,provideRecoveryEmailCode:()=>Pp,readAllMentions:()=>uf,readAllReactions:()=>lf,receivedCall:()=>vm,registerDevice:()=>tp,removeRecentSticker:()=>Ff,reorderUsernames:()=>mp,repairFileReference:()=>Lc,reportChannelSpam:()=>Ul,reportMessages:()=>Dl,reportMessagesDelivery:()=>ql,reportPeer:()=>Kc,reportProfilePhoto:()=>Jc,reportSpam:()=>Ef,reportSponsoredMessage:()=>cf,reportStory:()=>wg,requestAppWebView:()=>Hp,requestBotUrlAuth:()=>zp,requestCall:()=>wm,requestChannelDifference:()=>Wc,requestChatUpdate:()=>au,requestLinkUrlAuth:()=>$p,requestMainWebView:()=>xp,requestPhoneCall:()=>ig,requestSimpleWebView:()=>Np,requestWebView:()=>Up,rescheduleMessage:()=>Pl,resolveBusinessChatLink:()=>Xc,restartAuth:()=>oc,restartAuthWithQr:()=>ac,saveCloseFriends:()=>Uf,saveDefaultSendAs:()=>of,saveDraft:()=>ru,saveGif:()=>eh,saveStarGift:()=>zg,searchChats:()=>iu,searchGifs:()=>ih,searchHashtagPosts:()=>Vl,searchMessagesGlobal:()=>zl,searchMessagesInChat:()=>Ll,searchStickers:()=>Xf,sendEmojiInteraction:()=>Pm,sendInlineBotResult:()=>Ep,sendMessage:()=>Sl,sendMessageAction:()=>xl,sendPaidReaction:()=>km,sendPaymentForm:()=>_g,sendPollVote:()=>Wl,sendQuickReply:()=>vf,sendReaction:()=>Tm,sendScheduledMessages:()=>ef,sendSignalingData:()=>jm,sendStarPaymentForm:()=>Mg,sendStoryReaction:()=>jg,sendWatchingEmojiInteraction:()=>Cm,sendWebViewData:()=>Op,setAllowHttpTransport:()=>Vc,setBotInfo:()=>em,setCallRating:()=>ym,setChatEnabledReactions:()=>Ju,setChatUsername:()=>uh,setDefaultReaction:()=>Em,setDiscussionGroup:()=>Ou,setForceHttpTransport:()=>zc,setPrivacySettings:()=>sp,setShouldDebugExportedSenders:()=>$c,setViewForumAsMessages:()=>pl,sortChatFolders:()=>Pu,startBot:()=>Dp,terminateAllAuthorizations:()=>Oh,terminateAllWebAuthorizations:()=>Lh,terminateAuthorization:()=>Gh,terminateWebAuthorization:()=>Fh,toggleAttachBot:()=>Lp,toggleChatArchived:()=>vu,toggleChatPinned:()=>wu,toggleDialogUnread:()=>_u,toggleForum:()=>Xu,toggleGroupCallStartSubscription:()=>pm,toggleIsProtected:()=>Qu,toggleJoinRequest:()=>$u,toggleJoinToSend:()=>Vu,toggleParticipantsHidden:()=>Yu,togglePeerTranslations:()=>hl,togglePinnedTopic:()=>sl,togglePreHistoryHidden:()=>Au,toggleSavedDialogPinned:()=>yu,toggleSignatures:()=>Nu,toggleSponsoredMessages:()=>Zc,toggleStoriesHidden:()=>vg,toggleStoryInProfile:()=>hg,toggleStoryPinnedToTop:()=>pg,toggleUserEmojiStatusPermission:()=>Zp,toggleUsername:()=>pp,transcribeAudio:()=>pf,translateText:()=>mf,unblockUser:()=>Bh,uninstallStickerSet:()=>nh,unpinAllMessages:()=>Tl,unregisterDevice:()=>np,updateChatAbout:()=>xu,updateChatAdmin:()=>Du,updateChatDefaultBannedRights:()=>Ru,updateChatMemberBannedRights:()=>Eu,updateChatMutedState:()=>du,updateChatTitle:()=>Uu,updateContact:()=>kf,updateContactSignUpNotification:()=>$h,updateContentSettings:()=>ap,updateEmojiStatus:()=>Df,updateGlobalPrivacySettings:()=>hp,updateIsOnline:()=>ip,updateNotificationSettings:()=>Wh,updatePassword:()=>jp,updatePrivateLink:()=>fh,updateProfile:()=>_h,updateProfilePhoto:()=>kh,updateRecoveryEmail:()=>Cp,updateSavedReactionTag:()=>Hm,updateTopicMutedState:()=>cu,updateUsername:()=>Th,upgradeGift:()=>nI,uploadContactProfilePhoto:()=>Rh,uploadProfilePhoto:()=>Ah,uploadWallpaper:()=>Uh,validateRequestedInfo:()=>Pg,viewSponsoredMessage:()=>rf,viewStory:()=>ug});const o="A",a=!1,r=!1,d=!1,c="https://telegram-a-host",u=!1,l="tt-media",f="tt-media-avatars",h=524288,p=16,m=16,g=("undefined"!=typeof window&&window.innerHeight,20),I=200,w=50,y=100,v=100,b=100,S=100,j=50,C=100,P=50,_=100,M=100,T=100,k=20,A=3e5,R="XTR",E=2**31-1,D=Math.round(450),U=new Set(["newMessage","newScheduledMessage","deleteMessages","deleteScheduledMessages","deleteHistory"]),x=20,N=20,B="status-default-icon",H="video/webm",G="image/gif",O="application/x-tgsticker",q=H,F=new Set(["image/png","image/jpeg",G]),L=new Set(["video/mp4","video/quicktime"]),z=new Set(["audio/mp3","audio/ogg","audio/wav","audio/mpeg","audio/flac","audio/aac","audio/m4a","audio/mp4","audio/x-m4a"]),V=(new Set([...F,...L]),"MESSAGE_ID_REQUIRED"),$=new Set(["USERNAME_PURCHASE_AVAILABLE","USERNAME_INVALID"]),W=(new Set(["t.me","web.t.me","a.t.me","k.t.me","z.t.me"]),"weba"),K="weba",J=(new Set(["AU","BD","CA","CO","EG","HN","IE","IN","JO","MX","MY","NI","NZ","PH","PK","SA","SV","US"]),"777000"),Q=14,Y="gif",X=0,Z=1,ee="-1000000000777",te=1,ne=86400,se=86400,ie=11,oe=(new Set(["USER_CANCELED"]),{uploadMaxFileparts:[4e3,8e3],stickersFaved:[5,10],savedGifs:[200,400],dialogFiltersChats:[100,200],dialogFilters:[10,20],dialogFolderPinned:[5,10],captionLength:[1024,4096],channels:[500,1e3],channelsPublic:[10,20],aboutLength:[70,140],chatlistInvites:[3,100],chatlistJoined:[2,20],recommendedChannels:[10,100],savedDialogsPinned:[5,100]}),ae=["log","error","warn","info","debug"];function re(e,t,n=!0){let s,i,o;return(...a)=>{i=!0,o=a,s||(n&&(i=!1,e(...o)),s=self.setInterval((()=>{if(!i)return self.clearInterval(s),void(s=void 0);i=!1,e(...o)}),t))}}function de(e){return function(e,t){let n,s=!1;return(...i)=>{n=i,s||(s=!0,e((()=>{s=!1,t(...n)})))}}(le,e)}ae.reduce(((e,t)=>(e[t]=console[t],e)),{});const ce=e=>new Promise((t=>{setTimeout((()=>t()),e)}));let ue;function le(e){ue?ue.push(e):(ue=[e],Promise.resolve().then((()=>{const e=ue;ue=void 0,e.forEach((e=>e()))})))}var fe=n(17473);function he(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class pe extends Error{constructor(e,t,n){super("RPCError {0}: {1}{2}".replace("{0}",n?.toString()||"").replace("{1}",e).replace("{2}",pe._fmtRequest(t))),he(this,"code",void 0),he(this,"errorMessage",void 0),this.code=n,this.errorMessage=e}static _fmtRequest(e){return e?` (caused by ${e.className})`:""}}class me extends pe{constructor(e,t,n){super(e,t,n),this.code=n||303,this.errorMessage=e||"ERROR_SEE_OTHER"}}class ge extends pe{constructor(...e){super(...e),he(this,"code",400),he(this,"errorMessage","BAD_REQUEST")}}class Ie extends pe{constructor(...e){super(...e),he(this,"code",420),he(this,"errorMessage","FLOOD")}}class we extends pe{constructor(...e){super(...e),he(this,"code",500),he(this,"errorMessage","INTERNAL")}}class ye extends pe{constructor(...e){super(...e),he(this,"code",503),he(this,"errorMessage","Timeout")}}function ve(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class be extends me{constructor(e){const t=Number(e.capture||0);super(`The user whose identity is being used to execute queries is associated with DC ${t}${pe._fmtRequest(e.request)}`,e.request),ve(this,"newDc",void 0),this.message=`The user whose identity is being used to execute queries is associated with DC ${t}${pe._fmtRequest(e.request)}`,this.newDc=t}}class Se extends me{constructor(e){const t=Number(e.capture||0);super(`The phone number a user is trying to use for authorization is associated with DC ${t}${pe._fmtRequest(e.request)}`,e.request),ve(this,"newDc",void 0),this.message=`The phone number a user is trying to use for authorization is associated with DC ${t}${pe._fmtRequest(e.request)}`,this.newDc=t}}class je extends Ie{constructor(e){const t=Number(e.capture||0);super(`A wait of ${t} seconds is required${pe._fmtRequest(e.request)}`,e.request),ve(this,"seconds",void 0),this.message=`A wait of ${t} seconds is required${pe._fmtRequest(e.request)}`,this.seconds=t}}class Ce extends je{constructor(e){const t=Number(e.capture||0);super(`A wait of ${t} seconds is required${pe._fmtRequest(e.request)}`),this.message=`A wait of ${t} seconds is required${pe._fmtRequest(e.request)}`,this.seconds=t}}class Pe extends Ie{constructor(e){super(`Message failed to be sent.${pe._fmtRequest(e.request)}`,e.request),this.message=`Message failed to be sent.${pe._fmtRequest(e.request)}`}}class _e extends Ie{constructor(e){const t=Number(e.capture||0);super(`A wait of ${t} seconds is required in the test servers${pe._fmtRequest(e.request)}`,e.request),ve(this,"seconds",void 0),this.message=`A wait of ${t} seconds is required in the test servers${pe._fmtRequest(e.request)}`,this.seconds=t}}class Me extends me{constructor(e){const t=Number(e.capture||0);super(`The source IP address is associated with DC ${t}${pe._fmtRequest(e.request)}`,e.request),ve(this,"newDc",void 0),this.message=`The source IP address is associated with DC ${t}${pe._fmtRequest(e.request)}`,this.newDc=t}}class Te extends ge{constructor(e){const t=Number(e.capture||0);super(`Email unconfirmed, the length of the code must be ${t}${pe._fmtRequest(e.request)}`,e.request,400),ve(this,"codeLength",void 0),this.message=`Email unconfirmed, the length of the code must be ${t}${pe._fmtRequest(e.request)}`,this.codeLength=t}}class ke extends ge{constructor(e){const t=Number(e.capture||0);super(`The password was modified less than 24 hours ago, try again in ${t} seconds.`,e.request),ve(this,"seconds",void 0),this.message=`The password was modified less than 24 hours ago, try again in ${t} seconds.`,this.seconds=t}}const Ae=new Map([[/FILE_MIGRATE_(\d+)/,class extends me{constructor(e){const t=Number(e.capture||0);super(`The file to be accessed is currently stored in DC ${t}${pe._fmtRequest(e.request)}`,e.request),ve(this,"newDc",void 0),this.message=`The file to be accessed is currently stored in DC ${t}${pe._fmtRequest(e.request)}`,this.newDc=t}}],[/FLOOD_TEST_PHONE_WAIT_(\d+)/,_e],[/FLOOD_WAIT_(\d+)/,je],[/FLOOD_PREMIUM_WAIT_(\d+)/,Ce],[/MSG_WAIT_(.*)/,Pe],[/PHONE_MIGRATE_(\d+)/,Se],[/SLOWMODE_WAIT_(\d+)/,class extends Ie{constructor(e){const t=Number(e.capture||0);super(`A wait of ${t} seconds is required before sending another message in this chat ${pe._fmtRequest(e.request)}`,e.request),ve(this,"seconds",void 0),this.message=`A wait of ${t} seconds is required before sending another message in this chat${pe._fmtRequest(e.request)}`,this.seconds=t}}],[/USER_MIGRATE_(\d+)/,be],[/NETWORK_MIGRATE_(\d+)/,Me],[/EMAIL_UNCONFIRMED_(\d+)/,Te],[/PASSWORD_TOO_FRESH_(\d+)/,ke],[/^Timeout$/,ye]]);function Re(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Error;class Ee extends Error{constructor(e,t){super(`Could not find a matching Constructor ID for the TLObject that was supposed to be\n        read with ID ${e}. Most likely, a TLObject was trying to be read when\n         it should not be read. Remaining bytes: ${t.length}`),Re(this,"invalidConstructorId",void 0),Re(this,"remaining",void 0),"undefined"!=typeof alert&&alert(`Missing MTProto Entity: Please, make sure to add TL definition for ID ${e}`),this.invalidConstructorId=e,this.remaining=t}}Error;class De extends Error{constructor(e){let t;4===e.length?(t=-e.readInt32LE(0),super(`Invalid response buffer (HTTP code ${t})`),Re(this,"code",void 0),Re(this,"payload",void 0)):(super(`Invalid response buffer (too short ${e})`),Re(this,"code",void 0),Re(this,"payload",void 0)),this.code=t,this.payload=e}}class Ue extends Error{constructor(...e){e.length||(e=["A security check failed."]),super(...e)}}class xe extends Error{constructor(e,t){let n=xe.ErrorMessages[t]||`Unknown error code (this should not happen): ${t}.`;n+=`  Caused by ${e.className}`,super(n),Re(this,"code",void 0),Re(this,"errorMessage",void 0),this.errorMessage=n,this.code=t}}function Ne(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Re(xe,"ErrorMessages",{16:"msg_id too low (most likely, client time is wrong it would be worthwhile to synchronize it using msg_id notifications and re-send the original message with the “correct” msg_id or wrap it in a container with a new msg_id if the original message had waited too long on the client to be transmitted).",17:"msg_id too high (similar to the previous case, the client time has to be synchronized, and the message re-sent with the correct msg_id).",18:"Incorrect two lower order msg_id bits (the server expects client message msg_id to be divisible by 4).",19:"Container msg_id is the same as msg_id of a previously received message (this must never happen).",20:"Message too old, and it cannot be verified whether the server has received a message with this msg_id or not.",32:"msg_seqno too low (the server has already received a message with a lower msg_id but with either a higher or an equal and odd seqno).",33:"msg_seqno too high (similarly, there is a message with a higher msg_id but with either a lower or an equal and odd seqno).",34:"An even msg_seqno expected (irrelevant message), but odd received.",35:"Odd msg_seqno expected (relevant message), but even received.",48:"Incorrect server salt (in this case, the bad_server_salt response is received with the correct salt, and the message is to be re-sent with it).",64:"Invalid container."});class Be{constructor(){Ne(this,"_queue",void 0),Ne(this,"canGet",void 0),Ne(this,"resolveGet",void 0),Ne(this,"canPush",void 0),Ne(this,"resolvePush",void 0),this._queue=[],this.resolvePush=()=>{},this.resolveGet=()=>{},this.canGet=new Promise((e=>{this.resolveGet=e})),this.canPush=!0}async push(e){await this.canPush,this._queue.push(e),this.resolveGet(!0),this.canPush=new Promise((e=>{this.resolvePush=e}))}async pop(){await this.canGet;const e=this._queue.pop();return this.resolvePush(!0),this.canGet=new Promise((e=>{this.resolveGet=e})),e}}var He=n(47337),Ge=n(41514);function Oe(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class qe{constructor(e){Oe(this,"CONSTRUCTOR_ID",void 0),Oe(this,"messages",void 0),Oe(this,"classType",void 0),this.CONSTRUCTOR_ID=1945237724,this.messages=e,this.classType="constructor"}static fromReader(e){const t=[],n=e.readInt();for(let s=0;s<n;s++){const n=e.readLong(),s=e.readInt(),i=e.readInt(),o=e.tellPosition(),a=e.tgReadObject();e.setPosition(o+i);const r=new Ge.A(n,s,a);t.push(r)}return new qe(t)}}Oe(qe,"CONSTRUCTOR_ID",1945237724),Oe(qe,"classType","constructor"),Oe(qe,"MAXIMUM_SIZE",1044448),Oe(qe,"MAXIMUM_LENGTH",100);var Fe=n(84735);const Le=new Map([[Fe.A.CONSTRUCTOR_ID,Fe.A],[He.A.CONSTRUCTOR_ID,He.A],[qe.CONSTRUCTOR_ID,qe]]);var ze=n(91157);const Ve={};for(const e of Object.values(fe.jI))if("CONSTRUCTOR_ID"in e)Ve[e.CONSTRUCTOR_ID]=e;else for(const t of Object.values(e))Ve[t.CONSTRUCTOR_ID]=t;function $e(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class We{constructor(e){$e(this,"stream",void 0),$e(this,"_last",void 0),$e(this,"offset",void 0),this.stream=e,this._last=void 0,this.offset=0}readByte(){return this.read(1)[0]}readInt(e=!0){let t;return t=e?this.stream.readInt32LE(this.offset):this.stream.readUInt32LE(this.offset),this.offset+=4,t}readLong(e=!0){return this.readLargeInt(64,e)}readFloat(){return this.read(4).readFloatLE(0)}readDouble(){return this.read(8).readDoubleLE(0)}readLargeInt(e,t=!0){const n=this.read(Math.floor(e/8));return(0,ze.op)(n,!0,t)}read(e=-1){-1===e&&(e=this.stream.length-this.offset);const t=this.stream.slice(this.offset,this.offset+e);if(this.offset+=e,t.length!==e)throw Error(`No more data left to read (need ${e}, got ${t.length}: ${t}); last read ${this._last}`);return this._last=t,t}getBuffer(){return this.stream}tgReadBytes(){const e=this.readByte();let t,n;254===e?(n=this.readByte()|this.readByte()<<8|this.readByte()<<16,t=n%4):(n=e,t=(n+1)%4);const s=this.read(n);return t>0&&(t=4-t,this.read(t)),s}tgReadString(){return this.tgReadBytes().toString("utf-8")}tgReadBool(){const e=this.readInt(!1);if(2574415285===e)return!0;if(3162085175===e)return!1;throw new Error(`Invalid boolean code ${e.toString(16)}`)}tgReadDate(){const e=this.readInt();return new Date(1e3*e)}tgReadObject(){const e=this.readInt(!1);let t=Ve[e];if(void 0===t){if(2574415285===e)return!0;if(3162085175===e)return!1;if(481674261===e){const e=[],t=this.readInt();for(let n=0;n<t;n++)e.push(this.tgReadObject());return e}if(t=Le.get(e),void 0===t){this.seek(-4);const t=this.tellPosition(),n=new Ee(e,this.read());throw this.setPosition(t),n}}return t.fromReader(this)}tgReadVector(){if(481674261!==this.readInt(!1))throw new Error("Invalid constructor code, vector was expected");const e=this.readInt(),t=[];for(let n=0;n<e;n++)t.push(this.tgReadObject());return t}tellPosition(){return this.offset}setPosition(e){this.offset=e}seek(e){this.offset+=e}}var Ke=n(48287).hp;class Je{constructor(e){var t,n,s,i;t=this,s=void 0,(n="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n="_buffers"))?i:i+"")in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,this._buffers=[e]}write(e){this._buffers.push(e)}getValue(){return Ke.concat(this._buffers)}}var Qe,Ye=n(48287).hp;function Xe(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ze=new Error("HttpStream was closed");(Qe=AbortSignal).timeout??(Qe.timeout=function(e){const t=new AbortController;return setTimeout((()=>t.abort()),e),t.signal});class et{constructor(e){Xe(this,"url",void 0),Xe(this,"isClosed",void 0),Xe(this,"stream",[]),Xe(this,"canRead",Promise.resolve()),Xe(this,"resolveRead",void 0),Xe(this,"rejectRead",void 0),Xe(this,"disconnectedCallback",void 0),this.isClosed=!0,this.disconnectedCallback=e}async readExactly(e){let t=Ye.alloc(0);for(;;){const n=await this.read();if(t=Ye.concat([t,n]),(e-=n.length)<=0)return t}}async read(){await this.canRead;const e=this.stream.shift();return 0===this.stream.length&&(this.canRead=new Promise(((e,t)=>{this.resolveRead=e,this.rejectRead=t}))),e}static getURL(e,t,n,s){return 443===t?`https://${e}:${t}/apiw1${n?"_test":""}${s?"_premium":""}`:`http://${e}:${t}/apiw1${n?"_test":""}${s?"_premium":""}`}async connect(e,t,n=!1,s=!1){this.stream=[],this.canRead=new Promise(((e,t)=>{this.resolveRead=e,this.rejectRead=t})),this.url=et.getURL(t,e,n,s),await fetch(this.url,{method:"POST",body:Ye.from([]),mode:"cors",signal:AbortSignal.timeout(1e4)}),this.isClosed=!1}write(e){if(this.isClosed||!this.url)throw this.handleDisconnect(),Ze;return fetch(this.url,{method:"POST",body:e,mode:"cors",signal:AbortSignal.timeout(1e4)}).then((async e=>{if(this.isClosed)return void this.handleDisconnect();if(200!==e.status)throw Ze;const t=await e.arrayBuffer();this.stream=this.stream.concat(Ye.from(t)),this.resolveRead&&!this.isClosed&&this.resolveRead()})).catch((e=>{throw this.handleDisconnect(),e}))}handleDisconnect(){this.disconnectedCallback?.(),this.rejectRead&&this.rejectRead()}close(){this.isClosed=!0,this.handleDisconnect(),this.disconnectedCallback=void 0}}function tt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let nt;class st{constructor(e){tt(this,"colors",void 0),tt(this,"messageFormat",void 0),nt||(nt=e||"debug"),this.colors={start:"%c",warn:"color : #ff00ff",info:"color : #ffff00",debug:"color : #00ffff",error:"color : #ff0000",end:""},this.messageFormat="[%t] [%l] - [%m]"}static setLevel(e){nt=e}canSend(e){return!!nt&&st.LEVEL_MAP.get(nt).has(e)}warn(e){this._log("warn",e,this.colors.warn)}info(e){this._log("info",e,this.colors.info)}debug(e){this._log("debug",e,this.colors.debug)}error(e){this._log("error",e,this.colors.error)}format(e,t){return this.messageFormat.replace("%t",(new Date).toISOString()).replace("%l",t.toUpperCase()).replace("%m",e)}_log(e,t,n){nt&&this.canSend(e)&&console.log(this.colors.start+this.format(t,e),n)}}tt(st,"LEVEL_MAP",new Map([["error",new Set(["error"])],["warn",new Set(["error","warn"])],["info",new Set(["error","warn","info"])],["debug",new Set(["error","warn","info","debug"])]]));var it=n(48287).hp;function ot(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const at=new Set(["messages.SendMessage","messages.SendMedia","messages.SendMultiMedia","messages.ForwardMessages","messages.SendInlineBotResult"]);class rt{constructor(e,t){ot(this,"_state",void 0),ot(this,"_pendingStates",void 0),ot(this,"_queue",void 0),ot(this,"_ready",void 0),ot(this,"setReady",void 0),ot(this,"_log",void 0),this._state=e,this._queue=[],this._pendingStates=[],this._ready=new Promise((e=>{this.setReady=e})),this._log=t}values(){return this._queue}clear(){this._queue=[],this.append(void 0)}append(e,t=!0,n=!1){if(e&&at.has(e.request.className))if(n){for(let t=0;t<this._queue.length;t++)if(at.has(this._queue[t]?.request.className)){this._queue[t].after=e;break}}else for(let t=this._queue.length-1;t>=0;t--)if(at.has(this._queue[t]?.request.className)){e.after=this._queue[t];break}n?this._queue.unshift(e):this._queue.push(e),t&&this.setReady?.(!0),e&&1658238041!==e.request.CONSTRUCTOR_ID&&(this._pendingStates.push(e),e.promise?.catch((()=>{})).finally((()=>{this._pendingStates=this._pendingStates.filter((t=>t!==e))})))}prepend(e){e.reverse().forEach((e=>{this.append(e,!1,!0)})),this.setReady?.(!0)}extend(e){e.forEach((e=>{this.append(e,!1)})),this.setReady?.(!0)}async getBeacon(e){const t=new Je(it.alloc(0));if(e.data.length+Ge.A.SIZE_OVERHEAD<=qe.MAXIMUM_SIZE){let n;return e.after&&(n=e.after.msgId),e.msgId=await this._state.writeDataAsMessage(t,e.data,"request"===e.request.classType,n),this._log.debug(`Assigned msgId = ${e.msgId} to ${e.request.className||e.request.constructor.name}`),t.getValue()}this._log.warn(`Message payload for ${e.request.className||e.request.constructor.name} is too long ${e.data.length} and cannot be sent`),e.reject?.(new Error("Request Payload is too big"))}async wait(){this._queue.length||(this._ready=new Promise((e=>{this.setReady=e})),await this._ready)}async get(){if(!this._queue[this._queue.length-1])return void(this._queue=this._queue.filter(Boolean));let e,t=new Je(it.alloc(0));const n=[];let s=0;for(;this._queue.length&&n.length<=qe.MAXIMUM_LENGTH;){const e=this._queue.shift();if(e)if(e.abortSignal?.aborted)e.reject?.(new Error("Request aborted"));else if(s+=e.data.length+Ge.A.SIZE_OVERHEAD,s<=qe.MAXIMUM_SIZE){let s;e.after&&(s=e.after.msgId),e.msgId=await this._state.writeDataAsMessage(t,e.data,"request"===e.request.classType,s),this._log.debug(`Assigned msgId = ${e.msgId} to ${e.request.className||e.request.constructor.name}`),n.push(e)}else{if(n.length){this._queue.unshift(e);break}this._log.warn(`Message payload for ${e.request.className||e.request.constructor.name} is too long ${e.data.length} and cannot be sent`),e.reject?.(new Error("Request Payload is too big")),s=0}}if(n.length){if(n.length>1){const s=it.alloc(8);s.writeUInt32LE(qe.CONSTRUCTOR_ID,0),s.writeInt32LE(n.length,4),e=it.concat([s,t.getValue()]),t=new Je(it.alloc(0));const i=await this._state.writeDataAsMessage(t,e,!1);for(const e of n)e.containerId=i}return e=t.getValue(),{batch:n,data:e}}}}var dt=n(80129),ct=n(48287).hp;function ut(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const lt=new dt.eu,ft=new Error("WebSocket was closed");class ht{constructor(e){ut(this,"closed",void 0),ut(this,"timeout",void 0),ut(this,"stream",void 0),ut(this,"canRead",void 0),ut(this,"resolveRead",void 0),ut(this,"client",void 0),ut(this,"website",void 0),ut(this,"disconnectedCallback",void 0),this.client=void 0,this.closed=!0,this.stream=ct.alloc(0),this.disconnectedCallback=e,this.timeout=3e3}async readExactly(e){let t=ct.alloc(0);for(;;){const n=await this.read(e);if(t=ct.concat([t,n]),!(e-=n.length))return t}}async read(e){if(this.closed)throw ft;if(await this.canRead,this.closed)throw ft;const t=this.stream.slice(0,e);return this.stream=this.stream.slice(e),0===this.stream.length&&(this.canRead=new Promise((e=>{this.resolveRead=e}))),t}async readAll(){if(this.closed||!await this.canRead)throw ft;const e=this.stream;return this.stream=ct.alloc(0),this.canRead=new Promise((e=>{this.resolveRead=e})),e}getWebSocketLink(e,t,n,s){return 443===t?`wss://${e}:${t}/apiws${n?"_test":""}${s?"_premium":""}`:`ws://${e}:${t}/apiws${n?"_test":""}${s?"_premium":""}`}connect(e,t,n=!1,s=!1){return this.stream=ct.alloc(0),this.canRead=new Promise((e=>{this.resolveRead=e})),this.closed=!1,this.website=this.getWebSocketLink(t,e,n,s),this.client=new WebSocket(this.website,"binary"),new Promise(((e,n)=>{if(!this.client)return;let s,i=!1;this.client.onopen=()=>{this.receive(),e(this),i=!0,s&&clearTimeout(s)},this.client.onerror=e=>{console.error("WebSocket error",e),n(e),i=!0,s&&clearTimeout(s)},this.client.onclose=e=>{const{code:n,reason:o,wasClean:a}=e;1e3!==n&&console.error(`Socket ${t} closed. Code: ${n}, reason: ${o}, was clean: ${a}`),this.resolveRead?.(!1),this.closed=!0,this.disconnectedCallback&&this.disconnectedCallback(),i=!0,s&&clearTimeout(s)},s=setTimeout((()=>{i||(n(new Error("WebSocket connection timeout")),this.resolveRead?.(!1),this.closed=!0,this.disconnectedCallback&&this.disconnectedCallback(),this.client?.close(),this.timeout*=2,this.timeout=Math.min(this.timeout,3e4),s=void 0)}),this.timeout),self.addEventListener("offline",(async()=>{await this.close(),this.resolveRead?.(!1)}))}))}write(e){if(this.closed)throw ft;this.client?.send(e)}async close(){await(this.client?.close()),this.closed=!0}receive(){this.client&&(this.client.onmessage=async e=>{await lt.runExclusive((async()=>{const t=e.data instanceof ArrayBuffer?ct.from(e.data):ct.from(await new Response(e.data).arrayBuffer());this.stream=ct.concat([this.stream,t]),this.resolveRead?.(!0)}))})}}function pt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mt{constructor({ip:e,port:t,dcId:n,loggers:s,isPremium:i,isTestServer:o}){pt(this,"PacketCodecClass",void 0),pt(this,"_ip",void 0),pt(this,"_port",void 0),pt(this,"_dcId",void 0),pt(this,"_log",void 0),pt(this,"_connected",void 0),pt(this,"_isPremium",void 0),pt(this,"shouldLongPoll",void 0),pt(this,"_sendTask",void 0),pt(this,"_recvTask",void 0),pt(this,"_codec",void 0),pt(this,"_obfuscation",void 0),pt(this,"_sendArray",void 0),pt(this,"_recvArray",void 0),pt(this,"socket",void 0),pt(this,"_isTestServer",void 0),this._ip=e,this._port=t,this._dcId=n,this._log=s,this._isTestServer=o,this._isPremium=i,this._connected=!1,this._sendTask=void 0,this._recvTask=void 0,this._codec=void 0,this._obfuscation=void 0,this._sendArray=new Be,this._recvArray=new Be,this.shouldLongPoll=!1,this.socket=new ht(this.disconnectCallback.bind(this))}isConnected(){return this._connected}async disconnectCallback(){await this.disconnect(!0)}async _connect(){this._log.debug("Connecting"),this._codec=new this.PacketCodecClass(this),await this.socket.connect(this._port,this._ip,this._isTestServer,this._isPremium),this._log.debug("Finished connecting"),await this._initConn()}async connect(){await this._connect(),this._connected=!0,this._sendTask||(this._sendTask=this._sendLoop()),this._recvTask=this._recvLoop()}async disconnect(e=!1){this._connected&&(this._connected=!1,this._recvArray.push(void 0),e||await this.socket.close())}async send(e){if(!this._connected)throw new Error("Not connected");await this._sendArray.push(e)}async recv(){for(;this._connected;){const e=await this._recvArray.pop();if(e)return e}throw new Error("Not connected")}async _sendLoop(){try{for(;this._connected;){const e=await this._sendArray.pop();if(!e)return void(this._sendTask=void 0);await this._send(e)}}catch(e){this._log.info("The server closed the connection while sending")}}async _recvLoop(){let e;for(;this._connected;){try{if(e=await this._recv(),!e)throw new Error("no data received")}catch(e){return this._log.info("connection closed"),void this.disconnect()}await this._recvArray.push(e)}}async _initConn(){this._codec.tag&&await this.socket.write(this._codec.tag)}_send(e){const t=this._codec.encodePacket(e);this.socket.write(t)}_recv(){return this._codec.readPacket(this.socket)}toString(){return`${this._ip}:${this._port}/${this.constructor.name.replace("Connection","")}`}}class gt extends mt{constructor(...e){super(...e),pt(this,"ObfuscatedIO",void 0)}async _initConn(){this._obfuscation=new this.ObfuscatedIO(this),this.socket.write(this._obfuscation.header)}_send(e){this._obfuscation.write(this._codec.encodePacket(e))}_recv(){return this._codec.readPacket(this._obfuscation)}}class It{constructor(e){pt(this,"_conn",void 0),this._conn=e}encodePacket(e){throw new Error("Not Implemented")}readPacket(e){throw new Error("Not Implemented")}}class wt extends mt{constructor(e){super(e),pt(this,"socket",void 0),pt(this,"href",void 0),this.shouldLongPoll=!0,this.socket=new et(this.disconnectCallback.bind(this)),this.href=et.getURL(this._ip,this._port,this._isTestServer,this._isPremium)}send(e){return this.socket.write(e)}recv(){return this.socket.read()}async _connect(){this._log.debug("Connecting"),await this.socket.connect(this._port,this._ip,this._isTestServer,this._isPremium),this._log.debug("Finished connecting")}async connect(){await this._connect(),this._connected=!0}}var yt=n(92096),vt=n.n(yt),bt=n(48287).hp;function St(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class jt extends It{constructor(e){super(e),St(this,"tag",void 0),St(this,"obfuscateTag",void 0),this.tag=jt.tag,this.obfuscateTag=jt.obfuscateTag}encodePacket(e){const t=e.length>>2;let n;if(t<127){const e=bt.alloc(1);e.writeUInt8(t,0),n=e}else n=bt.concat([bt.from("7f","hex"),(0,ze.YT)(vt()(t),3)]);return bt.concat([n,e])}async readPacket(e){let t=(await e.read(1))[0];return t>=127&&(t=bt.concat([await e.read(3),bt.alloc(1)]).readInt32LE(0)),e.read(t<<2)}}St(jt,"tag",bt.from("ef","hex")),St(jt,"obfuscateTag",bt.from("efefefef","hex"));var Ct=n(33313),Pt=n(48287).hp;function _t(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Mt{constructor(e,t){if(_t(this,"cipher",void 0),_t(this,"decipher",void 0),!Pt.isBuffer(e)||!Pt.isBuffer(t)||16!==t.length)throw new Error("Key and iv need to be a buffer");this.cipher=(0,Ct.Tt)("AES-256-CTR",e,t),this.decipher=(0,Ct._7)("AES-256-CTR",e,t)}encrypt(e){return Pt.from(this.cipher.update(e))}decrypt(e){return Pt.from(this.decipher.update(e))}}var Tt=n(48287).hp;function kt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class At{constructor(e){kt(this,"header",void 0),kt(this,"connection",void 0),kt(this,"_encrypt",void 0),kt(this,"_decrypt",void 0),this.connection=e.socket;const t=this.initHeader(e.PacketCodecClass);this.header=t.random,this._encrypt=t.encryptor,this._decrypt=t.decryptor}initHeader(e){const t=[Tt.from("50567247","hex"),Tt.from("474554","hex"),Tt.from("504f5354","hex"),Tt.from("eeeeeeee","hex")];let n;for(;;)if(n=(0,ze.Gg)(64),239!==n[0]&&!n.slice(4,8).equals(Tt.alloc(4))){let e=!0;for(const s of t)if(s.equals(n.slice(0,4))){e=!1;break}if(e)break}n=n.toJSON().data;const s=Tt.from(n.slice(8,56)).reverse(),i=Tt.from(n.slice(8,40)),o=Tt.from(n.slice(40,56)),a=Tt.from(s.slice(0,32)),r=Tt.from(s.slice(32,48)),d=new Mt(i,o),c=new Mt(a,r);return n=Tt.concat([Tt.from(n.slice(0,56)),e.obfuscateTag,Tt.from(n.slice(60))]),n=Tt.concat([Tt.from(n.slice(0,56)),Tt.from(d.encrypt(n).slice(56,64)),Tt.from(n.slice(64))]),{random:n,encryptor:d,decryptor:c}}async read(e){const t=await this.connection.readExactly(e);return this._decrypt.encrypt(t)}write(e){this.connection.write(this._encrypt.encrypt(e))}}function Rt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Et{constructor(e){Rt(this,"state",void 0),this.state=e}}Rt(Et,"disconnected",-1),Rt(Et,"connected",1),Rt(Et,"broken",0);class Dt{constructor(e){Rt(this,"timeOffset",void 0),this.timeOffset=e}}var Ut=n(7692),xt=n(48287).hp;class Nt{constructor(e,t){(function(e,t,n){var s;(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})(this,"ige",void 0),this.ige=new Ut.gj(e,t)}decryptIge(e){return(0,ze.Jk)(this.ige.decrypt(e))}encryptIge(e){const t=e.length%16;return t&&(e=xt.concat([e,(0,ze.Gg)(16-t)])),(0,ze.Jk)(this.ige.encrypt(e))}}var Bt=n(48287).hp;function Ht(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Gt{constructor(e,t,n=!1,s=!1){Ht(this,"authKey",void 0),Ht(this,"_log",void 0),Ht(this,"timeOffset",void 0),Ht(this,"salt",void 0),Ht(this,"id",void 0),Ht(this,"_sequence",void 0),Ht(this,"_isCall",void 0),Ht(this,"_isOutgoing",void 0),Ht(this,"_lastMsgId",void 0),Ht(this,"msgIds",void 0),this.authKey=e,this._log=t,this._isCall=n,this._isOutgoing=s,this.timeOffset=0,this.salt=vt().zero,this.id=vt().zero,this._sequence=0,this._lastMsgId=vt().zero,this.msgIds=[],this.reset()}reset(){this.id=(0,ze.by)(!0),this._sequence=0,this._lastMsgId=vt()(0),this.msgIds=[]}updateMessageId(e){e.msgId=this._getNewMsgId()}async _calcKey(e,t,n){const s=this._isCall?128+(this._isOutgoing!==n?8:0):n?0:8,[i,o]=await Promise.all([(0,ze.sc)(Bt.concat([t,e.slice(s,s+36)])),(0,ze.sc)(Bt.concat([e.slice(s+40,s+76),t]))]),a=Bt.concat([i.slice(0,8),o.slice(8,24),i.slice(24,32)]);return this._isCall?{key:a,iv:Bt.concat([o.slice(0,4),i.slice(8,16),o.slice(24,28)])}:{key:a,iv:Bt.concat([o.slice(0,8),i.slice(8,24),o.slice(24,32)])}}async writeDataAsMessage(e,t,n,s){const i=this._getNewMsgId(),o=this._getSeqNo(n);let a;a=s?await He.A.gzipIfSmaller(n,new fe.jI.InvokeAfterMsg({msgId:s,query:{getBytes:()=>t}}).getBytes()):await He.A.gzipIfSmaller(n,t);const r=Bt.alloc(4);r.writeInt32LE(o,0);const d=Bt.alloc(4);d.writeInt32LE(a.length,0);const c=(0,ze.yr)(i,8);return e.write(Bt.concat([c,r,d])),e.write(a),i}async encryptMessageData(e){if(!this.authKey)throw new Error("Auth key unset");await this.authKey.waitForKey();const t=this.authKey.getKey();if(!t)throw new Error("Auth key unset");if(!(this.salt&&this.id&&t&&this.authKey.keyId))throw new Error("Unset params");if(this._isCall){const n=128+(this._isOutgoing?0:8),s=e.length;e=Bt.from(e),s%4!=0&&(e=Bt.concat([e,Bt.from(new Array(4-s%4).fill(32))]));const i=(await(0,ze.sc)(Bt.concat([t.slice(88+n,88+n+32),Bt.from(e)]))).slice(8,24),{iv:o,key:a}=await this._calcKey(t,i,!0);return e=new Mt(a,o).encrypt(e),Bt.concat([i,e])}{const n=(0,ze.yr)(this.salt,8),s=(0,ze.yr)(this.id,8);e=Bt.concat([Bt.concat([n,s]),e]);const i=(0,ze.Gg)((0,ze.zi)(-(e.length+12),16)+12),o=(await(0,ze.sc)(Bt.concat([t.slice(88,120),e,i]))).slice(8,24),{iv:a,key:r}=await this._calcKey(t,o,!0),d=(0,ze.YT)(this.authKey.keyId,8);return Bt.concat([d,o,new Nt(r,a).encryptIge(Bt.concat([e,i]))])}}async decryptMessageData(e){if(!this.authKey)throw new Error("Auth key unset");if(e.length<8)throw new De(e);if(e.length<0)throw new Ue("Server replied with negative length");if(e.length%4!=0&&!this._isCall)throw new Ue("Server replied with length not divisible by 4");if(!this._isCall){const t=(0,ze.op)(e.slice(0,8));if(!this.authKey.keyId||t.neq(this.authKey.keyId))throw new Ue("Server replied with an invalid auth key")}const t=this.authKey.getKey();if(!t)throw new Ue("Unset AuthKey");const n=this._isCall?e.slice(0,16):e.slice(8,24),s=this._isCall?128+(this._isOutgoing?8:0):0,{iv:i,key:o}=await this._calcKey(t,n,!1);if(this._isCall){const t=(e=e.slice(16)).length;e=Bt.concat([e,Bt.from(new Array(4-t%4).fill(0))]),e=(e=new Mt(o,i).decrypt(e)).slice(0,t)}else e=new Nt(o,i).decryptIge(this._isCall?e.slice(16):e.slice(24));const a=this._isCall?await(0,ze.sc)(Bt.concat([t.slice(88+s,88+s+32),e])):await(0,ze.sc)(Bt.concat([t.slice(96,128),e]));if(!this._isCall&&!n.equals(a.slice(8,24)))throw new Ue("Received msg_key doesn't match with expected one");const r=new We(e);if(this._isCall)return r.readInt(!1),r.read(e.length-4);{if(r.readLong(),!r.readLong().eq(this.id))throw new Ue("Server replied with a wrong session ID");const t=r.readLong();if(this.msgIds.includes(t.toString()))throw new Ue("Duplicate msgIds");this.msgIds.length>500&&this.msgIds.shift();const n=r.readInt(),s=r.readInt(),i=e.length-s;if(i<12||i>1024)throw new Ue("Server replied with the wrong message padding");const o=await r.tgReadObject();if(o?.className?.startsWith("Update")){const e=Math.floor(Date.now()/1e3),n=this.getMsgIdTimeLocal(t);if(n&&(n-e>30||e-n>300))throw new Ue("The message time is incorrect.")}return o&&!("errorCode"in o)&&this.msgIds.push(t.toString()),new Ge.A(t,n,o)}}_getNewMsgId(){const e=Date.now()/1e3+this.timeOffset,t=Math.floor(1e9*(e-Math.floor(e)));let n=vt()(Math.floor(e)).shiftLeft(vt()(32)).or(vt()(t).shiftLeft(vt()(2)));return this._lastMsgId.greaterOrEquals(n)&&(n=this._lastMsgId.add(vt()(4))),this._lastMsgId=n,n}getMsgIdTimeLocal(e){return!this._lastMsgId.eq(0)&&e.shiftRight(vt()(32)).toJSNumber()-this.timeOffset}updateTimeOffset(e){const t=this._getNewMsgId(),n=this.timeOffset,s=Math.floor(Date.now()/1e3),i=e.shiftRight(vt()(32)).toJSNumber();return this.timeOffset=i-s,this.timeOffset!==n&&(this._lastMsgId=vt()(0),this._log.debug(`Updated time offset (old offset ${n}, bad ${t}, good ${e}, new ${this.timeOffset})`)),this.timeOffset}_getSeqNo(e){if(e){const e=2*this._sequence+1;return this._sequence+=1,e}return 2*this._sequence}}var Ot=n(48287).hp;function qt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Ft{constructor(e,t){qt(this,"_state",void 0),qt(this,"_connection",void 0),this._state=new Gt(void 0,t),this._connection=e}async send(e){let t=e.getBytes(),n=this._state._getNewMsgId();const s=(0,ze.yr)(n,8),i=Ot.alloc(4);i.writeInt32LE(t.length,0);const o=Ot.concat([Ot.concat([Ot.alloc(8),s,i]),t]);if(await this._connection.send(o),t=await this._connection.recv(),t.length<8)throw new De(t);const a=new We(t);if(a.readLong().neq(vt()(0)))throw new Error("Bad authKeyId");if(n=a.readLong(),n.eq(vt()(0)))throw new Error("Bad msgId");if(a.readInt()<=0)throw new Error("Bad length");return a.tgReadObject()}}var Lt=n(48287).hp;function zt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Vt{constructor(e,t){if(zt(this,"_key",void 0),zt(this,"_hash",void 0),zt(this,"auxHash",void 0),zt(this,"keyId",void 0),!t||!e)return;this._key=e,this._hash=t;const n=new We(t);this.auxHash=n.readLong(!1),n.read(4),this.keyId=n.readLong(!1)}async setKey(e){if(!e)return this._key=void 0,this.auxHash=void 0,this.keyId=void 0,void(this._hash=void 0);if(e instanceof Vt)return this._key=e._key,this.auxHash=e.auxHash,this.keyId=e.keyId,void(this._hash=e._hash);this._key=e,this._hash=await(0,ze.e8)(this._key);const t=new We(this._hash);this.auxHash=t.readLong(!1),t.read(4),this.keyId=t.readLong(!1)}async waitForKey(){for(;!this.keyId;)await(0,ze.yy)(20)}getKey(){return this._key}async calcNewNonceHash(e,t){if(!this.auxHash)throw new Error("Auth key not set");const n=(0,ze.yr)(e,32),s=Lt.alloc(1);s.writeUInt8(t,0);const i=Lt.concat([n,Lt.concat([s,(0,ze.YT)(this.auxHash,8,!0)])]),o=(await(0,ze.e8)(i)).slice(4,20);return(0,ze.op)(o,!0,!0)}equals(e){return e instanceof this.constructor&&this._key&&Lt.isBuffer(e.getKey())&&e.getKey()?.equals(this._key)}}class $t{constructor(){var e,t,n,s;e=this,n=void 0,(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t="_pending"))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,this._pending=new Map}set(e,t){this._pending.set(e.toString(),t)}get(e){return this._pending.get(e.toString())}getAndDelete(e){const t=this.get(e);return this.delete(e),t}values(){return Array.from(this._pending.values())}delete(e){this._pending.delete(e.toString())}clear(){this._pending.clear()}}n(48287).hp;const Wt=[{fingerprint:vt()("-3414540481677951611"),n:vt()("29379598170669337022986177149456128565388431120058863768162556424047512191330847455146576344487764408661701890505066208632169112269581063774293102577308490531282748465986139880977280302242772832972539403531316010870401287642763009136156734339538042419388722777357134487746169093539093850251243897188928735903389451772730245253062963384108812842079887538976360465290946139638691491496062099570836476454855996319192747663615955633778034897140982517446405334423701359108810182097749467210509584293428076654573384828809574217079944388301239431309115013843331317877374435868468779972014486325557807783825502498215169806323"),e:65537},{fingerprint:vt()("-5595554452916591101"),n:vt()("25342889448840415564971689590713473206898847759084779052582026594546022463853940585885215951168491965708222649399180603818074200620463776135424884632162512403163793083921641631564740959529419359595852941166848940585952337613333022396096584117954892216031229237302943701877588456738335398602461675225081791820393153757504952636234951323237820036543581047826906120927972487366805292115792231423684261262330394324750785450942589751755390156647751460719351439969059949569615302809050721500330239005077889855323917509948255722081644689442127297605422579707142646660768825302832201908302295573257427896031830742328565032949"),e:65537}].reduce(((e,{fingerprint:t,...n})=>(e.set(t.toString(),n),e)),new Map);class Kt{static gcd(e,t){for(;t.neq(vt().zero);){const n=t;t=e.remainder(t),e=n}return e}static factorize(e){if(e.remainder(2).equals(vt().zero))return{p:vt()(2),q:e.divide(vt()(2))};let t=vt().randBetween(vt()(1),e.minus(1));const n=vt().randBetween(vt()(1),e.minus(1)),s=vt().randBetween(vt()(1),e.minus(1));let i,o=vt().one,a=vt().one,r=vt().one,d=vt().zero,c=vt().zero;for(;o.eq(vt().one);){d=t;for(let s=0;vt()(s).lesser(a);s++)t=(0,ze.gS)(t,vt()(2),e).add(n).remainder(e);for(i=vt().zero;i.lesser(a)&&o.eq(vt().one);){c=t;const u=vt().min(s,a.minus(i));for(let s=0;vt()(s).lesser(u);s++)t=(0,ze.gS)(t,vt()(2),e).add(n).remainder(e),r=r.multiply(d.minus(t).abs()).remainder(e);o=Kt.gcd(r,e),i=i.add(s)}a=a.multiply(2)}if(o.eq(e))for(;c=(0,ze.gS)(c,vt()(2),e).add(n).remainder(e),o=Kt.gcd(d.minus(c).abs(),e),!o.greater(1););const u=o;return r=e.divide(o),u<r?{p:u,q:r}:{p:r,q:u}}}var Jt=n(48287).hp;function Qt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Yt{constructor(){Qt(this,"promise",void 0),Qt(this,"reject",void 0),Qt(this,"resolve",void 0),this.promise=new Promise(((e,t)=>{this.reject=t,this.resolve=e}))}static resolved(e){const t=new Yt;return t.resolve(e),t}}function Xt(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Zt{constructor(e,t){Xt(this,"containerId",void 0),Xt(this,"msgId",void 0),Xt(this,"request",void 0),Xt(this,"data",void 0),Xt(this,"after",void 0),Xt(this,"result",void 0),Xt(this,"finished",void 0),Xt(this,"promise",void 0),Xt(this,"abortSignal",void 0),Xt(this,"resolve",void 0),Xt(this,"reject",void 0),this.containerId=void 0,this.msgId=void 0,this.request=e,this.data=e.getBytes(),this.after=void 0,this.result=void 0,this.abortSignal=t,this.finished=new Yt,this.resetPromise()}isReady(){return!this.after||this.after.finished.promise}resetPromise(){this.reject?.(),this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}var en=n(48287).hp;function tn(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class nn{constructor(e,t){tn(this,"_connection",void 0),tn(this,"_fallbackConnection",void 0),tn(this,"_shouldForceHttpTransport",void 0),tn(this,"_shouldAllowHttpTransport",void 0),tn(this,"_retriesToFallback",void 0),tn(this,"_log",void 0),tn(this,"_dcId",void 0),tn(this,"_senderIndex",void 0),tn(this,"_retries",void 0),tn(this,"_delay",void 0),tn(this,"_retryMainConnectionDelay",void 0),tn(this,"_isFallback",void 0),tn(this,"_authKeyCallback",void 0),tn(this,"_updateCallback",void 0),tn(this,"_autoReconnectCallback",void 0),tn(this,"_isMainSender",void 0),tn(this,"_isExported",void 0),tn(this,"_sendQueue",void 0),tn(this,"_sendQueueLongPoll",void 0),tn(this,"isSendingLongPoll",void 0),tn(this,"_pendingAck",void 0),tn(this,"_lastAcks",void 0),tn(this,"_pendingState",void 0),tn(this,"_userConnected",void 0),tn(this,"isReconnecting",void 0),tn(this,"_disconnected",void 0),tn(this,"_sendLoopHandle",void 0),tn(this,"_recvLoopHandle",void 0),tn(this,"_longPollLoopHandle",void 0),tn(this,"_isReconnectingToMain",!1),tn(this,"authKey",void 0),tn(this,"_state",void 0),tn(this,"_getShouldDebugExportedSenders",void 0),tn(this,"_handlers",void 0),tn(this,"_onConnectionBreak",void 0),tn(this,"userDisconnected",void 0),tn(this,"isConnecting",!1),tn(this,"_authenticated",!1),tn(this,"logWithIndex",{debug:this.logWithIndexCallback("debug"),log:this.logWithIndexCallback("log"),warn:this.logWithIndexCallback("warn"),error:this.logWithIndexCallback("error")});const n={...nn.DEFAULT_OPTIONS,...t};this._connection=void 0,this._fallbackConnection=void 0,this._shouldForceHttpTransport=n.shouldForceHttpTransport,this._shouldAllowHttpTransport=n.shouldAllowHttpTransport,this._log=n.logger,this._dcId=n.dcId,this._senderIndex=n.senderIndex||0,this._retries=n.retries,this._retriesToFallback=n.retriesToFallback,this._delay=n.delay,this._retryMainConnectionDelay=n.retryMainConnectionDelay,this._authKeyCallback=n.authKeyCallback,this._updateCallback=n.updateCallback,this._autoReconnectCallback=n.autoReconnectCallback,this._isMainSender=Boolean(n.isMainSender),this._isExported=Boolean(n.isExported),this._onConnectionBreak=n.onConnectionBreak,this._isFallback=!1,this._getShouldDebugExportedSenders=n.getShouldDebugExportedSenders,this.userDisconnected=!1,this._userConnected=!1,this.isReconnecting=!1,this._disconnected=!0,this._sendLoopHandle=void 0,this._longPollLoopHandle=void 0,this._recvLoopHandle=void 0,this.authKey=e||new Vt,this._state=new Gt(this.authKey,this._log),this._sendQueue=new rt(this._state,this._log),this._sendQueueLongPoll=new rt(this._state,this._log),this._pendingState=new $t,this._pendingAck=new Set,this._lastAcks=[],this._handlers={[Fe.A.CONSTRUCTOR_ID]:this._handleRPCResult.bind(this),[qe.CONSTRUCTOR_ID]:this._handleContainer.bind(this),[He.A.CONSTRUCTOR_ID]:this._handleGzipPacked.bind(this),[fe.jI.Pong.CONSTRUCTOR_ID]:this._handlePong.bind(this),[fe.jI.BadServerSalt.CONSTRUCTOR_ID]:this._handleBadServerSalt.bind(this),[fe.jI.BadMsgNotification.CONSTRUCTOR_ID]:this._handleBadNotification.bind(this),[fe.jI.MsgDetailedInfo.CONSTRUCTOR_ID]:this._handleDetailedInfo.bind(this),[fe.jI.MsgNewDetailedInfo.CONSTRUCTOR_ID]:this._handleNewDetailedInfo.bind(this),[fe.jI.NewSessionCreated.CONSTRUCTOR_ID]:this._handleNewSessionCreated.bind(this),[fe.jI.MsgsAck.CONSTRUCTOR_ID]:this._handleAck.bind(this),[fe.jI.FutureSalts.CONSTRUCTOR_ID]:this._handleFutureSalts.bind(this),[fe.jI.MsgsStateReq.CONSTRUCTOR_ID]:this._handleStateForgotten.bind(this),[fe.jI.MsgResendReq.CONSTRUCTOR_ID]:this._handleStateForgotten.bind(this),[fe.jI.MsgsAllInfo.CONSTRUCTOR_ID]:this._handleMsgAll.bind(this)}}logWithIndexCallback(e){return(...t)=>{this._getShouldDebugExportedSenders&&this._getShouldDebugExportedSenders()&&console[e](`[${this._isExported?`idx=${this._senderIndex} `:"M "}dcId=${this._dcId}]`,...t)}}getConnection(){return this._isFallback?this._fallbackConnection:this._connection}async connect(e,t,n){if(this.userDisconnected=!1,this._userConnected&&!t)return this._log.info("User is already connected!"),!1;this.isConnecting=!0,this._isFallback=this._shouldForceHttpTransport&&this._shouldAllowHttpTransport,this._connection=e,this._fallbackConnection=n;for(let e=0;e<this._retries+this._retriesToFallback;e++)try{e>=this._retriesToFallback&&this._shouldAllowHttpTransport&&(this._isFallback=!0,this.logWithIndex.warn("Using fallback connection"),this._log.warn("Using fallback connection")),this.logWithIndex.warn("Connecting..."),await this._connect(this.getConnection()),this.logWithIndex.warn("Connected!"),this._isExported||this._updateCallback?.(new Et(Et.connected));break}catch(t){this._isExported||0!==e||this._updateCallback?.(new Et(Et.disconnected)),this._log.error(`${this._isFallback?"HTTP":"WebSocket"} connection failed attempt: ${e+1}`),console.error(t),await(0,ze.yy)(this._delay)}return this.isConnecting=!1,this._isFallback&&!this._shouldForceHttpTransport&&this.tryReconnectToMain(),!0}async tryReconnectToMain(){if(this.isConnecting||!this._isFallback||this._isReconnectingToMain||this.isReconnecting||this._shouldForceHttpTransport||this._isExported)await(0,ze.yy)(this._retryMainConnectionDelay);else{this._log.debug("Trying to reconnect to main connection"),this._isReconnectingToMain=!0;try{await this._connection.connect(),this._log.info("Reconnected to main connection"),this.logWithIndex.warn("Reconnected to main connection"),this.isReconnecting=!0,this._fallbackConnection&&await this._disconnect(this._fallbackConnection),await this.connect(this._connection,!0,this._fallbackConnection),this.isReconnecting=!1,this._isReconnectingToMain=!1}catch(e){this.isReconnecting=!1,this._isReconnectingToMain=!1,this._log.error(`Failed to reconnect to main connection, retrying in ${this._retryMainConnectionDelay}ms`),await(0,ze.yy)(this._retryMainConnectionDelay),this.tryReconnectToMain()}}}isConnected(){return this._userConnected}async disconnect(){this.userDisconnected=!0,this.logWithIndex.warn("Disconnecting...");const e=this.getConnection();e&&await this._disconnect(e)}destroy(){this._sendQueue.clear()}send(e,t,n=!1){const s=new Zt(e,t);return n?this._sendQueueLongPoll.append(s):(this.logWithIndex.debug(`Send ${e.className}`),this._sendQueue.append(s)),s.promise}addStateToQueue(e){this._sendQueue.append(e)}async sendBeacon(e){if(!(this._userConnected&&this._fallbackConnection instanceof wt))throw new Error("Cannot send requests while disconnected");const t=new Zt(e,void 0),n=await this._sendQueue.getBeacon(t);if(!n)return;const s=await this._state.encryptMessageData(n);postMessage({type:"sendBeacon",data:s,url:this._fallbackConnection.href})}async _connect(e){if(e.isConnected()||(this._log.info("Connecting to {0}...".replace("{0}",e._ip)),await e.connect(),this._log.debug("Connection success!")),this.authKey.getKey())this._authenticated=!0,this._log.debug("Already have an auth key ...");else{const t=new Ft(e,this._log);this._log.debug("New auth_key attempt ...");const n=await async function(e,t){let n=(0,ze.Gg)(16);const s=(0,ze.op)(n,!1,!0),i=await e.send(new fe.jI.ReqPqMulti({nonce:s}));if(t.debug("Starting authKey generation step 1"),!(i instanceof fe.jI.ResPQ))throw new Ue(`Step 1 answer was ${i}`);if(i.nonce.neq(s))throw new Ue("Step 1 invalid nonce from server");const o=(0,ze.op)(i.pq,!1,!0);t.debug("Finished authKey generation step 1");const{p:a,q:r}=Kt.factorize(o),d=(0,ze.ON)(a),c=(0,ze.ON)(r);n=(0,ze.Gg)(32);const u=(0,ze.op)(n,!0,!0),l=new fe.jI.PQInnerData({pq:(0,ze.ON)(o),p:d,q:c,nonce:i.nonce,serverNonce:i.serverNonce,newNonce:u}).getBytes();if(l.length>144)throw new Ue("Step 1 invalid nonce from server");let f,h;for(const e of i.serverPublicKeyFingerprints)if(h=Wt.get(e.toString()),void 0!==h){f=e;break}if(void 0===f||void 0===h)throw new Ue("Step 2 could not find a valid key for fingerprints");const p=(0,ze.Gg)(192-l.length),m=Jt.concat([l,p]),g=Jt.from(m).reverse();let I;for(let e=0;e<20;e++){const e=(0,ze.Gg)(32),n=await(0,ze.sc)(Jt.concat([e,m])),s=Jt.concat([g,n]),i=new Nt(e,Jt.alloc(32)).encryptIge(s),o=(0,ze.MN)(e,await(0,ze.sc)(i)),a=Jt.concat([o,i]),r=(0,ze.op)(a,!1,!1);if(r.greaterOrEquals(h.n)){t.debug("Aes key greater than RSA. retrying");continue}const d=(0,ze.gS)(r,vt()(h.e),h.n);I=(0,ze.YT)(d,256,!1,!1);break}if(void 0===I)throw new Ue("Step 2 could create a secure encrypted key");t.debug("Step 2 : Generated a secure aes encrypted data");const w=await e.send(new fe.jI.ReqDHParams({nonce:i.nonce,serverNonce:i.serverNonce,p:d,q:c,publicKeyFingerprint:f,encryptedData:I}));if(!(w instanceof fe.jI.ServerDHParamsOk||w instanceof fe.jI.ServerDHParamsFail))throw new Error(`Step 2.1 answer was ${w}`);if(w.nonce.neq(i.nonce))throw new Ue("Step 2 invalid nonce from server");if(w.serverNonce.neq(i.serverNonce))throw new Ue("Step 2 invalid server nonce from server");if(w instanceof fe.jI.ServerDHParamsFail){const e=await(0,ze.e8)((0,ze.yr)(u,32).slice(4,20)),t=(0,ze.op)(e,!0,!0);if(w.newNonceHash.neq(t))throw new Ue("Step 2 invalid DH fail nonce from server")}if(!(w instanceof fe.jI.ServerDHParamsOk))throw new Error(`Step 2.2 answer was ${w}`);t.debug("Finished authKey generation step 2"),t.debug("Starting authKey generation step 3");const{key:y,iv:v}=await(0,ze.ik)(i.serverNonce,u);if(w.encryptedAnswer.length%16!=0)throw new Ue("Step 3 AES block size mismatch");const b=new Nt(y,v),S=b.decryptIge(w.encryptedAnswer),j=new We(S),C=j.read(20),P=j.tgReadObject();if(!(P instanceof fe.jI.ServerDHInnerData))throw new Error(`Step 3 answer was ${P}`);const _=await(0,ze.e8)(P.getBytes());if(!C.equals(_))throw new Ue("Step 3 Invalid hash answer");if(P.nonce.neq(i.nonce))throw new Ue("Step 3 Invalid nonce in encrypted answer");if(P.serverNonce.neq(i.serverNonce))throw new Ue("Step 3 Invalid server nonce in encrypted answer");if(3!==P.g||"c71caeb9c6b1c9048e6c522f70f13f73980d40238e3e21c14934d037563d930f48198a0aa7c14058229493d22530f4dbfa336f6e0ac925139543aed44cce7c3720fd51f69458705ac68cd4fe6b6b13abdc9746512969328454f18faf8c595f642477fe96bb2a941d5bcd1d4ac8cc49880708fa9b378e3c4f3a9060bee67cf9a4a4a695811051907e162753b56b0f6b410dba74d8a84b2a14b3144e0ef1284754fd17ed950d5965b4b9dd46582db1178d169c6bc465b0d6ff9ca3928fef5b9ae4e418fc15e83ebea0f87fa9ff5eed70050ded2849f47bf959d956850ce929851f0d8115f635b105ee2e4e15d04b2454bf6f4fadf034b10403119cd8e3b92fcc5b"!==P.dhPrime.toString("hex"))throw new Ue("Step 3 invalid dhPrime or g");const M=(0,ze.op)(P.dhPrime,!1,!1),T=(0,ze.op)(P.gA,!1,!1),k=P.serverTime-Math.floor(Date.now()/1e3),A=(0,ze.op)((0,ze.Gg)(256),!1,!1),R=(0,ze.gS)(vt()(P.g),A,M),E=(0,ze.gS)(T,A,M);if(T.lesserOrEquals(1))throw new Ue("Step 3 failed ga > 1 check");if(R.lesserOrEquals(1))throw new Ue("Step 3 failed gb > 1 check");if(T.greater(M.minus(1)))throw new Ue("Step 3 failed ga > dh_prime - 1 check");const D=vt()(2).pow(1984);if(!T.greaterOrEquals(D)||!T.lesserOrEquals(M.minus(D)))throw new Ue("Step 3 failed dh_prime - 2^{2048-64} < ga < 2^{2048-64} check");if(!R.greaterOrEquals(D)||!R.lesserOrEquals(M.minus(D)))throw new Ue("Step 3 failed dh_prime - 2^{2048-64} < gb < 2^{2048-64} check");const U=new fe.jI.ClientDHInnerData({nonce:i.nonce,serverNonce:i.serverNonce,retryId:vt().zero,gB:(0,ze.ON)(R,!1)}).getBytes(),x=Jt.concat([await(0,ze.e8)(U),U]),N=b.encryptIge(x),B=await e.send(new fe.jI.SetClientDHParams({nonce:i.nonce,serverNonce:i.serverNonce,encryptedData:N})),H=[fe.jI.DhGenOk,fe.jI.DhGenRetry,fe.jI.DhGenFail];if(!(B instanceof H[0]||B instanceof H[1]||B instanceof H[2]))throw new Error(`Step 3.1 answer was ${B}`);const{name:G}=B.constructor;if(B.nonce.neq(i.nonce))throw new Ue(`Step 3 invalid ${G} nonce from server`);if(B.serverNonce.neq(i.serverNonce))throw new Ue(`Step 3 invalid ${G} server nonce from server`);const O=new Vt;await O.setKey((0,ze.ON)(E));const q=1+["DhGenOk","DhGenRetry","DhGenFail"].indexOf(B.className),F=await O.calcNewNonceHash(u,q);if(B[`newNonceHash${q}`].neq(F))throw new Ue("Step 3 invalid new nonce hash");if(!(B instanceof fe.jI.DhGenOk))throw new Error(`Step 3.2 answer was ${B}`);return t.debug("Finished authKey generation step 3"),{authKey:O,timeOffset:k}}(t,this._log);this._log.debug("Generated new auth_key successfully"),await this.authKey.setKey(n.authKey),this._state.timeOffset=n.timeOffset,this._isExported||this._updateCallback?.(new Dt(this._state.timeOffset)),this._authKeyCallback&&await this._authKeyCallback(this.authKey,this._dcId)}this._userConnected=!0,this.isReconnecting=!1,this._sendLoopHandle||(this._log.debug("Starting send loop"),this._sendLoopHandle=this._sendLoop()),this._recvLoopHandle||(this._log.debug("Starting receive loop"),this._recvLoopHandle=this._recvLoop()),!this._longPollLoopHandle&&e.shouldLongPoll&&(this._log.debug("Starting long-poll loop"),this._longPollLoopHandle=this._longPollLoop()),this._log.info("Connection to %s complete!".replace("%s",e.toString()))}async _disconnect(e){this._isExported||this._updateCallback?.(new Et(Et.disconnected)),void 0!==e?(this._log.info("Disconnecting from %s...".replace("%s",e.toString())),this._userConnected=!1,this._log.debug("Closing current connection..."),this.logWithIndex.warn("Disconnecting"),await e.disconnect()):this._log.info("Not disconnecting (already have no connection)")}async _longPollLoop(){for(;this._userConnected&&!this.isReconnecting&&this._isFallback&&this.getConnection().shouldLongPoll;){await this._sendQueueLongPoll.wait();const e=await this._sendQueueLongPoll.get();if(this.isReconnecting||!this._isFallback)return void(this._longPollLoopHandle=void 0);if(!e)continue;let{data:t}=e;const{batch:n}=e;this._log.debug(`Encrypting ${n.length} message(s) in ${t.length} bytes for sending`),t=await this._state.encryptMessageData(t);try{await(this._fallbackConnection?.send(t))}catch(e){return this._log.error(e),this._log.info("Connection closed while sending data"),this._longPollLoopHandle=void 0,this.isSendingLongPoll=!1,void(this.userDisconnected||this.reconnect())}this.isSendingLongPoll=!1,this.checkLongPoll()}this._longPollLoopHandle=void 0}async _sendLoop(){for(this._sendQueue.prepend(this._pendingState.values()),this._pendingState.clear();this._userConnected&&!this.isReconnecting;){const e=()=>{if(this._pendingAck.size){const e=new Zt(new fe.jI.MsgsAck({msgIds:Array(...this._pendingAck)}));this._sendQueue.append(e),this._lastAcks.push(e),this._lastAcks.length>=10&&this._lastAcks.shift(),this._pendingAck.clear()}};e(),this.logWithIndex.debug(`Waiting for messages to send... ${this.isReconnecting}`),this._log.debug(`Waiting for messages to send... ${this.isReconnecting}`),await this._sendQueue.wait(),this._isFallback&&this.send(new fe.jI.HttpWait({maxDelay:0,waitAfter:0,maxWait:0})),e();const t=await this._sendQueue.get();if(this.logWithIndex.debug(`Got ${t?.batch.length} message(s) to send`),!t)continue;let{data:n}=t;const{batch:s}=t;for(const e of s)if(Array.isArray(e))for(const t of e)"request"===t.request.classType&&"HttpWait"!==t.request.className&&this._pendingState.set(t.msgId,t);else"request"===e.request.classType&&"HttpWait"!==e.request.className&&this._pendingState.set(e.msgId,e);if(this.isReconnecting)return this.logWithIndex.debug("Reconnecting :("),void(this._sendLoopHandle=void 0);this._log.debug(`Encrypting ${s.length} message(s) in ${n.length} bytes for sending`),this.logWithIndex.debug("Sending",s.map((e=>e.request.className))),n=await this._state.encryptMessageData(n);try{await this.getConnection().send(n)}catch(e){return this.logWithIndex.debug(`Connection closed while sending data ${e}`),this._log.error(e),this._log.info("Connection closed while sending data"),this._sendLoopHandle=void 0,void(this.userDisconnected||this.reconnect())}finally{for(const e of s)if(Array.isArray(e))for(const t of e)"HttpWait"===t.request.className&&e.resolve?.();else"HttpWait"===e.request.className&&e.resolve?.();this.logWithIndex.debug("Encrypted messages put in a queue to be sent"),this._log.debug("Encrypted messages put in a queue to be sent")}}this._sendLoopHandle=void 0}async _recvLoop(){let e,t;for(;this._userConnected&&!this.isReconnecting;){this._log.debug("Receiving items from the network..."),this.logWithIndex.debug("Receiving items from the network...");try{e=await this.getConnection().recv()}catch(e){return this.userDisconnected||(this._log.error(e),this._log.warn("Connection closed while receiving data"),this.reconnect()),void(this._recvLoopHandle=void 0)}try{t=await this._state.decryptMessageData(e)}catch(e){if(this.logWithIndex.debug(`Error while receiving items from the network ${e.toString()}`),e instanceof Ee){this._log.info(`Type ${e.invalidConstructorId} not found, remaining data ${e.remaining}`);continue}if(e instanceof Ue){this._log.warn(`Security error while unpacking a received message: ${e}`);continue}return e instanceof De?(404===e.code?this._handleBadAuthKey():(this._log.warn(`Invalid buffer ${e.code} for dc ${this._dcId}`),this.reconnect()),void(this._recvLoopHandle=void 0)):(this._log.error("Unhandled error while receiving data"),this._log.error(e),this.reconnect(),void(this._recvLoopHandle=void 0))}try{await this._processMessage(t)}catch(e){e instanceof pe?"AUTH_KEY_UNREGISTERED"!==e.errorMessage&&"SESSION_REVOKED"!==e.errorMessage||this._handleBadAuthKey(!0):(this._log.error("Unhandled error while receiving data"),this._log.error(e))}this.checkLongPoll()}this._recvLoopHandle=void 0}checkLongPoll(){!this.isSendingLongPoll&&this._isFallback&&(this.isSendingLongPoll=!0,this.send(new fe.jI.HttpWait({maxDelay:500,waitAfter:150,maxWait:3e3}),void 0,!0))}_handleBadAuthKey(e){e&&this._isMainSender||(this._log.warn(`Broken authorization key for dc ${this._dcId}, resetting...`),this._isMainSender&&!this._isExported?this._updateCallback?.(new Et(Et.broken)):!this._isMainSender&&this._onConnectionBreak&&this._onConnectionBreak(this._dcId))}async _processMessage(e){if("MsgsAck"===e.obj.className)return;this.logWithIndex.debug(`Process message ${e.obj.className}`),this._pendingAck.add(e.msgId),this.getConnection().shouldLongPoll&&this._sendQueue.setReady?.(!0),e.obj=await e.obj;let t=this._handlers[e.obj.CONSTRUCTOR_ID];t||(t=this._handleUpdate.bind(this)),await t(e)}_popStates(e){const t=this._pendingState.getAndDelete(e);if(t)return[t];const n=[];for(const t of this._pendingState.values())t.containerId?.equals(e)&&n.push(t.msgId);if(n.length){const e=[];for(const t of n)e.push(this._pendingState.getAndDelete(t));return e}for(const t of this._lastAcks)if(t.msgId===e)return[t];return[]}_handleRPCResult(e){const t=e.obj,n=this._pendingState.getAndDelete(t.reqMsgId);if(this._log.debug(`Handling RPC result for message ${t.reqMsgId}`),n){if(t.error){const e=function(e,t){for(const[n,s]of Ae){const i=e.errorMessage.match(n);if(i)return new s({request:t,capture:2===i.length?parseInt(i[1],10):void 0})}return new pe(e.errorMessage,t,e.errorCode)}(t.error,n.request);throw this._sendQueue.append(new Zt(new fe.jI.MsgsAck({msgIds:[n.msgId]}))),n.reject?.(e),e}try{const e=new We(t.body),s=n.request.readResult(e);this.logWithIndex.debug("Handling RPC result",s),n.resolve?.(s)}catch(e){throw n.reject?.(e),e}}else try{if(!(new We(t.body).tgReadObject()instanceof fe.jI.upload.File))throw new Ee(0,en.alloc(0))}catch(e){if(e instanceof Ee)return void this._log.info(`Received response without parent request: ${t.body}`);if(this._isFallback)return;throw e}}async _handleContainer(e){this._log.debug("Handling container");for(const t of e.obj.messages)await this._processMessage(t)}async _handleGzipPacked(e){this._log.debug("Handling gzipped data");const t=new We(e.obj.data);e.obj=t.tgReadObject(),await this._processMessage(e)}_handleUpdate(e){2331323052===e.obj.SUBCLASS_OF_ID?(this._log.debug(`Handling update ${e.obj.className}`),this._isExported||this._updateCallback?.(e.obj)):this._log.warn(`Note: ${e.obj.className} is not an update, not dispatching it`)}_handlePong(e){const t=e.obj,n=this._state.updateTimeOffset(e.msgId);this._isExported||this._updateCallback?.(new Dt(n)),this._log.debug(`Handling pong for message ${t.msgId}`);const s=this._pendingState.getAndDelete(t.msgId);s&&s.resolve?.(t)}_handleBadServerSalt(e){const t=e.obj;this._log.debug(`Handling bad salt for message ${t.badMsgId}`),this._state.salt=t.newServerSalt;const n=this._popStates(t.badMsgId);this._sendQueue.extend(n),this._log.debug(`${n.length} message(s) will be resent`)}_handleBadNotification(e){const t=e.obj,n=this._popStates(t.badMsgId);if(this._log.debug(`Handling bad msg ${JSON.stringify(t)}`),[16,17].includes(t.errorCode)){const t=this._state.updateTimeOffset(e.msgId);this._isExported||this._updateCallback?.(new Dt(t)),this._log.info(`System clock is wrong, set time offset to ${t}s`)}else if(32===t.errorCode)this._state._sequence+=64;else{if(33!==t.errorCode){for(const e of n)e.reject(new xe(e.request,t.errorCode));return}this._state._sequence-=16}this._sendQueue.extend(n),this._log.debug(`${n.length} messages will be resent due to bad msg`)}_handleDetailedInfo(e){const t=e.obj.answerMsgId;this._log.debug(`Handling detailed info for message ${t}`),this._pendingAck.add(t)}_handleNewDetailedInfo(e){const t=e.obj.answerMsgId;this._log.debug(`Handling new detailed info for message ${t}`),this._pendingAck.add(t)}_handleNewSessionCreated(e){this._log.debug("Handling new session created"),this._state.salt=e.obj.serverSalt}_handleAck(){}_handleFutureSalts(e){this._log.debug(`Handling future salts for message ${e.msgId}`);const t=this._pendingState.getAndDelete(e.msgId);t&&t.resolve?.(e.obj)}_handleStateForgotten(e){this._sendQueue.append(new Zt(new fe.jI.MsgsStateInfo({reqMsgId:e.msgId,info:String.fromCharCode(1).repeat(e.obj.msgIds)})))}_handleMsgAll(e){}reconnect(){this._userConnected&&!this.isReconnecting&&(this.isReconnecting=!0,(0,ze.yy)(1e3).then((()=>{this.logWithIndex.log("Reconnecting..."),this._log.info("Started reconnecting"),this._reconnect()})))}async _reconnect(){const e=this._connection,t=this._fallbackConnection;this._log.debug("Closing current connection...");try{this.logWithIndex.warn("[Reconnect] Closing current connection..."),e&&await this._disconnect(e),t&&await this._disconnect(t)}catch(e){this._log.warn(e)}this._sendQueue.append(void 0),this._state.reset();const n=new e.constructor({ip:e._ip,port:e._port,dcId:e._dcId,loggers:e._log,isTestServer:e._isTestServer,isPremium:e._isPremium}),s=new this._fallbackConnection.constructor({ip:e._ip,port:e._port,dcId:e._dcId,loggers:e._log,isTestServer:e._isTestServer,isPremium:e._isPremium});await this.connect(n,!0,s),this.isReconnecting=!1,this._sendQueue.prepend(this._pendingState.values()),this._pendingState.clear(),this._autoReconnectCallback&&await this._autoReconnectCallback()}}tn(nn,"DEFAULT_OPTIONS",{logger:void 0,retries:1/0,retriesToFallback:1,delay:2e3,retryMainConnectionDelay:1e4,shouldForceHttpTransport:!1,shouldAllowHttpTransport:!1,autoReconnect:!0,connectTimeout:void 0,authKeyCallback:void 0,updateCallback:void 0,autoReconnectCallback:void 0,isMainSender:void 0,onConnectionBreak:void 0,isExported:void 0,getShouldDebugExportedSenders:void 0});var sn=n(48287).hp;const on=sn.from("ffd8ffe000104a46494600010100000100010000ffdb004300281c1e231e19282321232d2b28303c64413c37373c7b585d4964918099968f808c8aa0b4e6c3a0aadaad8a8cc8ffcbdaeef5ffffff9bc1fffffffaffe6fdfff8ffdb0043012b2d2d3c353c76414176f8a58ca5f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8f8ffc00011080000000003012200021101031101ffc4001f0000010501010101010100000000000000000102030405060708090a0bffc400b5100002010303020403050504040000017d01020300041105122131410613516107227114328191a1082342b1c11552d1f02433627282090a161718191a25262728292a3435363738393a434445464748494a535455565758595a636465666768696a737475767778797a838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae1e2e3e4e5e6e7e8e9eaf1f2f3f4f5f6f7f8f9faffc4001f0100030101010101010101010000000000000102030405060708090a0bffc400b51100020102040403040705040400010277000102031104052131061241510761711322328108144291a1b1c109233352f0156272d10a162434e125f11718191a262728292a35363738393a434445464748494a535455565758595a636465666768696a737475767778797a82838485868788898a92939495969798999aa2a3a4a5a6a7a8a9aab2b3b4b5b6b7b8b9bac2c3c4c5c6c7c8c9cad2d3d4d5d6d7d8d9dae2e3e4e5e6e7e8e9eaf2f3f4f5f6f7f8f9faffda000c03010002110311003f00","hex"),an=sn.from("ffd9","hex");function rn(e,t=!0,n=!0){if(3374092470===e.SUBCLASS_OF_ID)return e;if(e instanceof fe.jI.User){if(e.self&&t)return new fe.jI.InputPeerSelf;if(void 0===e.accessHash&&n)throw new Error("User without accessHash or min info cannot be input");return new fe.jI.InputPeerUser({userId:e.id,accessHash:e.accessHash})}if(e instanceof fe.jI.Chat||e instanceof fe.jI.ChatEmpty||e instanceof fe.jI.ChatForbidden)return new fe.jI.InputPeerChat({chatId:e.id});if(e instanceof fe.jI.Channel){if(void 0===e.accessHash&&n)throw new TypeError("Channel without accessHash or min info cannot be input");return new fe.jI.InputPeerChannel({channelId:e.id,accessHash:e.accessHash})}return e instanceof fe.jI.ChannelForbidden?new fe.jI.InputPeerChannel({channelId:e.id,accessHash:e.accessHash}):e instanceof fe.jI.InputUser?new fe.jI.InputPeerUser({userId:e.userId,accessHash:e.accessHash}):e instanceof fe.jI.InputChannel?new fe.jI.InputPeerChannel({channelId:e.channelId,accessHash:e.accessHash}):(e instanceof fe.jI.UserEmpty||function(e,t){throw new Error(`Cannot cast ${e.className} to any kind of InputPeer`)}(e),new fe.jI.InputPeerEmpty)}function dn(e){if(e.length<3||1!==e[0])return e;const t=sn.from(on);return t[164]=e[1],t[166]=e[2],sn.concat([t,e.slice(3),an])}function cn(e,t=!1){switch(e){case 1:return{id:1,ipAddress:`zws1${t?"-1":""}.web.telegram.org`,port:443};case 2:return{id:2,ipAddress:`zws2${t?"-1":""}.web.telegram.org`,port:443};case 3:return{id:3,ipAddress:`zws3${t?"-1":""}.web.telegram.org`,port:443};case 4:return{id:4,ipAddress:`zws4${t?"-1":""}.web.telegram.org`,port:443};case 5:return{id:5,ipAddress:`zws5${t?"-1":""}.web.telegram.org`,port:443};default:throw new Error(`Cannot find the DC with the ID of ${e}`)}}class un{}function ln(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class fn extends un{constructor(){super(),ln(this,"_serverAddress",void 0),ln(this,"_dcId",void 0),ln(this,"_port",void 0),ln(this,"_takeoutId",void 0),ln(this,"_entities",void 0),ln(this,"_updateStates",void 0),ln(this,"_isTestServer",void 0),this._serverAddress=void 0,this._dcId=0,this._port=void 0,this._takeoutId=void 0,this._isTestServer=!1,this._entities=new Set,this._updateStates={}}get dcId(){return this._dcId}get serverAddress(){return this._serverAddress}get port(){return this._port}get isTestServer(){return this._isTestServer}setDC(e,t,n,s){this._dcId=0|e,this._serverAddress=t,this._port=n,this._isTestServer=s}getAuthKey(e){return new Vt}setAuthKey(e,t){}async load(){}save(){}delete(){}}var hn=n(48287).hp;function pn(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class mn extends fn{constructor(e,t){super(),pn(this,"_sessionData",void 0),pn(this,"_callback",void 0),pn(this,"_authKeys",void 0),this._sessionData=e,this._callback=t,this._authKeys={}}async load(){if(!this._sessionData)return;const{mainDcId:e,keys:t,hashes:n,isTest:s}=this._sessionData,{ipAddress:i,port:o}=cn(e);this.setDC(e,i,o,s,!0),await Promise.all(Object.keys(t).map((async e=>{const s=Number(e),i="string"==typeof t[s]?hn.from(t[s],"hex"):hn.from(t[s]);if(n[s]){const e="string"==typeof n[s]?hn.from(n[s],"hex"):hn.from(n[s]);this._authKeys[s]=new Vt(i,e)}else this._authKeys[s]=new Vt,await this._authKeys[s].setKey(i)})))}setDC(e,t,n,s,i=!1){this._dcId=e,this._serverAddress=t,this._port=n,this._isTestServer=s,delete this._authKeys[e],i||this._onUpdate()}getAuthKey(e=this._dcId){return this._authKeys[e]}setAuthKey(e,t=this._dcId){this._authKeys[t]=e,this._onUpdate()}getSessionData(){const e={mainDcId:this._dcId,keys:{},hashes:{},isTest:this._isTestServer||void 0};return Object.keys(this._authKeys).forEach((t=>{const n=Number(t),s=this._authKeys[n];s?._key&&(e.keys[n]=s._key.toString("hex"),e.hashes[n]=s._hash.toString("hex"))})),e}_onUpdate(){this._callback(this.getSessionData())}delete(){this._callback(void 0)}}var gn=n(51072),In=n(18320),wn=n(48287).hp;const yn=256;function vn(e,t){if(!wn.from([199,28,174,185,198,177,201,4,142,108,82,47,112,241,63,115,152,13,64,35,142,62,33,193,73,52,208,55,86,61,147,15,72,25,138,10,167,193,64,88,34,148,147,210,37,48,244,219,250,51,111,110,10,201,37,19,149,67,174,212,76,206,124,55,32,253,81,246,148,88,112,90,198,140,212,254,107,107,19,171,220,151,70,81,41,105,50,132,84,241,143,175,140,89,95,100,36,119,254,150,187,42,148,29,91,205,29,74,200,204,73,136,7,8,250,155,55,142,60,79,58,144,96,190,230,124,249,164,164,166,149,129,16,81,144,126,22,39,83,181,107,15,107,65,13,186,116,216,168,75,42,20,179,20,78,14,241,40,71,84,253,23,237,149,13,89,101,180,185,221,70,88,45,177,23,141,22,156,107,196,101,176,214,255,156,163,146,143,239,91,154,228,228,24,252,21,232,62,190,160,248,127,169,255,94,237,112,5,13,237,40,73,244,123,249,89,217,86,133,12,233,41,133,31,13,129,21,246,53,177,5,238,46,78,21,208,75,36,84,191,111,79,173,240,52,177,4,3,17,156,216,227,185,47,204,91]).equals(e)||![3,4,5,7].includes(t))throw new Error("Changing passwords unsupported")}function bn(e){return wn.concat([wn.alloc(yn-e.length),e])}function Sn(e){return(0,ze.YT)(e,yn,!1)}function jn(e,t){const n=t.subtract(e);return!(n.lesser(vt()(0))||n.bitLength().toJSNumber()<1984||e.bitLength().toJSNumber()<1984||Math.floor((e.bitLength().toJSNumber()+7)/8)>256)}function Cn(e,t){const n=Math.min(e.length,t.length);for(let s=0;s<n;s++)e[s]^=t[s];return e}async function Pn(e,t){const n=await(0,ze.sc)(wn.concat([e.salt1,wn.from(t,"utf-8"),e.salt1])),s=await(0,ze.sc)(wn.concat([e.salt2,n,e.salt2])),i=await function(e,t,n){return(0,Ct.Az)(e,t,1e5)}(s,e.salt1);return(0,ze.sc)(wn.concat([e.salt2,i,e.salt2]))}async function _n(e,t){try{vn(e.p,e.g)}catch(e){throw new Error("bad p/g in password")}return Sn((0,ze.gS)(vt()(e.g),(0,ze.op)(await Pn(e,t),!1),(0,ze.op)(e.p,!1)))}async function Mn(e,t){const n=e.currentAlgo;if(!(n instanceof In.A.PasswordKdfAlgoSHA256SHA256PBKDF2HMACSHA512iter100000SHA256ModPow))throw new Error(`Unsupported password algorithm ${n?.className}`);const s=e.srp_B,i=e.srpId;if(!s||!i)throw new Error(`Undefined srp_b  ${e}`);const o=await Pn(n,t),a=(0,ze.op)(n.p,!1),{g:r}=n,d=(0,ze.op)(s,!1);try{vn(n.p,r)}catch(e){throw new Error("bad /g in password")}if(!function(e,t){return e.greater(vt()(0))&&t.subtract(e).greater(vt()(0))}(d,a))throw new Error("bad b in check");const c=(0,ze.op)(o,!1),u=bn(n.p),l=Sn(vt()(r)),f=bn(s),h=(0,ze.gS)(vt()(r),c,a),p=(0,ze.op)(await(0,ze.sc)(wn.concat([u,l])),!1),m=(0,ze.qV)(p.multiply(h),a),{a:g,aForHash:I,u:w}=await(async()=>{for(;;){const e=(0,ze.Gg)(256),t=(0,ze.op)(e,!1),n=(0,ze.gS)(vt()(r),t,a);if(jn(n,a)){const e=Sn(n),s=(0,ze.op)(await(0,ze.sc)(wn.concat([e,f])),!1);if(s.greater(vt()(0)))return{a:t,aForHash:e,u:s}}}})(),y=(0,ze.qV)(d.subtract(m),a);if(!jn(y,a))throw new Error("bad gB");const v=w.multiply(c),b=g.add(v),S=(0,ze.gS)(y,b,a),[j,C,P,_,M]=await Promise.all([(0,ze.sc)(Sn(S)),(0,ze.sc)(u),(0,ze.sc)(l),(0,ze.sc)(n.salt1),(0,ze.sc)(n.salt2)]),T=await(0,ze.sc)(wn.concat([Cn(C,P),_,M,I,f,j]));return new In.A.InputCheckPasswordSRP({srpId:i,A:wn.from(I),M1:T})}let Tn=0;function kn(){return Tn}function An(){return Math.floor(Date.now()/1e3)+Tn}const Rn="phoneNumber";function En(e,t,n){const{initialMethod:s=Rn}=n;return"phoneNumber"===s?Un(e,t,n):xn(e,t,n)}async function Dn(e,t=!1){try{return await e.invoke(new In.A.updates.GetState),!0}catch(e){if(e instanceof Error&&"Disconnect"===e.message||t)throw e;return!1}}async function Un(e,t,n){let s,i,o,a=!1;for(;;)try{if("function"==typeof n.phoneNumber)try{s=await n.phoneNumber()}catch(s){if(s instanceof Error&&"RESTART_AUTH_WITH_QR"===s.message)return xn(e,t,n);throw s}else s=n.phoneNumber;const o=await Nn(e,t,s,n.forceSMS);if(i=o.phoneCodeHash,a=o.isCodeViaApp,"string"!=typeof i)throw new Error("Failed to retrieve phone code hash");break}catch(e){if("function"!=typeof n.phoneNumber)throw e;n.onError(e)}let r,d=!1;for(;;)try{try{o=await n.phoneCode(a)}catch(s){if(s instanceof Error&&"RESTART_AUTH"===s.message)return Un(e,t,n)}if(!o)throw new Error("Code is empty");const c=await e.invoke(new In.A.auth.SignIn({phoneNumber:s,phoneCodeHash:i,phoneCode:o}));if(c instanceof In.A.auth.AuthorizationSignUpRequired){d=!0,r=c.termsOfService;break}return c.user}catch(t){if(t instanceof pe&&"SESSION_PASSWORD_NEEDED"===t.errorMessage)return Bn(e,0,n);t instanceof Error?n.onError(t):console.warn("Unexpected error:",t)}if(d)for(;;)try{const[t,o]=await n.firstAndLastNames();if(!t)throw new Error("First name is required");const{user:a}=await e.invoke(new In.A.auth.SignUp({phoneNumber:s,phoneCodeHash:i,firstName:t,lastName:o}));return r&&await e.invoke(new In.A.help.AcceptTermsOfService({id:r.id})),a}catch(e){n.onError(e)}return n.onError(new Error("Auth failed")),Un(e,t,n)}async function xn(e,t,n){let s=!1;const i=(async()=>{for(;!s;){const t=await e.invoke(new In.A.auth.ExportLoginToken({apiId:Number("1456095"),apiHash:"a93a0ef15a108a2cf421466edfc0094e",exceptIds:[]}));if(!(t instanceof In.A.auth.LoginToken))throw new Error("Unexpected");const{token:s,expires:i}=t;await Promise.race([n.qrCode({token:s,expires:i}),(0,ze.yy)(1e3*(i-An()))])}})(),o=new Promise((t=>{e.addEventHandler((e=>{e instanceof In.A.UpdateLoginToken&&t()}),{build:e=>e})}));try{await Promise.race([o,i])}catch(s){if(s instanceof Error&&"RESTART_AUTH"===s.message)return await Un(e,t,n);throw s}finally{s=!0}try{const t=await e.invoke(new In.A.auth.ExportLoginToken({apiId:Number("1456095"),apiHash:"a93a0ef15a108a2cf421466edfc0094e",exceptIds:[]}));if(t instanceof In.A.auth.LoginTokenSuccess&&t.authorization instanceof In.A.auth.Authorization)return t.authorization.user;if(t instanceof In.A.auth.LoginTokenMigrateTo){await e._switchDC(t.dcId);const n=await e.invoke(new In.A.auth.ImportLoginToken({token:t.token}));if(n instanceof In.A.auth.LoginTokenSuccess&&n.authorization instanceof In.A.auth.Authorization)return n.authorization.user}}catch(t){if(t instanceof pe&&"SESSION_PASSWORD_NEEDED"===t.errorMessage)return Bn(e,0,n);throw t}throw void 0}async function Nn(e,t,n,s=!1){try{const{apiId:i,apiHash:o}=t,a=await e.invoke(new In.A.auth.SendCode({phoneNumber:n,apiId:i,apiHash:o,settings:new In.A.CodeSettings}));if(!(a instanceof In.A.auth.SentCode))throw Error("Unexpected SentCodeSuccess");if(!s||a.type instanceof In.A.auth.SentCodeTypeSms)return{phoneCodeHash:a.phoneCodeHash,isCodeViaApp:a.type instanceof In.A.auth.SentCodeTypeApp};const r=await e.invoke(new In.A.auth.ResendCode({phoneNumber:n,phoneCodeHash:a.phoneCodeHash}));if(!(r instanceof In.A.auth.SentCode))throw Error("Unexpected SentCodeSuccess");return{phoneCodeHash:r.phoneCodeHash,isCodeViaApp:r.type instanceof In.A.auth.SentCodeTypeApp}}catch(i){if(i instanceof pe&&"AUTH_RESTART"===i.errorMessage)return Nn(e,t,n,s);throw i}}async function Bn(e,t,n,s=!1){for(;;)try{const t=await e.invoke(new In.A.account.GetPassword),i=await n.password(t.hint,s);if(!i)throw new Error("Password is empty");const o=await Mn(t,i),{user:a}=await e.invoke(new In.A.auth.CheckPassword({password:o}));return a}catch(e){n.onError(e)}}function Hn(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Gn{constructor(e){this.maxWorkers=e,Hn(this,"deferreds",[]),Hn(this,"priorityDeferreds",[]),Hn(this,"activeWorkers",0)}requestWorker(e){if(this.activeWorkers===this.maxWorkers){const t=new Yt;return e?this.priorityDeferreds.push(t):this.deferreds.push(t),t.promise}return this.activeWorkers++,Promise.resolve()}releaseWorker(){this.queueLength?(this.priorityDeferreds.shift()||this.deferreds.shift()).resolve():this.activeWorkers--}get queueLength(){return this.deferreds.length+this.priorityDeferreds.length}}class On{constructor(e){this.isUpload=e}}var qn=n(48287).hp;function Fn(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ln=4096,zn=1048576,Vn=5;class $n{constructor(e){Fn(this,"type",void 0),Fn(this,"size",void 0),Fn(this,"buffer",void 0),Fn(this,"largeFile",void 0),Fn(this,"largeFileAccessHandle",void 0),this.size=e,this.type=e&&e>self.maxBufferSize?"opfs":"memory"}async init(){if("opfs"===this.type){if(!FileSystemFileHandle?.prototype.createSyncAccessHandle)throw new Error("`createSyncAccessHandle` is not available. Cannot download files larger than 2GB.");const e=await navigator.storage.getDirectory(),t=await e.getDirectoryHandle("downloads",{create:!0});this.largeFile=await t.getFileHandle(Math.random().toString(),{create:!0}),this.largeFileAccessHandle=await this.largeFile.createSyncAccessHandle()}else this.buffer=this.size?qn.alloc(this.size):qn.alloc(0)}write(e,t){if("opfs"===this.type)this.largeFileAccessHandle.write(e,{at:t});else if(this.size)for(let n=0;n<e.length;n++){if(t+n>=this.buffer.length)return;this.buffer.writeUInt8(e[n],t+n)}else this.buffer=qn.concat([this.buffer,e])}async getData(){return"opfs"===this.type?this.largeFile.getFile():Promise.resolve(this.buffer)}}const Wn=3,Kn=6,Jn=Array(Kn).fill(void 0).map((()=>new Gn(10)));async function Qn(e,t,n,s){let{partSizeKb:i,end:o=0}=n;const{fileSize:a,dcId:r,progressCallback:d,isPriority:c,start:u=0}=n,l="id"in t?t.id:void 0,f=(...e)=>{s&&console.log(`⬇️ [${l}/${n.dcId}]`,...e)};f("Downloading file...");const h=Boolean(e.isPremium);a&&(o=o&&o<a?o:a-1);const p=o?o-u+1:void 0;i||(i=a?function(e){if(e<=65536)return 64;if(e<=104857600)return 128;if(e<=786432e3)return 256;if(e<=2097152e3)return 512;if(e<=4194304e3)return 1024;throw new Error("File size too large")}(p||a):64);const m=1024*i,g=p?Math.ceil(p/m):1,I=!o,w=Boolean(a)&&a>=10485760&&!I;let y;if(m%Ln!=0)throw new Error("The part size must be evenly divisible by 4096");e._log.info(`Downloading file in chunks of ${m} bytes`);const v=new $n(p),b=[];let S=u,j=!1,C=0;d&&d(C);let P=!1;for(await v.init();;){let n=m,i=!1;Math.floor(S/zn)!==Math.floor((S+n-1)/zn)&&(n=zn-S%zn,i=!0),S%Ln==0&&n%Ln==0||(i=!0);const a=Yn(h,w);if(await Jn[a].requestWorker(c),y&&await y.promise,I&&(y=new Yt),j){Jn[a].releaseWorker();break}const l=(...e)=>{f(`[${a}/${r}]`,...e)};if(b.push((async c=>{for(;;){let f;try{let p=!1;s&&setTimeout((()=>{p||l(`❗️️ getSender took too long ${c}`)}),8e3),f=await e.getSender(r,a,h),p=!0;let m=!1;s&&setTimeout((()=>{m||l(`❗️️ sender.send took too long ${c}`)}),6e3);const I=await Promise.race([f.send(new In.A.upload.GetFile({location:t,offset:vt()(c),limit:n,precise:i||void 0})),(0,ze.yy)(6e4).then((()=>r===e.session.dcId?(l(`Download timed out ${c}`),Promise.reject(new Error("USER_CANCELED"))):(l(`Download timed out [not main] ${c}`),Promise.reject(new Error("SESSION_REVOKED")))))]);if(e.releaseExportedSender(f),I instanceof In.A.upload.FileCdnRedirect)throw new Error("CDN download not supported");if(m=!0,d){if(d.isCanceled)throw new Error("USER_CANCELED");C+=1/g,l(`⬇️️ ${100*C}%`),d(C)}return!o&&I.bytes.length<n&&(j=!0),Jn[a].releaseWorker(),y&&y.resolve(),void v.write(I.bytes,c-u)}catch(t){if(f&&!f.isConnected()){await(0,ze.yy)(1e3);continue}if(t instanceof je){t instanceof Ce&&!P&&(f?._updateCallback(new On(!1)),P=!0),await(0,ze.yy)(1e3*t.seconds);continue}throw l(`Ended not gracefully ${c}`),Jn[a].releaseWorker(),y&&y.resolve(),j=!0,f&&e.releaseExportedSender(f),t}}})(S)),S+=n,o&&S>o)break}return await Promise.all(b),v.getData()}function Yn(e,t){const n=e?Kn:Wn;let s=0,i=1/0;for(let e=0;e<n;e++){const n=Jn[e];if(!n.queueLength)return e;if(!t&&n.queueLength<=Vn)return e;n.queueLength<=i&&(s=e,i=n.activeWorkers)}return s}var Xn=n(48287).hp;const Zn=Array(6).fill(void 0).map((()=>new Gn(10)));var es=n(48287).hp,ts=n(48287).hp;function ns(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const ss=131072,is=["u","v","w","y","d","x","c","m","b","a","s","f","i","j"];class os{constructor(e,t,n,s=os.DEFAULT_OPTIONS){if(ns(this,"_args",void 0),ns(this,"session",void 0),ns(this,"apiHash",void 0),ns(this,"apiId",void 0),ns(this,"defaultDcId",void 0),ns(this,"_useIPV6",void 0),ns(this,"_shouldForceHttpTransport",void 0),ns(this,"_shouldAllowHttpTransport",void 0),ns(this,"_shouldDebugExportedSenders",void 0),ns(this,"_log",void 0),ns(this,"floodSleepLimit",void 0),ns(this,"_connection",void 0),ns(this,"_fallbackConnection",void 0),ns(this,"_sender",void 0),ns(this,"_eventBuilders",void 0),ns(this,"_requestRetries",void 0),ns(this,"_connectionRetries",void 0),ns(this,"_connectionRetriesToFallback",void 0),ns(this,"_retryDelay",void 0),ns(this,"_retryMainConnectionDelay",void 0),ns(this,"_timeout",void 0),ns(this,"_autoReconnect",void 0),ns(this,"_config",void 0),ns(this,"_exportedSenderPromises",{}),ns(this,"_exportedSenderRefCounter",{}),ns(this,"_waitingForAuthKey",{}),ns(this,"_exportedSenderReleaseTimeouts",{}),ns(this,"_loopStarted",!1),ns(this,"_isSwitchingDc",!1),ns(this,"_destroyed",!1),ns(this,"_connectedDeferred",new Yt),ns(this,"pingCallback",void 0),ns(this,"_initWith",void 0),ns(this,"isPremium",!1),ns(this,"_lastRequest",Date.now()),!t||!n||!Number.isFinite(t))throw Error('Your API ID or Hash are invalid. Please read "Requirements" on README.md');const i={...os.DEFAULT_OPTIONS,...s};if(this.apiId=t,this.apiHash=n,this.defaultDcId=i.dcId||2,this._useIPV6=i.useIPV6,this._shouldForceHttpTransport=i.shouldForceHttpTransport,this._shouldAllowHttpTransport=i.shouldAllowHttpTransport,this._shouldDebugExportedSenders=i.shouldDebugExportedSenders,"string"==typeof i.baseLogger?this._log=new st:this._log=i.baseLogger,"string"!=typeof e&&e){if(!(e instanceof un))throw new Error("The given session must be str or a session instance")}else try{throw new Error("not implemented")}catch(t){e=new fn}this.session=e,this.floodSleepLimit=i.floodSleepLimit,this._eventBuilders=[],this._requestRetries=i.requestRetries,this._connectionRetries=i.connectionRetries,this._connectionRetriesToFallback=i.connectionRetriesToFallback,this._retryDelay=i.retryDelay||0,this._retryMainConnectionDelay=i.retryMainConnectionDelay||0,this._timeout=i.timeout,this._autoReconnect=i.autoReconnect,this._connection=i.connection,this._fallbackConnection=i.fallbackConnection,this._initWith=e=>new fe.jI.InvokeWithLayer({layer:198,query:new fe.jI.InitConnection({apiId:this.apiId,deviceModel:i.deviceModel||gn.type().toString()||"Unknown",systemVersion:i.systemVersion||gn.release().toString()||"1.0",appVersion:i.appVersion||"1.0",langCode:i.langCode,langPack:i.langPack,systemLangCode:i.systemLangCode,query:e,proxy:void 0})}),this._args=i}async connect(){await this._initSession(),void 0===this._sender&&(this._sender=new nn(this.session.getAuthKey(),{logger:this._log,dcId:this.session.dcId,retries:this._connectionRetries,retriesToFallback:this._connectionRetriesToFallback,shouldForceHttpTransport:this._shouldForceHttpTransport,shouldAllowHttpTransport:this._shouldAllowHttpTransport,delay:this._retryDelay,retryMainConnectionDelay:this._retryMainConnectionDelay,autoReconnect:this._autoReconnect,connectTimeout:this._timeout,authKeyCallback:this._authKeyCallback.bind(this),updateCallback:this._handleUpdate.bind(this),getShouldDebugExportedSenders:this.getShouldDebugExportedSenders.bind(this),isMainSender:!0}));const e=new this._connection({ip:this.session.serverAddress,port:this.session.port,dcId:this.session.dcId,loggers:this._log,isTestServer:this.session.isTestServer}),t=new this._fallbackConnection({ip:this.session.serverAddress,port:this.session.port,dcId:this.session.dcId,loggers:this._log,isTestServer:this.session.isTestServer});if(!await this._sender.connect(e,!1,t))return void(this._loopStarted||(this._updateLoop(),this._loopStarted=!0));this.session.setAuthKey(this._sender.authKey),await this._sender.send(this._initWith(new fe.jI.help.GetConfig)),this._loopStarted||(this._updateLoop(),this._loopStarted=!0),this._connectedDeferred.resolve(),this._isSwitchingDc=!1;const n=await this._borrowExportedSender(this.session.dcId,!1,void 0,0,this.isPremium);n&&this.releaseExportedSender(n)}async _initSession(){if(await this.session.load(),!this.session.serverAddress||this.session.serverAddress.includes(":")!==this._useIPV6){const e=cn(this.defaultDcId);this.session.setDC(this.defaultDcId,e.ipAddress,this._args.useWSS?443:80,this._args.isTestServerRequested)}}setPingCallback(e){this.pingCallback=e}async setForceHttpTransport(e){this._shouldForceHttpTransport=e,await this.disconnect(),this._sender=void 0,await this.connect()}async setAllowHttpTransport(e){this._shouldAllowHttpTransport=e,await this.disconnect(),this._sender=void 0,await this.connect()}setShouldDebugExportedSenders(e){this._shouldDebugExportedSenders=e}getShouldDebugExportedSenders(){return this._shouldDebugExportedSenders}async _updateLoop(){let e;const t=this._sender;if(!t)throw new Error("Sender is not initialized");for(;!this._destroyed;)if(await(0,ze.yy)(3e3),t.isReconnecting||this._isSwitchingDc)e=void 0;else{try{const n=()=>{if(!this._destroyed)return t.send(new fe.jI.PingDelayDisconnect({pingId:vt()((0,ze.hw)(Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)),disconnectDelay:6e4}))},s=Date.now(),i=e?s-e:void 0;if(!i||i<5e3)await rs((()=>as(n,5e3)),3,100);else{let e=setTimeout((()=>{this._handleUpdate(new Et(Et.disconnected)),e=void 0}),1e3);await as(n,3e3),e&&(clearTimeout(e),e=void 0),this._handleUpdate(new Et(Et.connected))}e=Date.now()}catch(n){if(console.warn(n),e=void 0,t.isReconnecting||this._isSwitchingDc)continue;if(this._destroyed)break;t.reconnect()}if(Date.now()-this._lastRequest>18e5){try{await(this.pingCallback?.())}catch(e){}e=void 0}}await this.disconnect()}async disconnect(){await(this._sender?.disconnect()),await Promise.all(Object.values(this._exportedSenderPromises).map((e=>Object.values(e).map((e=>e?.then((e=>e?.disconnect())))))).flat()),Object.values(this._exportedSenderReleaseTimeouts).forEach((e=>{Object.values(e).forEach((e=>{clearTimeout(e)}))})),this._exportedSenderRefCounter={},this._exportedSenderPromises={},this._waitingForAuthKey={}}async destroy(){this._destroyed=!0;try{await this.disconnect(),this._sender?.destroy()}catch(e){}this.session.delete(),this._eventBuilders=[]}async _switchDC(e){if(!this._sender)throw new Error("Sender is not initialized");this._log.info(`Reconnecting to new data center ${e}`);const t=cn(e),n=this.session.isTestServer||this._args.isTestServerRequested;return this.session.setDC(e,t.ipAddress,t.port,n),await this._sender.authKey.setKey(void 0),this.session.setAuthKey(void 0),this._isSwitchingDc=!0,await this.disconnect(),this._sender=void 0,this.connect()}_authKeyCallback(e,t){this.session.setAuthKey(e,t)}async _cleanupExportedSender(e,t){this.session.dcId!==e&&this.session.setAuthKey(void 0,e),this._shouldDebugExportedSenders&&console.log(`🧹 Cleanup idx=${t} dcId=${e}`);const n=await this._exportedSenderPromises[e][t];delete this._exportedSenderPromises[e][t],delete this._exportedSenderRefCounter[e][t],await(n?.disconnect())}async _cleanupExportedSenders(e){const t=Object.values(this._exportedSenderPromises[e]);t.length&&(this.session.dcId!==e&&this.session.setAuthKey(void 0,e),this._exportedSenderPromises[e]={},this._exportedSenderRefCounter[e]={},await Promise.all(t.map((async e=>{const t=await e;await(t?.disconnect())}))))}async _connectSender(e,t,n,s=!1){let i,o=Boolean(e.authKey.getKey());if(!o)if(this._waitingForAuthKey[t]){await this._waitingForAuthKey[t];const n=this.session.getAuthKey(t);o=Boolean(e.authKey?.getKey()),o&&await e.authKey.setKey(n.getKey())}else this._waitingForAuthKey[t]=new Promise((e=>{i=e}));const a=cn(t,o);for(;;)try{return await e.connect(new this._connection({ip:a.ipAddress,port:a.port,dcId:t,loggers:this._log,isTestServer:this.session.isTestServer,isPremium:!!o&&s}),!1,new this._fallbackConnection({ip:a.ipAddress,port:a.port,dcId:t,loggers:this._log,isTestServer:this.session.isTestServer,isPremium:!!o&&s})),this.session.dcId===t||e._authenticated||await navigator.locks.request("GRAMJS_AUTH_EXPORT",(async()=>{this._log.info(`Exporting authorization for data center ${a.ipAddress}`);const n=await this.invoke(new fe.jI.auth.ExportAuthorization({dcId:t})),s=this._initWith(new fe.jI.auth.ImportAuthorization({id:n.id,bytes:n.bytes}));await e.send(s),e._authenticated=!0})),e._dcId=t,e.userDisconnected=!1,i&&(i(),delete this._waitingForAuthKey[t]),this._shouldDebugExportedSenders&&console.warn(`✅ Connected to exported sender idx=${n} dc=${t}`),e}catch(s){this._shouldDebugExportedSenders&&console.error(`☠️ ERROR! idx=${n} dcId=${t} ${s.message}`),console.error(s),await(0,ze.yy)(1e3),await e.disconnect()}}releaseExportedSender(e){const t=e._dcId,n=e._senderIndex;this._exportedSenderRefCounter[t]&&this._exportedSenderRefCounter[t][n]&&(this._exportedSenderRefCounter[t][n]-=1,this._exportedSenderRefCounter[t][n]<=0&&(this._exportedSenderReleaseTimeouts[t]||(this._exportedSenderReleaseTimeouts[t]={}),this._exportedSenderReleaseTimeouts[t][n]=setTimeout((()=>{this._shouldDebugExportedSenders&&console.log(`[CC] [idx=${n} dcId=${t}] 🚪 Release`),e.disconnect(),this._exportedSenderReleaseTimeouts[t][n]=void 0,this._exportedSenderPromises[t][n]=void 0}),3e4)))}async _borrowExportedSender(e,t,n,s,i){const o=s||0;let a;this._exportedSenderPromises[e]||(this._exportedSenderPromises[e]={}),this._exportedSenderRefCounter[e]||(this._exportedSenderRefCounter[e]={}),this._exportedSenderPromises[e][o]&&!t||(this._shouldDebugExportedSenders&&console.warn(`🕒 Connecting to exported sender idx=${o} dc=${e} `+(t?"(reconnect)":"")),this._exportedSenderRefCounter[e][o]=0,this._exportedSenderPromises[e][o]=this._connectSender(n||this._createExportedSender(e,o),e,s,i));try{if(a=await this._exportedSenderPromises[e][o],!a?.isConnected())return a?.isConnecting?(await(0,ze.yy)(1e3),this._borrowExportedSender(e,!1,a,o,i)):this._borrowExportedSender(e,!0,a,o,i)}catch(t){return console.error(t),this._borrowExportedSender(e,!0,void 0,o,i)}return this._exportedSenderRefCounter[e][o]+=1,this._exportedSenderReleaseTimeouts[e]||(this._exportedSenderReleaseTimeouts[e]={}),this._exportedSenderReleaseTimeouts[e][o]&&(clearTimeout(this._exportedSenderReleaseTimeouts[e][o]),this._exportedSenderReleaseTimeouts[e][o]=void 0),a}_createExportedSender(e,t){return new nn(this.session.getAuthKey(e),{logger:this._log,dcId:e,senderIndex:t,retries:this._connectionRetries,retriesToFallback:this._connectionRetriesToFallback,delay:this._retryDelay,retryMainConnectionDelay:this._retryMainConnectionDelay,shouldForceHttpTransport:this._shouldForceHttpTransport,shouldAllowHttpTransport:this._shouldAllowHttpTransport,autoReconnect:this._autoReconnect,connectTimeout:this._timeout,authKeyCallback:this._authKeyCallback.bind(this),isMainSender:e===this.session.dcId,isExported:!0,updateCallback:this._handleUpdate.bind(this),getShouldDebugExportedSenders:this.getShouldDebugExportedSenders.bind(this),onConnectionBreak:()=>this._cleanupExportedSender(e,t)})}getSender(e,t,n){return e?this._borrowExportedSender(e,void 0,void 0,t,n):Promise.resolve(this._sender)}downloadFile(e,t){return async function(e,t,n,s){const{dcId:i}=n;for(let o=0;o<5;o++)try{return await Qn(e,t,n,s)}catch(t){if(!(t instanceof pe&&(t.errorMessage.startsWith("SESSION_REVOKED")||t.errorMessage.startsWith("CONNECTION_NOT_INITED"))&&o<4))throw t;await e._cleanupExportedSenders(i)}}(this,e,t,this._shouldDebugExportedSenders)}downloadMedia(e,t){let n;if(e instanceof fe.jI.Message||e instanceof fe.jI.StoryItem)n=e.media;else if(e instanceof fe.jI.MessageService){const t=e.action;"photo"in t&&(n=t.photo)}else n=e;return n instanceof fe.jI.MessageMediaWebPage&&n.webpage instanceof fe.jI.WebPage&&(n=n.webpage.document||n.webpage.photo),n instanceof fe.jI.MessageMediaPhoto||n instanceof fe.jI.Photo?this._downloadPhoto(n,t):n instanceof fe.jI.MessageMediaDocument||n instanceof fe.jI.Document?this._downloadDocument(n,t):n instanceof fe.jI.WebDocument||n instanceof fe.jI.WebDocumentNoProxy?this._downloadWebDocument(n):void 0}downloadProfilePhoto(e,t=!1){const n=e.photo;if(!(n instanceof fe.jI.UserProfilePhoto||n instanceof fe.jI.ChatPhoto))return;const s=n.dcId,i=new fe.jI.InputPeerPhotoFileLocation({peer:rn(e),photoId:n.photoId,big:t||void 0});return this.downloadFile(i,{dcId:s,isPriority:!0})}downloadStickerSetThumb(e){if(!e.thumbs?.length&&!e.thumbDocumentId)return;const t=e.thumbVersion;return e.thumbDocumentId?this.invoke(new fe.jI.messages.GetCustomEmojiDocuments({documentId:[e.thumbDocumentId]})).then((e=>{const t=e[0];if(t&&!(t instanceof fe.jI.DocumentEmpty))return this.downloadFile(new fe.jI.InputDocumentFileLocation({id:t.id,accessHash:t.accessHash,fileReference:t.fileReference,thumbSize:""}),{fileSize:t.size.toJSNumber(),dcId:t.dcId})})):this.downloadFile(new fe.jI.InputStickerSetThumb({stickerset:new fe.jI.InputStickerSetID({id:e.id,accessHash:e.accessHash}),thumbVersion:t}),{dcId:e.thumbDcId})}pickFileSize(e,t){if(!e?.length)return;if(!t)return e.reduce(((e,t)=>"w"in t?e&&"w"in e&&e.w>t.w?e:t:e),void 0);let n;for(let s=is.indexOf(t);s<is.length;s++)if(n=e.find((e=>"type"in e&&e.type===is[s])),n)return n}_downloadCachedPhotoSize(e){let t;return t=e instanceof fe.jI.PhotoStrippedSize?dn(e.bytes):e.bytes,t}_downloadPhoto(e,t){let n=e;if(e instanceof fe.jI.MessageMediaPhoto&&e.photo instanceof fe.jI.Photo&&(n=e.photo),!(n instanceof fe.jI.Photo))return;const s="u"===t.sizeType||"v"===t.sizeType?n.videoSizes:[],i=this.pickFileSize([...s,...n.sizes],t.sizeType);if(!i||i instanceof fe.jI.PhotoSizeEmpty||i instanceof fe.jI.VideoSizeEmojiMarkup||i instanceof fe.jI.VideoSizeStickerMarkup)return;if(i instanceof fe.jI.PhotoCachedSize||i instanceof fe.jI.PhotoStrippedSize)return this._downloadCachedPhotoSize(i);let o;return o=i instanceof fe.jI.PhotoSizeProgressive?Math.max(...i.sizes):"size"in i?i.size:512,this.downloadFile(new fe.jI.InputPhotoFileLocation({id:n.id,accessHash:n.accessHash,fileReference:n.fileReference,thumbSize:i.type}),{dcId:n.dcId,fileSize:o,progressCallback:t.progressCallback})}_downloadDocument(e,t){let n,s=e;if(s instanceof fe.jI.MessageMediaDocument&&s.document instanceof fe.jI.Document&&(s=s.document),s instanceof fe.jI.Document){if(t.sizeType){if(n=this.pickFileSize([...s.thumbs||[],...s.videoThumbs||[]],t.sizeType),!n&&s.mimeType.startsWith("video/"))return;if(n&&(n instanceof fe.jI.PhotoCachedSize||n instanceof fe.jI.PhotoStrippedSize))return this._downloadCachedPhotoSize(n)}return this.downloadFile(new fe.jI.InputDocumentFileLocation({id:s.id,accessHash:s.accessHash,fileReference:s.fileReference,thumbSize:n&&"type"in n?n.type:""}),{fileSize:n&&"size"in n?n.size:s.size.toJSNumber(),progressCallback:t.progressCallback,start:t.start,end:t.end,dcId:s.dcId,workers:t.workers})}}async _downloadWebDocument(e){if(e instanceof fe.jI.WebDocumentNoProxy){const t=await fetch(e.url).then((e=>e.arrayBuffer()));return ts.from(t)}try{const t=[];let n=0;for(;;){const s=new fe.jI.upload.GetWebFile({location:new fe.jI.InputWebFileLocation({url:e.url,accessHash:e.accessHash}),offset:n,limit:ss}),i=await this._borrowExportedSender(this._config?.webfileDcId||4);if(!i)throw new Error("Failed to obtain sender");const o=await i.send(s);if(this.releaseExportedSender(i),n+=ss,!o.bytes.length)break;if(t.push(o.bytes),o.bytes.length<ss)break}return ts.concat(t)}catch(e){if(e instanceof pe&&"WEBFILE_NOT_AVAILABLE"===e.errorMessage)return ts.alloc(0);throw e}}async downloadStaticMap(e,t,n,s,i,o,a,r){try{const d=[];let c=0;for(;;)try{const u=new fe.jI.upload.GetWebFile({location:new fe.jI.InputWebFileGeoPointLocation({geoPoint:new fe.jI.InputGeoPoint({lat:n,long:t,accuracyRadius:r}),accessHash:e,w:s,h:i,zoom:o,scale:a}),offset:c,limit:ss}),l=await this._borrowExportedSender(4);if(!l)throw new Error("Failed to obtain sender");const f=await l.send(u);if(this.releaseExportedSender(l),c+=ss,!f.bytes.length)break;if(d.push(f.bytes),f.bytes.length<ss)break}catch(e){if(e instanceof je){console.warn(`getWebFile: sleeping for ${e.seconds}s on flood wait`),await(0,ze.yy)(1e3*e.seconds);continue}}return ts.concat(d)}catch(e){if(e instanceof pe&&"WEBFILE_NOT_AVAILABLE"===e.errorMessage)return ts.alloc(0);throw e}}async invoke(e,t,n,s){if("request"!==e.classType)throw new Error("You can only invoke MTProtoRequests");const i=void 0!==t;let o=i?await this.getSender(t):this._sender;this._lastRequest=Date.now(),await this._connectedDeferred.promise;const a=new Zt(e,n);let r=0;for(r=0;r<this._requestRetries;r++){o.addStateToQueue(a);try{const e=await a.promise;return a.finished.resolve(),i&&this.releaseExportedSender(o),e}catch(e){if(e instanceof we||e instanceof pe&&("RPC_CALL_FAIL"===e.errorMessage||"RPC_MCGET_FAIL"===e.errorMessage||e.errorMessage.match(/INTERDC_\d_CALL(_RICH)?_ERROR/)))this._log.warn(`Telegram is having internal issues ${e.constructor.name}`),await(0,ze.yy)(2e3);else if(e instanceof je||e instanceof _e){if(!(e.seconds<=this.floodSleepLimit))throw a.finished.resolve(),i&&this.releaseExportedSender(o),e;this._log.info(`Sleeping for ${e.seconds}s on flood wait`),await(0,ze.yy)(1e3*e.seconds)}else if(e instanceof Se||e instanceof Me||e instanceof be){if(this._log.info(`Phone migrated to ${e.newDc}`),(e instanceof Se||e instanceof Me)&&await Dn(this))throw a.finished.resolve(),i&&this.releaseExportedSender(o),e;await this._switchDC(e.newDc),i&&this.releaseExportedSender(o),o=void 0===t?this._sender:await this.getSender(t)}else if(e instanceof Pe)await a.isReady(),a.after=void 0;else if(e instanceof pe&&"CONNECTION_NOT_INITED"===e.errorMessage)await this.disconnect(),await(0,ze.yy)(2e3),await this.connect();else{if(!(e instanceof ye))throw a.finished.resolve(),i&&this.releaseExportedSender(o),e;if(!s)throw a.finished.resolve(),i&&this.releaseExportedSender(o),e}}a.resetPromise()}throw i&&this.releaseExportedSender(o),new Error(`Request was unsuccessful ${r} time(s)`)}async invokeBeacon(e,t){if("request"!==e.classType)throw new Error("You can only invoke MTProtoRequests");const n=void 0!==t,s=n?await this.getSender(t):this._sender;s.sendBeacon(e),n&&this.releaseExportedSender(s)}setIsPremium(e){this.isPremium=e}async getMe(){try{return(await this.invoke(new fe.jI.users.GetUsers({id:[new fe.jI.InputUserSelf]})))[0]}catch(e){this._log.warn("error while getting me"),this._log.warn(e)}}async loadConfig(){this._config||(this._config=await this.invoke(new fe.jI.help.GetConfig))}async start(e){if(this.isConnected()||await this.connect(),this.loadConfig(),await Dn(this,e.shouldThrowIfUnauthorized))return;const t={apiId:this.apiId,apiHash:this.apiHash};await async function(e,t,n){let s;var i;s="botAuthToken"in n?await async function(e,t,n){const{apiId:s,apiHash:i}=t,{botAuthToken:o}=n,{user:a}=await e.invoke(new In.A.auth.ImportBotAuthorization({apiId:s,apiHash:i,botAuthToken:o}));return a}(e,t,n):"webAuthToken"in n&&n.webAuthToken?await async function(e,t,n){try{const{apiId:s,apiHash:i}=t,o=await e.invoke(new In.A.auth.ImportWebTokenAuthorization({webAuthToken:n.webAuthToken,apiId:s,apiHash:i}));if(o instanceof In.A.auth.Authorization)return o.user;throw new Error("SIGN_UP_REQUIRED")}catch(s){return s instanceof pe&&"SESSION_PASSWORD_NEEDED"===s.errorMessage?Bn(e,0,n,!0):(e._log.error(`Failed to login with web token: ${s}`),n.webAuthTokenFailed(),En(e,t,{...n,webAuthToken:void 0}))}}(e,t,n):await En(e,t,n),e._log.info(`Signed in successfully as ${i=s,i instanceof fe.jI.User?i.lastName&&i.firstName?`${i.firstName} ${i.lastName}`:i.firstName?i.firstName:i.lastName?i.lastName:"":i instanceof fe.jI.Chat||i instanceof fe.jI.Channel?i.title:""}`)}(this,t,e)}uploadFile(e){return async function(e,t,n){const{file:s,onProgress:i}=t,o=Boolean(e.isPremium),{name:a,size:r}=s,d=(0,ze.op)((0,ze.Gg)(8),!0,!0),c=r>10485760,u=(...e)=>{n&&console.log(`⬆️ [${d}]`,...e)};u("Uploading file...");const l=1024*function(e){if(e<=104857600)return 128;if(e<=786432e3)return 256;if(e<=2097152e3)return 512;if(e<=4194304e3)return 512;throw new Error("File size too large")}(r),f=Math.floor((r+l-1)/l),h=Zn.map((({activeWorkers:e})=>e));let p=h.indexOf(Math.min(...h)),m=0;i&&i(m);let g=!1;const I=[];for(let t=0;t<f;t++){const a=p%(o?6:3);if(await Zn[a].requestWorker(),i?.isCanceled){Zn[a].releaseWorker();break}const r=(...e)=>{u(`[${a}]`,...e)},h=s.slice(t*l,(t+1)*l);I.push((async(t,s)=>{for(;;){let u;try{let i=!1;n&&setTimeout((()=>{i||r(`❗️️ getSender took too long j=${t}`)}),8e3),u=await e.getSender(e.session.dcId,a,o),i=!0;let l=!1;const h=await s.arrayBuffer();n&&setTimeout((()=>{l||r(`❗️️ sender.send took too long j=${t}`)}),6e3),await u.send(c?new In.A.upload.SaveBigFilePart({fileId:d,filePart:t,fileTotalParts:f,bytes:Xn.from(h)}):new In.A.upload.SaveFilePart({fileId:d,filePart:t,bytes:Xn.from(h)})),e.releaseExportedSender(u),l=!0}catch(n){if(r(`❗️️️Upload part failed ${n?.toString()} j=${t}`),u&&!u.isConnected()){await(0,ze.yy)(1e3);continue}if(n instanceof je){n instanceof Ce&&!g&&(u?._updateCallback(new On(!0)),g=!0),await(0,ze.yy)(1e3*n.seconds);continue}throw Zn[a].releaseWorker(),u&&e.releaseExportedSender(u),n}if(Zn[a].releaseWorker(),i){if(i.isCanceled)throw new Error("USER_CANCELED");m+=1/f,r(100*m+"%"),i(m)}break}})(t,h)),p++}return await Promise.all(I),c?new In.A.InputFileBig({id:d,parts:f,name:a}):new In.A.InputFile({id:d,parts:f,name:a,md5Checksum:""})}(this,e,this._shouldDebugExportedSenders)}updateTwoFaSettings(e){return async function(e,{isCheckPassword:t,currentPassword:n,newPassword:s,hint:i="",email:o,emailCodeCallback:a,onEmailCodeError:r}){if(!s&&!n)throw new Error("Neither `currentPassword` nor `newPassword` is present");if(o&&(!a||!r))throw new Error("`email` present without `emailCodeCallback` and `onEmailCodeError`");const d=await e.invoke(new In.A.account.GetPassword),c=d.newAlgo;if(c instanceof In.A.PasswordKdfAlgoUnknown)throw new Error("Password algorithm is unknown");c.salt1=es.concat([c.salt1,(0,ze.Gg)(32)]),!d.hasPassword&&n&&(n=void 0);const u=n?await Mn(d,n):new In.A.InputCheckPasswordEmpty;if(t)await e.invoke(new In.A.auth.CheckPassword({password:u}));else try{await e.invoke(new In.A.account.UpdatePasswordSettings({password:u,newSettings:new In.A.account.PasswordInputSettings({newAlgo:c,newPasswordHash:s?await _n(c,s):es.alloc(0),hint:i,email:o,newSecureSettings:void 0})}))}catch(t){if(!(t instanceof Te))throw t;for(;;)try{const n=await a(t.codeLength);if(!n)throw new Error("Code is empty");await e.invoke(new In.A.account.ConfirmPasswordEmail({code:n}));break}catch(e){r(e)}}}(this,e)}getTmpPassword(e,t){return async function(e,t,n=60){const s=await e.invoke(new In.A.account.GetPassword);if(!s)return;const i=await Mn(s,t);return await e.invoke(new In.A.account.GetTmpPassword({password:i,period:n}))}(this,e,t)}getCurrentPassword(e){return async function(e,t){const n=await e.invoke(new In.A.account.GetPassword);if(n)return t?await Mn(n,t):new In.A.InputCheckPasswordEmpty}(this,e)}addEventHandler(e,t){this._eventBuilders.push([t,e])}_handleUpdate(e){if(e instanceof fe.jI.Updates||e instanceof fe.jI.UpdatesCombined){const t=[];for(const n of[...e.users,...e.chats])t.push(n);this._processUpdate(e,t)}else e instanceof fe.jI.UpdateShort?this._processUpdate(e.update,void 0):this._processUpdate(e,void 0)}_processUpdate(e,t){e._entities=t||[];const n={update:e};this._dispatchUpdate(n)}async _dispatchUpdate(e){for(const[t,n]of this._eventBuilders){const s=t.build(e.update);s&&await n(s)}}isConnected(){return!(!this._sender||!this._sender.isConnected())}}function as(e,t){let n=!1;return Promise.race([e(),(0,ze.yy)(t).then((()=>n?void 0:Promise.reject(new Error("TIMEOUT"))))]).finally((()=>{n=!0}))}async function rs(e,t,n){for(let s=0;s<t;s++)try{return await e()}catch(e){if(s===t-1)throw e;await(0,ze.yy)(n)}}ns(os,"DEFAULT_OPTIONS",{connection:class extends gt{constructor(...e){super(...e),kt(this,"ObfuscatedIO",At),kt(this,"PacketCodecClass",jt)}},fallbackConnection:wt,useIPV6:!1,timeout:10,requestRetries:5,connectionRetries:1/0,connectionRetriesToFallback:1,retryDelay:1e3,retryMainConnectionDelay:1e4,autoReconnect:!0,sequentialUpdates:!1,floodSleepLimit:60,deviceModel:void 0,systemVersion:void 0,appVersion:void 0,langCode:"en",langPack:"weba",systemLangCode:"en",baseLogger:"gramjs",useWSS:!1,additionalDcsDisabled:!1,dcId:2,isTestServerRequested:!1,shouldAllowHttpTransport:!1,shouldForceHttpTransport:!1,shouldDebugExportedSenders:!1});const ds=os,cs=60,us=3600,ls=86400;function fs(e){return e.hasOwnProperty("userId")}function hs(e){return e.hasOwnProperty("chatId")}function ps(e,t){return"user"===t?e.toString():"channel"===t?`-1${e.toString().padStart(Q-2,"0")}`:`-${e}`}function ms(e){return fs(e)?ps(e.userId,"user"):hs(e)?ps(e.chatId,"chat"):ps(e.channelId,"channel")}function gs(e){const{color:t,backgroundEmojiId:n}=e;return{color:t,backgroundEmojiId:n?.toString()}}function Is(e){return e instanceof fe.jI.EmojiStatus||e instanceof fe.jI.EmojiStatusCollectible?{documentId:e.documentId.toString(),until:e.until}:void 0}var ws=n(48287).hp;const ys="#111111DD",vs="#E4D00A",bs={INVOKE:"#49DBF5",BEACON:"#F549DB",RESPONSE:"#6887F7",CONNECTING:"#E4D00A",CONNECTED:"#26D907","CONNECTING ERROR":"#D1191C","INVOKE ERROR":"#D1191C",UPDATE:"#0DD151","UNEXPECTED UPDATE":"#9C9C9C","UNEXPECTED RESPONSE":"#D1191C"},Ss={PHONE_NUMBER_INVALID:"ErrorPhoneNumberInvalid",PHONE_CODE_INVALID:"ErrorCodeInvalid",PASSWORD_HASH_INVALID:"ErrorIncorrectPassword",PHONE_PASSWORD_FLOOD:"ErrorPasswordFlood",PHONE_NUMBER_BANNED:"ErrorPhoneBanned",EMAIL_UNCONFIRMED:"ErrorEmailUnconfirmed",EMAIL_HASH_EXPIRED:"ErrorEmailHashExpired",NEW_SALT_INVALID:"ErrorNewSaltInvalid",SRP_PASSWORD_CHANGED:"ErrorPasswordChanged",CODE_INVALID:"ErrorEmailCodeInvalid",PASSWORD_MISSING:"ErrorPasswordMissing"};function js(e){if(e instanceof fe.jI.Message||e instanceof fe.jI.MessageService)return ms(e.peerId)}function Cs(e){return e instanceof fe.jI.DialogFilter||e instanceof fe.jI.DialogFilterChatlist}function Ps(e){return String.fromCharCode(...e)}function _s(e){return ws.from(e,"binary")}function Ms(e,...t){("UNEXPECTED RESPONSE"===e?console.error:"INVOKE ERROR"===e||"UNEXPECTED UPDATE"===e?console.warn:console.log)(`%cGramJS%c${e}`,`color: ${vs}; background: ${ys}; padding: 0.25rem; border-radius: 0.25rem;`,`color: ${bs[e]}; background: ${ys}; padding: 0.25rem; border-radius: 0.25rem; margin-left: 0.25rem;`,...t)}function Ts(e){return e instanceof Error||(d&&console.warn("Unexpected error type",e),!1)}function ks(e){let t;const n=e instanceof pe?e.errorMessage:void 0;return e instanceof je?t={key:"ErrorFloodTime",variables:{time:As(e.seconds)}}:e instanceof ke?t={key:"ErrorPasswordFresh",variables:{time:As(e.seconds)}}:e instanceof pe&&(t={key:Ss[e.errorMessage]}),t||(t=e.message?{key:"ErrorUnexpectedMessage",variables:{error:e.message}}:{key:"ErrorUnexpected"}),{messageKey:t,errorMessage:n,error:e}}function As(e){if(e<cs)return{key:"Seconds",variables:{count:e},options:{pluralValue:e}};if(e<us){const t=function(e,t){return(0,Math.ceil)(e/cs)}(e);return{key:"Minutes",variables:{count:t},options:{pluralValue:t}}}if(e<ls){const t=function(e,t){return(0,Math.ceil)(e/us)}(e);return{key:"Hours",variables:{count:t},options:{pluralValue:t}}}const t=function(e,t){return(0,Math.ceil)(e/ls)}(e);return{key:"Days",variables:{count:t},options:{pluralValue:t}}}function Rs(e,t=!1,n="image/jpeg"){return`${t?"":`data:${n};base64,`}${btoa(String.fromCharCode(...e))}`}function Es(e){const{flags:t,CONSTRUCTOR_ID:n,SUBCLASS_OF_ID:s,className:i,classType:o,getBytes:a,...r}=e;return r}var Ds=n(48287).hp;const Us="BroadcastChannel"in self,xs=Us?new BroadcastChannel("tt-global"):void 0;let Ns=[];const Bs=re((()=>{xs.postMessage({type:"localDbUpdate",batchedUpdates:Ns}),Ns=[]}),100);function Hs(e){if(e instanceof Uint8Array)return Ds.from(e);if("object"==typeof e&&1===Object.keys(e).length&&"value"===Object.keys(e)[0])return vt()(e.value);if(Array.isArray(e))return e.map(Hs);if("object"!=typeof e||!("CONSTRUCTOR_ID"in e))return e;const t=e.className.split(".").reduce(((e,t)=>e[t]),fe.jI),n=Es(e);return new t(Object.keys(n).reduce(((e,t)=>(e[t]=Hs(n[t]),e)),{}))}function Gs(e){return["localMessages","chats","users","messages","documents","stickerSets","photos","webDocuments","stories","commonBoxState","channelPtsById"].reduce(((t,n)=>{const s=e?.[n]??{},i=Object.keys(s).reduce(((e,t)=>{if("commonBoxState"===n||"channelPtsById"===n){const n=s;return e[t]=n[t],e}return e[t]=Hs(s[t]),e}),{});var o;return t[n]=Us?(o=n,new Proxy(i,{get:(e,t,n)=>Reflect.get(e,t,n),set:(e,t,n)=>(Ns.push({name:o,prop:t,value:n}),Bs(),Reflect.set(e,t,n))})):i,t}),{})}const Os=Gs(),qs=Os;function Fs(){xs&&xs.postMessage({type:"localDbUpdateFull",localDb:Object.keys(Os).reduce(((e,t)=>(e[t]={...Os[t]},e)),{})})}let Ls;function zs(e){!function(e){Js?Js.push(e):Js=[e],Ws&&!U.has(e["@type"])||(Ws=re($s,D,!0),Ks=Math.random()),Ws(Ks)}(e)}function Vs(e){Ls(e)}d&&(globalThis.getLocalDb=()=>Os);const $s=de((function(e){if(!Js||e!==Ks)return;const t=Js;Js=void 0,t.forEach(Ls)}));let Ws,Ks,Js,Qs=function(e){return e.Bold="MessageEntityBold",e.Blockquote="MessageEntityBlockquote",e.BotCommand="MessageEntityBotCommand",e.Cashtag="MessageEntityCashtag",e.Code="MessageEntityCode",e.Email="MessageEntityEmail",e.Hashtag="MessageEntityHashtag",e.Italic="MessageEntityItalic",e.MentionName="MessageEntityMentionName",e.Mention="MessageEntityMention",e.Phone="MessageEntityPhone",e.Pre="MessageEntityPre",e.Strike="MessageEntityStrike",e.TextUrl="MessageEntityTextUrl",e.Url="MessageEntityUrl",e.Underline="MessageEntityUnderline",e.Spoiler="MessageEntitySpoiler",e.CustomEmoji="MessageEntityCustomEmoji",e.Unknown="MessageEntityUnknown",e}({});const Ys=-1,Xs="MESSAGE_DELETED";let Zs=function(e){return e[e.BlobUrl=0]="BlobUrl",e[e.Progressive=1]="Progressive",e[e.DownloadUrl=2]="DownloadUrl",e[e.Text=3]="Text",e}({});String.fromCharCode(8205);const ei=/(?:\ud83c[\udd70\udd71\udd7e\udd7f]\ufe0f)|(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83c\udfc3|\ud83d\udeb6|\ud83e\uddce)(?:\ud83c[\udffb-\udfff])?(?:\u200d[\u2640\u2642]\ufe0f)?(?:\u200d\u27a1\ufe0f)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\ud83e[\uddaf\uddbc\uddbd])(?:\u200d\u27a1\ufe0f)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf\uddaf-\uddb3\uddbc\uddbc\uddbd\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd\uddce\uddce\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83e\uddd1\u200d\ud83e\uddd1\u200d\ud83e\uddd2\u200d\ud83e\uddd2|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83e\uddd1\u200d\ud83e\uddd1\u200d\ud83e\uddd2|\ud83e\uddd1\u200d\ud83e\uddd2\u200d\ud83e\uddd2|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u26d3\ufe0f\u200d\ud83d\udca5|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udf44\u200d\ud83d\udfeb|\ud83c\udf4b\u200d\ud83d\udfe9|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc26\u200d\ud83d\udd25|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83d\ude42\u200d\u2194\ufe0f|\ud83d\ude42\u200d\u2195\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddd1\u200d\ud83e\uddd2|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b|\ud83d\udc26\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|\ud83e\udef0|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef1-\udef8]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedc-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude7c\ude80-\ude88\ude90-\udebd\udebf-\udec2\udece-\udedb\udee0-\udee8]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g,ti=[[/\u{1f3f3}\u200d\u{1f308}/gu,"🏳️‍🌈"],[/\u{1f3f3}\u200d\u26a7\ufe0f?/gu,"🏳️‍⚧️"],[/\u26d3\u200d\u{1f4a5}/gu,"⛓️‍💥"],[/\u200d([\u2640\u2642])(?!\ufe0f)/gu,"‍$1️"]],ni=100,si=8*ni;function ii(e){const t=e.matchAll(ei);let n=0,s=0;for(const e of t){if(e.index!==s)return!1;n++,s=e.index+e[0].length}return s===e.length&&n}function oi(e,t){if(e.text)return!t&&1===Object.keys(e).length&&!e.text.entities?.some((e=>e.type!==Qs.CustomEmoji))&&function(e){const t=function(e){if(!e.match(ei))return e;for(const[t,n]of ti)e=e.replace(t,n);return e}(e).split("\n"),n=t.join("");if(n.length>si)return!1;const s=ii(n);if(!s||s>ni)return!1;let i=t.length;for(const e of t){const t=ii(e);if(!1===t)return!1;t>i&&(i=t)}return i}(e.text.text)||void 0}function ai(e,t){return e.reduce(((e,n)=>(e[n[t]]=n,e)),{})}function ri(e,t){return e.reduce(((e,n)=>{const[s,i]=t(n);return e[s]=i,e}),{})}function di(e,t){return t.reduce(((t,n)=>(t[n]=e[n],t)),{})}function ci(e,t){return t.reduce(((t,n)=>(e[n]&&(t[n]=e[n]),t)),{})}function ui(e,t){const n=new Set(t.map(String));return di(e,Object.keys(e).filter((e=>!n.has(e))))}function li(e){return Object.keys(e).reduce(((t,n)=>{const s=n;return void 0!==e[s]&&(t[s]=e[s]),t}),{})}function fi(e){return e.filter(Boolean)}function hi(e,t){const n=[];for(let s=0;s<e.length;s+=t)n.push(e.slice(s,s+t));return n}function pi(e,t){let n=0;const s=new Array(t),i=e.length/t,o=e[0],a=e[e.length-1];for(let r=0;r<t;r++){const t=Math.floor(r*i),d=((e[t-1]??o)+(e[t]??o)+(e[t+1]??a))/3;s[r]=d,n<d&&(n=d)}return{data:s,peak:n}}var mi=n(48287).hp;function gi(e){return e.startsWith("-")?(t=e).length===Q&&t.startsWith("-1")?"channel":"chat":"user";var t}function Ii(e){const t=gi(e);return"user"===t?new fe.jI.PeerUser({userId:Hi(e,"user")}):"channel"===t?new fe.jI.PeerChannel({channelId:Hi(e,"channel")}):new fe.jI.PeerChat({chatId:Hi(e,"chat")})}function wi(e,t){const n=gi(e);return"user"===n?new fe.jI.InputPeerUser({userId:Hi(e,"user"),accessHash:vt()(t)}):"channel"===n?new fe.jI.InputPeerChannel({channelId:Hi(e,"channel"),accessHash:vt()(t)}):new fe.jI.InputPeerChat({chatId:Hi(e,"chat")})}function yi(e){const t=gi(e);let n;if("user"===t){if(n=qs.users[e]?.accessHash,!n)return}else if("channel"===t&&(n=qs.chats[e]?.accessHash,!n))return;return wi(e,String(n))}function vi(e,t){const n=gi(e);return"user"===n?new fe.jI.InputUser({userId:Hi(e,"user"),accessHash:vt()(t)}):"channel"===n?new fe.jI.InputChannel({channelId:Hi(e,"channel"),accessHash:vt()(t)}):Hi(e,"chat")}function bi(e,t){return new fe.jI.InputStickerSetID({id:vt()(e),accessHash:vt()(t)})}function Si(e){const t=qs.documents[e.id];if(t)return new fe.jI.InputDocument(di(t,["id","accessHash","fileReference"]))}function ji(e){const t=Si(e);if(t)return new fe.jI.InputMediaDocument({id:t})}function Ci(e,t=!1){return new fe.jI.InputMediaPoll({poll:new fe.jI.Poll({id:vt()(e.id),publicVoters:e.summary.isPublic,question:Vi(e.summary.question),answers:e.summary.answers.map((({text:e,option:t})=>new fe.jI.PollAnswer({text:Vi(e),option:_s(t)}))),quiz:e.summary.quiz,multipleChoice:e.summary.multipleChoice,closeDate:e.summary.closeDate,closePeriod:e.summary.closePeriod,closed:!!t||e.summary.closed}),correctAnswers:e.results.results?.filter((e=>e.isCorrect)).map((e=>_s(e.option))),solution:e.results.solution,solutionEntities:e.results.solutionEntities?.map(ki)})}function Pi(){return(0,ze.op)((0,ze.Gg)(8),!0,!0)}function _i(){const e=(0,ze.Gg)(8),t=mi.alloc(4);return t.writeUInt32LE(Math.floor(Date.now()/1e3),0),e.set(t,4),(0,ze.op)(e,!0,!0)}function Mi(){return(0,ze.op)((0,ze.Gg)(4),!0,!0).toJSNumber()}function Ti(e,t,n){return new fe.jI.Message({id:e,peerId:Ii(t),fromId:Ii(t),media:n.media})}function ki(e){const{type:t,offset:n,length:s}=e,i="userId"in e?qs.users[e.userId]:void 0;switch(t){case Qs.Bold:return new fe.jI.MessageEntityBold({offset:n,length:s});case Qs.Italic:return new fe.jI.MessageEntityItalic({offset:n,length:s});case Qs.Underline:return new fe.jI.MessageEntityUnderline({offset:n,length:s});case Qs.Strike:return new fe.jI.MessageEntityStrike({offset:n,length:s});case Qs.Code:return new fe.jI.MessageEntityCode({offset:n,length:s});case Qs.Pre:return new fe.jI.MessageEntityPre({offset:n,length:s,language:e.language||""});case Qs.Blockquote:return new fe.jI.MessageEntityBlockquote({offset:n,length:s,collapsed:!!e.canCollapse||void 0});case Qs.TextUrl:return new fe.jI.MessageEntityTextUrl({offset:n,length:s,url:e.url});case Qs.Url:return new fe.jI.MessageEntityUrl({offset:n,length:s});case Qs.Hashtag:return new fe.jI.MessageEntityHashtag({offset:n,length:s});case Qs.MentionName:return new fe.jI.InputMessageEntityMentionName({offset:n,length:s,userId:new fe.jI.InputUser({userId:vt()(i.id),accessHash:i.accessHash})});case Qs.Spoiler:return new fe.jI.MessageEntitySpoiler({offset:n,length:s});case Qs.CustomEmoji:return new fe.jI.MessageEntityCustomEmoji({offset:n,length:s,documentId:vt()(e.documentId)});default:return new fe.jI.MessageEntityUnknown({offset:n,length:s})}}function Ai(e){const t=qs.photos[e?.id];if(t)return new fe.jI.InputPhoto(di(t,["id","accessHash","fileReference"]))}function Ri({phone:e,firstName:t,lastName:n}){return new fe.jI.InputPhoneContact({clientId:vt()(1),phone:e,firstName:t,lastName:n})}function Ei(e,t=0){return new fe.jI.ChatBannedRights({...e,untilDate:t})}function Di(e){return new fe.jI.ChatAdminRights(e)}function Ui(e){const{shippingAddress:t}=e;return new fe.jI.PaymentRequestedInfo({...e,shippingAddress:t?new fe.jI.PostAddress(t):void 0})}function xi(e){switch(e){case"phoneNumber":return new fe.jI.InputPrivacyKeyPhoneNumber;case"addByPhone":return new fe.jI.InputPrivacyKeyAddedByPhone;case"lastSeen":return new fe.jI.InputPrivacyKeyStatusTimestamp;case"profilePhoto":return new fe.jI.InputPrivacyKeyProfilePhoto;case"forwards":return new fe.jI.InputPrivacyKeyForwards;case"chatInvite":return new fe.jI.InputPrivacyKeyChatInvite;case"phoneCall":return new fe.jI.InputPrivacyKeyPhoneCall;case"phoneP2P":return new fe.jI.InputPrivacyKeyPhoneP2P;case"voiceMessages":return new fe.jI.InputPrivacyKeyVoiceMessages;case"bio":return new fe.jI.InputPrivacyKeyAbout;case"birthday":return new fe.jI.InputPrivacyKeyBirthday;case"gifts":return new fe.jI.InputPrivacyKeyStarGiftsAutoSave}}function Ni(e){switch(e){case"spam":return new fe.jI.InputReportReasonSpam;case"violence":return new fe.jI.InputReportReasonViolence;case"childAbuse":return new fe.jI.InputReportReasonChildAbuse;case"pornography":return new fe.jI.InputReportReasonPornography;case"copyright":return new fe.jI.InputReportReasonCopyright;case"fake":return new fe.jI.InputReportReasonFake;case"geoIrrelevant":return new fe.jI.InputReportReasonGeoIrrelevant;case"illegalDrugs":return new fe.jI.InputReportReasonIllegalDrugs;case"personalDetails":return new fe.jI.InputReportReasonPersonalDetails;case"other":return new fe.jI.InputReportReasonOther}}function Bi(e){return new fe.jI.DataJSON({data:JSON.stringify(e)})}function Hi(e,t){return"user"===t?vt()(e):"channel"===t?vt()(e.slice(2)):vt()(e.slice(1))}function Gi(e){return new fe.jI.InputGroupCall({id:vt()(e.id),accessHash:vt()(e.accessHash)})}function Oi({id:e,accessHash:t}){return new fe.jI.InputPhoneCall({id:vt()(e),accessHash:vt()(t)})}function qi(e){if("stars"===e.type)return new fe.jI.InputStorePaymentStarsTopup({stars:vt()(e.stars),currency:e.currency,amount:vt()(e.amount)});if("starsgift"===e.type)return new fe.jI.InputStorePaymentStarsGift({userId:vi(e.user.id,e.user.accessHash),stars:vt()(e.stars),currency:e.currency,amount:vt()(e.amount)});if("giftcode"===e.type)return new fe.jI.InputStorePaymentPremiumGiftCode({users:e.users.map((e=>vi(e.id,e.accessHash))),boostPeer:e.boostChannel?wi(e.boostChannel.id,e.boostChannel.accessHash):void 0,currency:e.currency,amount:vt()(e.amount),message:e.message&&Vi(e.message)});const t=Pi();return"starsgiveaway"===e.type?new fe.jI.InputStorePaymentStarsGiveaway({boostPeer:wi(e.chat.id,e.chat.accessHash),additionalPeers:e.additionalChannels?.map((e=>wi(e.id,e.accessHash))),stars:vt()(e.stars),countriesIso2:e.countries,prizeDescription:e.prizeDescription,onlyNewSubscribers:e.isOnlyForNewSubscribers||void 0,winnersAreVisible:e.areWinnersVisible||void 0,untilDate:e.untilDate,currency:e.currency,amount:vt()(e.amount),users:e.users,randomId:t}):new fe.jI.InputStorePaymentPremiumGiveaway({boostPeer:wi(e.chat.id,e.chat.accessHash),additionalPeers:e.additionalChannels?.map((e=>wi(e.id,e.accessHash))),countriesIso2:e.countries,prizeDescription:e.prizeDescription,onlyNewSubscribers:e.isOnlyForNewSubscribers||void 0,winnersAreVisible:e.areWinnersVisible||void 0,untilDate:e.untilDate,currency:e.currency,amount:vt()(e.amount),randomId:t})}function Fi(e){switch(e.type){case"message":return new fe.jI.InputInvoiceMessage({peer:wi(e.chat.id,e.chat.accessHash),msgId:e.messageId});case"slug":return new fe.jI.InputInvoiceSlug({slug:e.slug});case"stargift":{const{peer:t,shouldHideName:n,giftId:s,message:i,shouldUpgrade:o}=e;return new fe.jI.InputInvoiceStarGift({peer:wi(t.id,t.accessHash),hideName:n||void 0,giftId:vt()(s),message:i&&Vi(i),includeUpgrade:o})}case"stars":{const t=qi(e.purpose);return new fe.jI.InputInvoiceStars({purpose:t})}case"starsgiveaway":{const t=qi(e.purpose);return new fe.jI.InputInvoiceStars({purpose:t})}case"chatInviteSubscription":return new fe.jI.InputInvoiceChatInviteSubscription({hash:e.hash});case"stargiftUpgrade":return new fe.jI.InputInvoiceStarGiftUpgrade({stargift:Ji(e.inputSavedGift),keepOriginalDetails:e.shouldKeepOriginalDetails});default:{const n=qi(e.purpose),s=(t=e.option,new fe.jI.PremiumGiftCodeOption({users:t.users,months:t.months,currency:t.currency,amount:vt()(t.amount)}));return new fe.jI.InputInvoicePremiumGiftCode({purpose:n,option:s})}}var t}function Li(e){switch(e?.type){case"emoji":return new fe.jI.ReactionEmoji({emoticon:e.emoticon});case"custom":return new fe.jI.ReactionCustomEmoji({documentId:vt()(e.documentId)});case"paid":return new fe.jI.ReactionPaid;default:return new fe.jI.ReactionEmpty}}function zi(e,t){return e===B?new fe.jI.EmojiStatusEmpty:new fe.jI.EmojiStatus({documentId:vt()(e),until:t})}function Vi(e){return new fe.jI.TextWithEntities({text:e.text,entities:e.entities?.map(ki)||[]})}function $i(e){return new fe.jI.InputBotAppID({id:vt()(e.id),accessHash:vt()(e.accessHash)})}function Wi(e){if("story"===e.type)return new fe.jI.InputReplyToStory({peer:yi(e.peerId),storyId:e.storyId});if("message"===e.type){const{replyToMsgId:t,replyToTopId:n,replyToPeerId:s,quoteText:i}=e;return new fe.jI.InputReplyToMessage({replyToMsgId:t,topMsgId:n,replyToPeerId:s?yi(s):void 0,quoteText:i?.text,quoteEntities:i?.entities?.map(ki)})}}function Ki(e){const t=[];if(e.allowedUsers?.length&&t.push(new fe.jI.InputPrivacyValueAllowUsers({users:e.allowedUsers.map((({id:e,accessHash:t})=>vi(e,t)))})),e.allowedChats?.length&&t.push(new fe.jI.InputPrivacyValueAllowChatParticipants({chats:e.allowedChats.map((({id:e,type:t})=>Hi(e,"chatTypeBasicGroup"===t?"chat":"channel")))})),e.blockedUsers?.length&&t.push(new fe.jI.InputPrivacyValueDisallowUsers({users:e.blockedUsers.map((({id:e,accessHash:t})=>vi(e,t)))})),e.blockedChats?.length&&t.push(new fe.jI.InputPrivacyValueDisallowChatParticipants({chats:e.blockedChats.map((({id:e,type:t})=>Hi(e,"chatTypeBasicGroup"===t?"chat":"channel")))})),e.shouldAllowPremium&&t.push(new fe.jI.InputPrivacyValueAllowPremium),"allow"===e.botsPrivacy&&t.push(new fe.jI.InputPrivacyValueAllowBots),"disallow"===e.botsPrivacy&&t.push(new fe.jI.InputPrivacyValueDisallowBots),!e.isUnspecified)switch(e.visibility){case"everybody":t.push(new fe.jI.InputPrivacyValueAllowAll);break;case"contacts":t.push(new fe.jI.InputPrivacyValueAllowContacts);break;case"nonContacts":t.push(new fe.jI.InputPrivacyValueDisallowContacts);break;case"nobody":t.push(new fe.jI.InputPrivacyValueDisallowAll)}return t}function Ji(e){return"user"===e.type?new fe.jI.InputSavedStarGiftUser({msgId:e.messageId}):new fe.jI.InputSavedStarGiftChat({peer:wi(e.chat.id,e.chat.accessHash),savedId:vt()(e.savedId)})}function Qi(e){e instanceof fe.jI.Message&&(e.media&&Yi(e.media,e),e.replyTo instanceof fe.jI.MessageReplyHeader&&e.replyTo.replyMedia&&Yi(e.replyTo.replyMedia,e)),e instanceof fe.jI.MessageService&&"photo"in e.action&&Zi(no(e.action.photo,e)),e instanceof fe.jI.SponsoredMessage&&e.photo&&Zi(e.photo)}function Yi(e,t){e instanceof fe.jI.MessageMediaDocument&&e.document&&eo(no(e.document,t)),e instanceof fe.jI.MessageMediaWebPage&&e.webpage instanceof fe.jI.WebPage&&(e.webpage.document&&eo(no(e.webpage.document,t)),e.webpage.photo&&Zi(no(e.webpage.photo,t))),e instanceof fe.jI.MessageMediaGame&&(e.game.document&&eo(no(e.game.document,t)),Zi(no(e.game.photo,t))),e instanceof fe.jI.MessageMediaPhoto&&e.photo&&Zi(no(e.photo,t)),e instanceof fe.jI.MessageMediaInvoice&&(e.photo&&io(no(e.photo,t)),e.extendedMedia instanceof fe.jI.MessageExtendedMedia&&Yi(e.extendedMedia.media,t)),e instanceof fe.jI.MessageMediaPaidMedia&&e.extendedMedia.forEach((e=>{e instanceof fe.jI.MessageExtendedMedia&&Yi(e.media,t)}))}function Xi(e,t){if(e instanceof fe.jI.StoryItem&&(e.media instanceof fe.jI.MessageMediaPhoto&&e.media.photo&&Zi(to(e.media.photo,t,e)),e.media instanceof fe.jI.MessageMediaDocument&&(e.media.document instanceof fe.jI.Document&&eo(to(e.media.document,t,e)),e.media.altDocuments)))for(const n of e.media.altDocuments)eo(to(n,t,e))}function Zi(e){e instanceof fe.jI.Photo&&(qs.photos[String(e.id)]=e)}function eo(e){e instanceof fe.jI.Document&&(qs.documents[String(e.id)]=e)}function to(e,t,n){if(!(e instanceof fe.jI.Document&&e instanceof fe.jI.Photo))return e;const s=e;return s.localRepairInfo={type:"story",peerId:t,id:n.id},s}function no(e,t){if(!t?.peerId)return e;if(!(e instanceof fe.jI.Document||e instanceof fe.jI.Photo||e instanceof fe.jI.WebDocument))return e;const n=e;return n.localRepairInfo={type:"message",peerId:ms(t.peerId),id:t.id},n}function so(e){const t=ps(e.id,"user"),n=qs.users[t];e.photo instanceof fe.jI.Photo&&Zi(e.photo),n&&!n.min&&e.min||(qs.users[t]=e)}function io(e){qs.webDocuments[e.url]=e}function oo(e){const{self:t,min:n,about:s,date:i,versioned:o,canSelfUnmute:a,justJoined:r,left:d,muted:c,mutedByYou:u,source:l,volume:f,volumeByAdmin:h,videoJoined:p,peer:m,video:g,presentation:I,raiseHandRating:w}=e;return{isSelf:t,isMin:n,canSelfUnmute:a,isLeft:d,isMuted:c,isMutedByMe:u,hasJustJoined:r,isVolumeByAdmin:h,isVersioned:o,isVideoJoined:p,about:s,source:l,raiseHandRating:w?.toString(),volume:f,date:new Date(i),isUser:fs(m),id:ms(m),video:g?ao(g):void 0,presentation:I?ao(I):void 0}}function ao(e){const{audioSource:t,endpoint:n,paused:s,sourceGroups:i}=e;return{audioSource:t,endpoint:n,isPaused:s,sourceGroups:i.map(ro)}}function ro(e){return{semantics:e.semantics,sources:e.sources}}function co(e){const{id:t,accessHash:n}=e;if(e instanceof fe.jI.GroupCallDiscarded)return{connectionState:"discarded",id:t.toString(),accessHash:n.toString(),participantsCount:0,version:0,participants:{}};const{version:s,participantsCount:i,streamDcId:o,scheduleDate:a,canChangeJoinMuted:r,joinMuted:d,canStartVideo:c,scheduleStartSubscribed:u}=e;return{connectionState:"disconnected",isLoaded:!0,id:t.toString(),accessHash:n.toString(),version:s,participantsCount:i,streamDcId:o,scheduleDate:a,canChangeJoinMuted:r,joinMuted:d,canStartVideo:c,scheduleStartSubscribed:u,participants:{}}}function uo(e){const{id:t}=e;let n={id:t.toString()};if(e instanceof fe.jI.PhoneCallAccepted||e instanceof fe.jI.PhoneCallWaiting||e instanceof fe.jI.PhoneCall||e instanceof fe.jI.PhoneCallRequested){const{accessHash:t,adminId:s,date:i,video:o,participantId:a,protocol:r}=e;n={...n,accessHash:t.toString(),adminId:s.toString(),participantId:a.toString(),date:i,isVideo:o,protocol:ho(r)}}if(e instanceof fe.jI.PhoneCall){const{p2pAllowed:t,gAOrB:s,keyFingerprint:i,connections:o,startDate:a}=e;n={...n,state:"active",gAOrB:Array.from(s),keyFingerprint:i.toString(),startDate:a,isP2pAllowed:Boolean(t),connections:o.map(fo).filter(Boolean)}}return e instanceof fe.jI.PhoneCallDiscarded&&(n={...n,state:"discarded",duration:e.duration,reason:lo(e.reason),needRating:e.needRating,needDebug:e.needDebug}),e instanceof fe.jI.PhoneCallWaiting&&(n={...n,state:"waiting",receiveDate:e.receiveDate}),e instanceof fe.jI.PhoneCallAccepted&&(n={...n,state:"accepted",gB:Array.from(e.gB)}),e instanceof fe.jI.PhoneCallRequested&&(n={...n,state:"requested",gAHash:Array.from(e.gAHash)}),n}function lo(e){return e instanceof fe.jI.PhoneCallDiscardReasonMissed?"missed":e instanceof fe.jI.PhoneCallDiscardReasonBusy?"busy":e instanceof fe.jI.PhoneCallDiscardReasonHangup?"hangup":"disconnect"}function fo(e){if(e instanceof fe.jI.PhoneConnectionWebrtc){const{username:t,password:n,turn:s,stun:i,ip:o,ipv6:a,port:r}=e;return{username:t,password:n,isTurn:s,isStun:i,ip:o,ipv6:a,port:r}}}function ho(e){const{libraryVersions:t,minLayer:n,maxLayer:s,udpP2p:i,udpReflector:o}=e;return{libraryVersions:t,minLayer:n,maxLayer:s,isUdpP2p:i,isUdpReflector:o}}function po(){return new fe.jI.PhoneCallProtocol({libraryVersions:["4.0.0"],minLayer:92,maxLayer:92,udpReflector:!0,udpP2p:!0})}const mo='<?xml version="1.0" encoding="utf-8"?><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 {{width}} {{height}}" xml:space="preserve"><path fill-opacity="0.1" d="{{path}}" /></svg>',go="AACAAAAHAAALMAAAQASTAVAAAZaacaaaahaaalmaaaqastava.az0123456789-,";function Io(e){let t="M";const n=e.length;for(let s=0;s<n;s++){const n=e[s];n>=192?t+=go[n-128-64]:(n>=128?t+=",":n>=64&&(t+="-"),t+=String(63&n))}return t+="z",t}const wo={w:100,h:100};function yo(e,t){if(!e||!e.length)return;const n=e.find((e=>e instanceof fe.jI.PhotoStrippedSize));if(!n)return;const s=e.filter((e=>e instanceof fe.jI.PhotoSize)),{w:i,h:o}=s.length?s[s.length-1]:wo,{bytes:a}=n;return{dataUri:Rs(t&&"image/jpeg"!==t?a:dn(a),void 0,t),width:i,height:o}}function vo(e,t){const{w:n,h:s}=t;var i,o,a;return{dataUri:`data:image/svg+xml;utf8,${i=e.bytes,o=n,a=s,mo.replace("{{path}}",Io(i)).replace("{{width}}",String(o)).replace("{{height}}",String(a))}`,width:n,height:s}}function bo(e,t){const n=e.sizes.filter((e=>e instanceof fe.jI.PhotoSize||e instanceof fe.jI.PhotoSizeProgressive)).map(Co);return{mediaType:"photo",id:String(e.id),thumbnail:yo(e.sizes),sizes:n,isSpoiler:t,date:e.date,...e.videoSizes&&{videoSizes:fi(e.videoSizes.map(jo)),isVideo:!0}}}function So(e){return e.filter((e=>e instanceof fe.jI.PhotoSize||e instanceof fe.jI.PhotoSizeProgressive)).map(Co)}function jo(e){if(!(e instanceof fe.jI.VideoSize))return;const{videoStartTs:t,size:n,h:s,w:i,type:o}=e;return{videoStartTs:t,size:n,height:s,width:i,type:o}}function Co(e){const{w:t,h:n,type:s}=e;return{width:t,height:n,type:s}}function Po(e){if(!(e.usernames||"username"in e&&e.username))return;const t=[];return"username"in e&&e.username&&t.push({username:e.username,isActive:!0,isEditable:!0}),e.usernames&&e.usernames.forEach((({username:e,active:n,editable:s})=>{t.push({username:e,...n&&{isActive:!0},...s&&{isEditable:!0}})})),t}function _o(e){let t,n,s,i,o,a,r,d="none";const c=qs.chats;return e.forEach((e=>{e instanceof fe.jI.PrivacyValueAllowAll?t||(t="everybody"):e instanceof fe.jI.PrivacyValueAllowContacts?t||(t="contacts"):e instanceof fe.jI.PrivacyValueAllowCloseFriends?t||(t="closeFriends"):e instanceof fe.jI.PrivacyValueDisallowContacts?t||(t="nonContacts"):e instanceof fe.jI.PrivacyValueDisallowAll?t||(t="nobody"):e instanceof fe.jI.PrivacyValueAllowUsers?s=e.users.map((e=>ps(e,"user"))):e instanceof fe.jI.PrivacyValueDisallowUsers?o=e.users.map((e=>ps(e,"user"))):e instanceof fe.jI.PrivacyValueAllowChatParticipants?i=e.chats.map((e=>{const t=ps(e,"chat"),n=ps(e,"channel");return c[t]?t:n})):e instanceof fe.jI.PrivacyValueDisallowChatParticipants?a=e.chats.map((e=>{const t=ps(e,"chat"),n=ps(e,"channel");return c[t]?t:n})):e instanceof fe.jI.PrivacyValueAllowPremium?r=!0:e instanceof fe.jI.PrivacyValueAllowBots?d="allow":e instanceof fe.jI.PrivacyValueDisallowBots&&(d="disallow")})),t||(t="nobody",n=!0),{visibility:t,isUnspecified:n,allowUserIds:s||[],allowChatIds:i||[],blockUserIds:o||[],blockChatIds:a||[],shouldAllowPremium:r,botsPrivacy:d}}function Mo(e){const{text:t,entities:n}=e;return{text:t,entities:n.map(To)}}function To(e){const{className:t,offset:n,length:s}=e;return e instanceof fe.jI.MessageEntityMentionName?{type:Qs.MentionName,offset:n,length:s,userId:ps(e.userId,"user")}:e instanceof fe.jI.MessageEntityTextUrl?{type:Qs.TextUrl,offset:n,length:s,url:e.url}:e instanceof fe.jI.MessageEntityPre?{type:Qs.Pre,offset:n,length:s,language:e.language}:e instanceof fe.jI.MessageEntityCustomEmoji?{type:Qs.CustomEmoji,offset:n,length:s,documentId:e.documentId.toString()}:e instanceof fe.jI.MessageEntityBlockquote?{type:Qs.Blockquote,canCollapse:e.collapsed,offset:n,length:s}:{type:t,offset:n,length:s}}function ko(e){if("photoId"in e)return e.photoId.toString()}function Ao(e){return{botId:ps(e.botId,"user"),iconId:e.icon.toString(),description:e.description}}function Ro(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}"undefined"==typeof File&&(self.File=class extends Blob{constructor(e,t,n){if(n){const{type:t,...s}=n;super(e,{type:t}),Ro(this,"name",void 0),Object.assign(this,s)}else super(e),Ro(this,"name",void 0);this.name=t}});const Eo=e=>`#${e.toString(16).padStart(6,"0")}`;function Do(e,t,n){if(e instanceof fe.jI.DocumentEmpty)return;const{mimeType:s,videoThumbs:i}=e,o=e.attributes.find((e=>e instanceof fe.jI.DocumentAttributeSticker)),a=e.attributes.find((e=>e instanceof fe.jI.DocumentAttributeCustomEmoji));if(!o&&!a)return;const r=s===O,d=s===q,c=Boolean(a),u=c&&a.textColor,l=e.attributes.find((e=>e instanceof fe.jI.DocumentAttributeImageSize)),f=e.attributes.find((e=>e instanceof fe.jI.DocumentAttributeVideo)),h=l||f,p=o||a,m=(y=p?.stickerset,y instanceof fe.jI.InputStickerSetID?{id:String(y.id),accessHash:String(y.accessHash)}:y instanceof fe.jI.InputStickerSetShortName?{shortName:y.shortName}:{isMissing:!0}),g=p?.alt,I=Boolean(a?.free??!0)&&!n,w=e.thumbs&&e.thumbs.find((e=>e instanceof fe.jI.PhotoCachedSize));var y;if(!(s!==q||self.isWebmSupported||w||e.thumbs&&e.thumbs.find((e=>e instanceof fe.jI.PhotoSize))))return;const v=e.thumbs&&e.thumbs.find((e=>e instanceof fe.jI.PhotoPathSize)),b=w?function(e){const{w:t,h:n,bytes:s}=e;return{dataUri:Rs(s,void 0,"image/webp"),width:t,height:n}}(w):v&&h?vo(v,h):void 0,S=e.thumbs&&So(e.thumbs),{w:j,h:C}=w||h||{},P=!t&&i&&fi(i?.filter((e=>e instanceof fe.jI.VideoSize))).some((({type:e})=>"f"===e));return{mediaType:"sticker",id:String(e.id),stickerSetInfo:m,emoji:g,isCustomEmoji:c,isLottie:r,isVideo:d,width:j,height:C,thumbnail:b,hasEffect:P,isFree:I,shouldUseTextColor:u,previewPhotoSizes:S}}function Uo(e){const{archived:t,installedDate:n,id:s,accessHash:i,title:o,thumbs:a,count:r,shortName:d,emojis:c,thumbDocumentId:u}=e,l=a?.some((e=>"s"===e.type)),f=a?.some((e=>"a"===e.type)),h=a?.some((e=>"v"===e.type)),p=u&&String(u),m=l||f||h||Boolean(p);return{isArchived:t,isEmoji:c,installedDate:n,id:String(s),accessHash:String(i),title:o,hasStaticThumb:l,hasAnimatedThumb:f,hasVideoThumb:h,hasThumbnail:m,thumbCustomEmojiId:p,count:r,shortName:d}}function xo(e){const t=Uo(e.set);if(e instanceof fe.jI.StickerSetNoCovered)return t;const n=Bo(e instanceof fe.jI.StickerSetCovered?[e.cover]:e instanceof fe.jI.StickerSetMultiCovered?e.covers:e.documents);return e instanceof fe.jI.StickerSetFullCovered?{...t,stickers:n,packs:No(e.packs)}:{...t,covers:n}}function No(e){return e.reduce(((e,{emoticon:t,documents:n})=>(e[t]=n.map((e=>{const t=qs.documents[String(e)];if(t)return Do(t)})).filter(Boolean),e)),{})}function Bo(e){return e.map((e=>{if(e instanceof fe.jI.Document){const t=Do(e);if(t)return qs.documents[String(e.id)]=e,t}})).filter(Boolean)}function Ho(e){if(e instanceof fe.jI.StarGiftUnique){const{id:t,num:n,ownerId:s,ownerName:i,title:o,attributes:a,availabilityIssued:r,availabilityTotal:d,slug:c,ownerAddress:u}=e;return{type:"starGiftUnique",id:t.toString(),number:n,ownerId:s&&ms(s),ownerName:i,ownerAddress:u,attributes:a.map(Go).filter(Boolean),title:o,totalCount:d,issuedCount:r,slug:c}}const{id:t,limited:n,stars:s,availabilityRemains:i,availabilityTotal:o,convertStars:a,firstSaleDate:r,lastSaleDate:d,soldOut:c,birthday:u,upgradeStars:l}=e;eo(e.sticker);const f=Do(e.sticker);return{type:"starGift",id:t.toString(),isLimited:n,sticker:f,stars:s.toJSNumber(),availabilityRemains:i,availabilityTotal:o,starsToConvert:a.toJSNumber(),firstSaleDate:r,lastSaleDate:d,isSoldOut:c,isBirthday:u,upgradeStars:l?.toJSNumber()}}function Go(e){if(e instanceof fe.jI.StarGiftAttributeModel){const t=Do(e.document);if(!t)return;return eo(e.document),{type:"model",name:e.name,rarityPercent:e.rarityPermille/10,sticker:t}}if(e instanceof fe.jI.StarGiftAttributePattern){const t=Do(e.document);if(!t)return;return eo(e.document),{type:"pattern",name:e.name,rarityPercent:e.rarityPermille/10,sticker:t}}if(e instanceof fe.jI.StarGiftAttributeBackdrop){const{name:t,rarityPermille:n,centerColor:s,edgeColor:i,patternColor:o,textColor:a}=e;return{type:"backdrop",name:t,rarityPercent:n/10,centerColor:Eo(s),edgeColor:Eo(i),patternColor:Eo(o),textColor:Eo(a)}}if(e instanceof fe.jI.StarGiftAttributeOriginalDetails){const{date:t,recipientId:n,message:s,senderId:i}=e;return{type:"originalDetails",date:t,recipientId:n&&ms(n),message:s&&Mo(s),senderId:i&&ms(i)}}}const Oo=30;function qo(e){let t={};if(e.media){const n="peerId"in e?e:void 0;t={...Lo(e.media,n)}}const n=e.media instanceof fe.jI.MessageMediaUnsupported;return!e.message||n||t.sticker||t.pollId||t.contact||t.video?.isRound||(t={...t,text:Fo(e.message,e.entities)}),t}function Fo(e,t){return{text:e,...t&&{entities:t.map(To)}}}function Lo(e,t){Yi(e,t);const n="ttlSeconds"in e?e.ttlSeconds:void 0,s=function(e){return e instanceof fe.jI.MessageMediaDocument&&(!e.document&&e.voice)}(e);if(s)return{isExpiredVoice:s};const i=function(e){return e instanceof fe.jI.MessageMediaDocument&&(!e.document&&e.round)}(e);if(i)return{isExpiredRoundVideo:i};const o=function(e){if(!(e instanceof fe.jI.MessageMediaDocument&&e.document&&e.document instanceof fe.jI.Document))return;const t=e.document.attributes.find((e=>e instanceof fe.jI.DocumentAttributeAudio));if(!t||!t.voice)return;const{duration:n,waveform:s}=t;return{mediaType:"voice",id:String(e.document.id),size:e.document.size.toJSNumber(),duration:n,waveform:s?Array.from(s):void 0}}(e);if(o)return{voice:o,ttlSeconds:n};if("round"in e&&e.round){const t=Vo(e);if(t)return{video:t,ttlSeconds:n}}if(void 0!==n)return;if(e instanceof fe.jI.MessageMediaInvoice&&e.extendedMedia instanceof fe.jI.MessageExtendedMedia)return Lo(e.extendedMedia.media,t);const a=function(e){if(e instanceof fe.jI.MessageMediaDocument&&e.document&&e.document instanceof fe.jI.Document)return Do(e.document,e.nopremium)}(e);if(a)return{sticker:a};const r=function(e){if(e instanceof fe.jI.MessageMediaPhoto&&e.photo&&e.photo instanceof fe.jI.Photo)return bo(e.photo,e.spoiler)}(e);if(r)return{photo:r};const d=Vo(e),c=function(e){if(!(e instanceof fe.jI.MessageMediaDocument&&e.altDocuments))return;const t=e.altDocuments.filter((e=>e instanceof fe.jI.Document&&e.mimeType.startsWith("video"))).map((t=>zo(t,e.spoiler))).filter(Boolean);return t.length?t:void 0}(e);if(d)return{video:d,altVideos:c};const u=function(e){if(!(e instanceof fe.jI.MessageMediaDocument&&e.document&&e.document instanceof fe.jI.Document))return;const t=e.document.attributes.find((e=>e instanceof fe.jI.DocumentAttributeAudio));if(!t||t.voice)return;const n=e.document.thumbs&&e.document.thumbs.filter((e=>e instanceof fe.jI.PhotoSize)).map((e=>Co(e)));return{mediaType:"audio",id:String(e.document.id),fileName:Xo(e.document,"audio"),thumbnailSizes:n,size:e.document.size.toJSNumber(),...di(e.document,["mimeType"]),...di(t,["duration","performer","title"])}}(e);if(u)return{audio:u};const l=function(e){if(e instanceof fe.jI.MessageMediaDocument&&e.document)return $o(e.document)}(e);if(l)return{document:l};const f=function(e){if(!(e instanceof fe.jI.MessageMediaContact))return;const{firstName:t,lastName:n,phoneNumber:s,userId:i}=e;return{mediaType:"contact",firstName:t,lastName:n,phoneNumber:s,userId:ps(i,"user")}}(e);if(f)return{contact:f};const h=function(e){if(e instanceof fe.jI.MessageMediaPoll)return e.poll.id.toString()}(e);if(h)return{pollId:h};const p=Yo(e);if(p)return{webPage:p};const m=function(e){if(e instanceof fe.jI.MessageMediaInvoice)return function(e){const{description:t,title:n,photo:s,test:i,totalAmount:o,currency:a,receiptMsgId:r,extendedMedia:d}=e,c=d instanceof fe.jI.MessageExtendedMediaPreview?Zo(d):void 0;return{mediaType:"invoice",title:n,description:t,photo:ea(s),receiptMessageId:r,amount:o.toJSNumber(),currency:a,isTest:i,extendedMedia:c}}(e)}(e);if(m)return{invoice:m};const g=function(e){return e instanceof fe.jI.MessageMediaGeo?function(e){const t=Ko(e.geo);return t&&{mediaType:"geo",geo:t}}(e):e instanceof fe.jI.MessageMediaVenue?function(e){const{geo:t,title:n,provider:s,address:i,venueId:o,venueType:a}=e,r=Ko(t);return r&&{mediaType:"venue",geo:r,title:n,provider:s,address:i,venueId:o,venueType:a}}(e):e instanceof fe.jI.MessageMediaGeoLive?function(e){const{geo:t,period:n,heading:s}=e,i=Ko(t);return i&&{mediaType:"geoLive",geo:i,period:n,heading:s}}(e):void 0}(e);if(g)return{location:g};const I=function(e){if(e instanceof fe.jI.MessageMediaGame)return function(e){const{id:t,accessHash:n,shortName:s,title:i,description:o,photo:a,document:r}=e.game,d=a instanceof fe.jI.Photo?bo(a):void 0,c=r instanceof fe.jI.Document?$o(r):void 0;return{mediaType:"game",id:t.toString(),accessHash:n.toString(),shortName:s,title:i,description:o,photo:d,document:c}}(e)}(e);if(I)return{game:I};const w=function(e){if(!(e instanceof fe.jI.MessageMediaStory))return;const t=ms(e.peer);return{mediaType:"storyData",id:e.id,peerId:t,...e.viaMention&&{isMention:!0}}}(e);if(w)return{storyData:w};const y=function(e){if(e instanceof fe.jI.MessageMediaGiveaway)return function(e){const{channels:t,months:n,stars:s,quantity:i,untilDate:o,countriesIso2:a,onlyNewSubscribers:r,prizeDescription:d}=e,c=t.map((e=>ps(e,"channel")));return{mediaType:"giveaway",channelIds:c,months:n,stars:s?.toJSNumber(),quantity:i,untilDate:o,countries:a,isOnlyForNewSubscribers:r,prizeDescription:d}}(e)}(e);if(y)return{giveaway:y};const v=function(e){if(e instanceof fe.jI.MessageMediaGiveawayResults)return function(e){const{months:t,untilDate:n,onlyNewSubscribers:s,launchMsgId:i,unclaimedCount:o,winners:a,winnersCount:r,additionalPeersCount:d,prizeDescription:c,refunded:u,channelId:l}=e,f=a.map((e=>ps(e,"user")));return{mediaType:"giveawayResults",months:t,untilDate:n,isOnlyForNewSubscribers:s,launchMessageId:i,channelId:ps(l,"channel"),unclaimedCount:o,additionalPeersCount:d,isRefunded:u,prizeDescription:c,winnerIds:f,winnersCount:r}}(e)}(e);if(v)return{giveawayResults:v};const b=function(e){if(!(e instanceof fe.jI.MessageMediaPaidMedia))return;const{starsAmount:t,extendedMedia:n}=e,s=n[0]instanceof fe.jI.MessageExtendedMedia;return s?{mediaType:"paidMedia",starsAmount:t.toJSNumber(),isBought:s,extendedMedia:ta(n)}:{mediaType:"paidMedia",starsAmount:t.toJSNumber(),extendedMedia:n.filter((e=>e instanceof fe.jI.MessageExtendedMediaPreview)).map((e=>Zo(e)))}}(e);return b?{paidMedia:b}:void 0}function zo(e,t){if(e instanceof fe.jI.DocumentEmpty)return;const{id:n,mimeType:s,thumbs:i,size:o,videoThumbs:a,attributes:r}=e;if(s===H&&!self.isWebmSupported)return;const d=r.find((e=>e instanceof fe.jI.DocumentAttributeVideo));if(!d)return;const c=r.find((e=>e instanceof fe.jI.DocumentAttributeAnimated)),u=a?.some((e=>e instanceof fe.jI.VideoSize&&"v"===e.type)),l=i&&So(i),{duration:f,w:h,h:p,supportsStreaming:m=!1,roundMessage:g=!1,nosound:I}=d,w=g?function(e){const t=Math.min(Math.round(e),Oo);return Array.from({length:t},(()=>Math.floor(256*Math.random())))}(f):void 0;return{mediaType:"video",id:String(n),mimeType:s,duration:f,fileName:Xo(e,"video"),width:h,height:p,supportsStreaming:m,isRound:g,isGif:Boolean(c),thumbnail:yo(i),size:o.toJSNumber(),isSpoiler:t,hasVideoPreview:u,previewPhotoSizes:l,waveform:w,...I&&{noSound:!0}}}function Vo(e){if(e instanceof fe.jI.MessageMediaDocument&&e.document instanceof fe.jI.Document&&e.document.mimeType.startsWith("video"))return zo(e.document,e.spoiler)}function $o(e){if(!(e instanceof fe.jI.Document))return;const{id:t,size:n,mimeType:s,date:i,thumbs:o,attributes:a}=e,r=o&&o.find((e=>e instanceof fe.jI.PhotoSize));let d=o&&yo(o);if(!d&&o&&r){const e=o.find((e=>e instanceof fe.jI.PhotoPathSize));e&&(d=vo(e,r))}const c=o&&So(o);let u,l;if(r)if(l={width:r.w,height:r.h},F.has(s)){u="photo";const e=a.find((e=>e instanceof fe.jI.DocumentAttributeImageSize));if(e){const{w:t,h:n}=e;l={width:t,height:n}}}else if(L.has(s)){u="video";const e=a.find((e=>e instanceof fe.jI.DocumentAttributeVideo));if(e){const{w:t,h:n}=e;l={width:t,height:n}}}return{mediaType:"document",id:String(t),size:n.toJSNumber(),mimeType:s,timestamp:i,fileName:Xo(e),thumbnail:d,innerMediaType:u,mediaSize:l,previewPhotoSizes:c}}function Wo(e){if(e instanceof fe.jI.MessageMediaPoll)return Jo(e.poll,e.results)}function Ko(e){if(e instanceof fe.jI.GeoPointEmpty)return;const{long:t,lat:n,accuracyRadius:s,accessHash:i}=e;return{long:t,lat:n,accessHash:i.toString(),accuracyRadius:s}}function Jo(e,t){const{id:n,answers:s}=e,i=s.map((e=>({text:Mo(e.text),option:Ps(e.option)})));return{mediaType:"poll",id:String(n),summary:{isPublic:e.publicVoters,question:Mo(e.question),...di(e,["closed","multipleChoice","quiz","closePeriod","closeDate"]),answers:i},results:Qo(t)}}function Qo(e){const{results:t,totalVoters:n,recentVoters:s,solution:i,solutionEntities:o,min:a}=e,r=t?.map((({option:e,chosen:t,correct:n,voters:s})=>({isChosen:t,isCorrect:n,option:Ps(e),votersCount:s})));return{isMin:a,totalVoters:n,recentVoterIds:s?.map((e=>ms(e))),results:r,solution:i,...o&&{solutionEntities:o.map(To)}}}function Yo(e){if(!(e instanceof fe.jI.MessageMediaWebPage&&e.webpage instanceof fe.jI.WebPage))return;const{id:t,photo:n,document:s,attributes:i}=e.webpage;let o,a,r,d,c;s instanceof fe.jI.Document&&s.mimeType.startsWith("video/")&&(o=zo(s)),s instanceof fe.jI.Document&&s.mimeType.startsWith("audio/")&&(a=function(e){if(e instanceof fe.jI.DocumentEmpty)return;const{id:t,mimeType:n,size:s,attributes:i}=e,o=i.find((e=>e instanceof fe.jI.DocumentAttributeAudio));if(!o)return;const{duration:a,title:r,performer:d}=o;return{mediaType:"audio",id:String(t),mimeType:n,duration:a,fileName:Xo(e,"audio"),title:r,performer:d,size:s.toJSNumber()}}(s));const u=i?.find((e=>e instanceof fe.jI.WebPageAttributeStory)),l=i?.find((e=>e instanceof fe.jI.WebPageAttributeUniqueStarGift));if(u){const e=ms(u.peer);r={id:u.id,peerId:e},u.story instanceof fe.jI.StoryItem&&Xi(u.story,e)}if(l){const e=Ho(l.gift);d="starGiftUnique"===e.type?e:void 0}const f=i?.find((e=>e instanceof fe.jI.WebPageAttributeStickerSet));f&&(c={documents:Bo(f.stickers),isEmoji:f.emojis,isWithTextColor:f.textColor});const h=e.forceSmallMedia?"small":e.forceLargeMedia?"large":void 0;return{mediaType:"webpage",id:Number(t),...di(e.webpage,["url","displayUrl","type","siteName","title","description","duration","hasLargeMedia"]),photo:n instanceof fe.jI.Photo?bo(n):void 0,document:o||a||!s?void 0:$o(s),video:o,audio:a,story:r,gift:d,stickers:c,mediaSize:h}}function Xo(e,t="file"){const{mimeType:n,attributes:s}=e,i=s.find((e=>e instanceof fe.jI.DocumentAttributeFilename));if(i)return i.fileName;const o=n.split("/")[1];return`${t}${String(e.id)}.${o}`}function Zo(e){const{w:t,h:n,thumb:s,videoDuration:i}=e;return{mediaType:"extendedMediaPreview",width:t,height:n,duration:i,thumbnail:s?yo([s]):void 0}}function ea(e){if(!e)return;const{url:t,size:n,mimeType:s}=e,i=e instanceof fe.jI.WebDocument?e.accessHash.toString():void 0,o=e.attributes.find((e=>e instanceof fe.jI.DocumentAttributeImageSize));return{mediaType:"webDocument",url:t,accessHash:i,size:n,mimeType:s,dimensions:o&&{width:o.w,height:o.h}}}function ta(e){const t=e.filter((e=>e instanceof fe.jI.MessageExtendedMedia)).map((e=>Lo(e.media))).filter(Boolean);if(t.length)return t}function na(e){const{recentReactions:t,results:n,canSeeList:s,reactionsAsTags:i,topReactors:o}=e;return{areTags:i,canSeeList:s,results:n.map(ia).filter(Boolean).sort(sa),recentReactions:t?.map(aa).filter(Boolean),topReactors:o?.map(oa).filter(Boolean)}}function sa(e,t){if("paid"===e.reaction.type)return-1;if("paid"===t.reaction.type)return 1;return t.count-e.count||(void 0!==e.chosenOrder&&void 0!==t.chosenOrder?e.chosenOrder-t.chosenOrder:void 0!==e.chosenOrder?1:void 0!==t.chosenOrder?-1:0)}function ia(e){const{chosenOrder:t,count:n,reaction:s}=e,i=ra(s,!0);if(i)return{chosenOrder:t,count:n,reaction:i}}function oa(e){const{count:t,my:n,top:s,anonymous:i,peerId:o}=e;return{peerId:o&&ms(o),count:t,isMe:n,isTop:s,isAnonymous:i}}function aa(e){const{peerId:t,reaction:n,big:s,unread:i,date:o,my:a}=e,r=ra(n);if(r)return{peerId:ms(t),reaction:r,addedDate:o,isUnread:i,isBig:s,isOwn:a}}function ra(e,t){return e instanceof fe.jI.ReactionEmoji?{type:"emoji",emoticon:e.emoticon}:e instanceof fe.jI.ReactionCustomEmoji?{type:"custom",documentId:e.documentId.toString()}:t&&e instanceof fe.jI.ReactionPaid?{type:"paid"}:void 0}function da(e){const{reaction:t,title:n,count:s}=e,i=ra(t);if(i)return{reaction:i,title:n,count:s}}function ca(e){const{selectAnimation:t,staticIcon:n,reaction:s,title:i,appearAnimation:o,inactive:a,aroundAnimation:r,centerIcon:d,effectAnimation:c,activateAnimation:u,premium:l}=e;return{selectAnimation:$o(t),appearAnimation:$o(o),activateAnimation:$o(u),effectAnimation:$o(c),staticIcon:$o(n),aroundAnimation:r?$o(r):void 0,centerIcon:d?$o(d):void 0,reaction:{type:"emoji",emoticon:s},title:i,isInactive:a,isPremium:l}}function ua(e){const{id:t,emoticon:n,premiumRequired:s,staticIconId:i,effectStickerId:o,effectAnimationId:a}=e;return{id:t.toString(),emoticon:n,isPremium:s,staticIconId:i?.toString(),effectStickerId:o.toString(),effectAnimationId:a?.toString()}}const la=1e6,fa="temp",ha=63,pa=10;let ma,ga=0;function Ia(e=0){return e+ ++ga/la}function wa(e){const t=js(e);if(t&&(e instanceof fe.jI.Message||e instanceof fe.jI.MessageService))return ya(t,e)}function ya(e,t){const n=t.fromId?ms(t.fromId):void 0,s=t.peerId?ms(t.peerId):void 0,i=!n&&e===ma,o=t.fwdFrom&&ba(t.fwdFrom,i),a=Boolean(!o||o.fromId===ma||o.isSavedOutgoing),r=i?a:Boolean(t.out&&!t.post),d=qo(t),c=t.action&&function(e,t,n,s,i,o){if(e instanceof fe.jI.MessageActionEmpty)return;let a,r,d,c,u,l,f,h;const p=[];let m,g,I,w,y,v,b,S,j,C,P,_,M="other",T="users"in e?e.users&&e.users.map((e=>ps(e,"user"))):"userId"in e&&[ps(e.userId,"user")]||[];if(e instanceof fe.jI.MessageActionChatCreate)h="Notification.CreatedChatWithTitle",p.push("%action_origin%",e.title),M="chatCreate";else if(e instanceof fe.jI.MessageActionChatEditTitle)i?(h="Channel.MessageTitleUpdated",p.push(e.title)):(h="Notification.ChangedGroupName",p.push("%action_origin%",e.title));else if(e instanceof fe.jI.MessageActionChatEditPhoto)i?h="Channel.MessagePhotoUpdated":(h="Notification.ChangedGroupPhoto",p.push("%action_origin%")),M="updateProfilePhoto";else if(e instanceof fe.jI.MessageActionChatDeletePhoto)h=i?"Channel.MessagePhotoRemoved":"Group.MessagePhotoRemoved";else if(e instanceof fe.jI.MessageActionChatAddUser)!n||T.includes(n)?(h="Notification.JoinedChat",p.push("%target_user%")):(h="Notification.Invited",p.push("%action_origin%","%target_user%"));else if(e instanceof fe.jI.MessageActionChatDeleteUser)!n||T.includes(n)?(h="Notification.LeftChat",p.push("%target_user%")):(h="Notification.Kicked",p.push("%action_origin%","%target_user%"));else if(e instanceof fe.jI.MessageActionChatJoinedByLink)h="Notification.JoinedGroupByLink",p.push("%action_origin%");else if(e instanceof fe.jI.MessageActionChannelCreate)h="Notification.CreatedChannel";else if(e instanceof fe.jI.MessageActionChatMigrateTo)_=ms(e),h="Migrated to %target_chat%",p.push("%target_chat%");else if(e instanceof fe.jI.MessageActionChannelMigrateFrom)_=ms(e),h="Migrated from %target_chat%",p.push("%target_chat%");else if(e instanceof fe.jI.MessageActionPinMessage)h="Chat.Service.Group.UpdatedPinnedMessage1",p.push("%action_origin%","%message%");else if(e instanceof fe.jI.MessageActionHistoryClear)h="HistoryCleared",M="historyClear";else if(e instanceof fe.jI.MessageActionPhoneCall){const t=Boolean(e.duration);if(h=[t?"ChatList.Service":"Chat",e.video?"VideoCall":"Call",o?t?"outgoing":"Outgoing":t?"incoming":"Incoming"].join("."),t){const t=Math.max(Math.round(e.duration/60),1);p.push(`${t} min${t>1?"s":""}`)}a={isOutgoing:o,isVideo:e.video,duration:e.duration,reason:lo(e.reason)}}else if(e instanceof fe.jI.MessageActionInviteToGroupCall)h="Notification.VoiceChatInvitation",r={id:e.call.id.toString(),accessHash:e.call.accessHash.toString()},p.push("%action_origin%","%target_user%");else if(e instanceof fe.jI.MessageActionContactSignUp)h="Notification.Joined",p.push("%action_origin%"),M="contactSignUp";else if(e instanceof fe.jI.MessageActionPaymentSent)d=Number(e.totalAmount),l=e.currency,h="PaymentSuccessfullyPaid",M="receipt",s&&T.push(s),p.push("%payment_amount%","%target_user%","%product%");else if(e instanceof fe.jI.MessageActionGroupCall)if(e.duration){const t=Math.max(Math.round(e.duration/60),1);h="Notification.VoiceChatEnded",p.push(`${t} min${t>1?"s":""}`)}else h="Notification.VoiceChatStartedChannel",r={id:e.call.id.toString(),accessHash:e.call.accessHash.toString()};else if(e instanceof fe.jI.MessageActionBotAllowed)e.domain?(h="ActionBotAllowed",p.push(e.domain)):h=e.fromRequest?"lng_action_webapp_bot_allowed":"ActionAttachMenuBotAllowed";else if(e instanceof fe.jI.MessageActionCustomAction)h=e.message;else if(e instanceof fe.jI.MessageActionChatJoinedByRequest)h="ChatService.UserJoinedGroupByRequest",p.push("%action_origin%");else if(e instanceof fe.jI.MessageActionGameScore)h=n===ma?"ActionYouScoredInGame":"ActionUserScoredInGame",p.push("%score%"),g=e.score;else if(e instanceof fe.jI.MessageActionWebViewDataSent)h="Notification.WebAppSentData",p.push(e.text);else if(e instanceof fe.jI.MessageActionGiftPremium)M="giftPremium",h=o?"ActionGiftOutbound":"ActionGiftInbound",o?p.push("%gift_payment_amount%"):p.push("%action_origin%","%gift_payment_amount%"),e.message&&(P=Mo(e.message)),s&&T.push(s),l=e.currency,e.cryptoCurrency&&(f={currency:e.cryptoCurrency,amount:e.cryptoAmount.toJSNumber()}),d=e.amount.toJSNumber(),I=e.months;else if(e instanceof fe.jI.MessageActionTopicCreate)h="TopicWasCreatedAction",M="topicCreate",p.push(e.title);else if(e instanceof fe.jI.MessageActionTopicEdit)void 0!==e.closed?(h=e.closed?"TopicWasClosedAction":"TopicWasReopenedAction",p.push("%action_origin%","%action_topic%")):void 0!==e.hidden?h=e.hidden?"TopicHidden2":"TopicShown":e.title?(h="TopicRenamedTo",p.push("%action_origin%",e.title)):e.iconEmojiId?(h="TopicWasIconChangedToAction",p.push("%action_origin%","%action_topic_icon%"),w=e.iconEmojiId.toString()):h="ChatList.UnsupportedMessage",y=!0;else if(e instanceof fe.jI.MessageActionSuggestProfilePhoto){const t=e.photo instanceof fe.jI.Photo&&e.photo.videoSizes?.length;h=n===ma?t?"ActionSuggestVideoFromYouDescription":"ActionSuggestPhotoFromYouDescription":t?"ActionSuggestVideoToYouDescription":"ActionSuggestPhotoToYouDescription",M="suggestProfilePhoto",p.push("%target_user%"),s&&T.push(s)}else e instanceof fe.jI.MessageActionGiveawayLaunch?(h="BoostingGiveawayJustStarted",p.push("%action_origin%")):e instanceof fe.jI.MessageActionGiftCode?(M="giftCode",h=o?"ActionGiftOutbound":"BoostingReceivedGiftNoName",v=e.slug,I=e.months,d=e.amount?.toJSNumber(),b=Boolean(e.viaGiveaway),S=Boolean(e.unclaimed),o&&p.push("%gift_payment_amount%"),e.message&&(P=Mo(e.message)),l=e.currency,e.cryptoCurrency&&(f={currency:e.cryptoCurrency,amount:e.cryptoAmount.toJSNumber()}),e.boostPeer&&(_=ms(e.boostPeer)),s&&T.push(s)):e instanceof fe.jI.MessageActionGiveawayResults?e.winnersCount?e.unclaimedCount?h="lng_action_giveaway_results_some":(h="BoostingGiveawayServiceWinnersSelected",p.push("%amount%"),d=e.winnersCount,j=e.winnersCount):h="lng_action_giveaway_results_none":e instanceof fe.jI.MessageActionPrizeStars?(M="prizeStars",S=Boolean(e.unclaimed),e.boostPeer&&(_=ms(e.boostPeer)),h="Notification.StarsPrize",c=e.stars.toJSNumber(),C=e.transactionId):e instanceof fe.jI.MessageActionBoostApply?(M="chatBoost",1===e.boosts?(h=n===ma?"BoostingBoostsGroupByYouServiceMsg":"BoostingBoostsGroupByUserServiceMsg",p.push("%action_origin%")):(h=n===ma?"BoostingBoostsGroupByYouServiceMsgCount":"BoostingBoostsGroupByUserServiceMsgCount",p.push(e.boosts.toString()),n!==ma&&p.unshift("%action_origin%"),j=e.boosts)):e instanceof fe.jI.MessageActionPaymentRefunded?(h="ActionRefunded",d=Number(e.totalAmount),l=e.currency):e instanceof fe.jI.MessageActionRequestedPeer?(h="ActionRequestedPeer",e.peers&&(T=e.peers?.map((e=>ms(e)))),s&&p.unshift("%action_origin%")):e instanceof fe.jI.MessageActionGiftStars?(M="giftStars",h=o?"ActionGiftOutbound":s?"ActionGiftInbound":"BoostingReceivedGiftNoName",o?p.push("%gift_payment_amount%"):p.push("%action_origin%","%gift_payment_amount%"),s&&(T.push(s),_=s),e.cryptoCurrency&&(f={currency:e.cryptoCurrency,amount:e.cryptoAmount.toJSNumber()}),l=e.currency,d=e.amount.toJSNumber(),c=e.stars.toJSNumber(),C=e.transactionId):e instanceof fe.jI.MessageActionStarGift&&e.gift instanceof fe.jI.StarGift?(M="starGift",u=function(e,t){const{nameHidden:n,saved:s,converted:i,gift:o,message:a,convertStars:r,canUpgrade:d,upgraded:c,upgradeMsgId:u,upgradeStars:l,peer:f,savedId:h,fromId:p}=e,m=h&&f?{type:"chat",chatId:ms(f),savedId:h.toString()}:{type:"user",messageId:t};return{type:"starGift",isNameHidden:Boolean(n),isSaved:Boolean(s),isConverted:i,fromId:p&&ms(p),gift:Ho(o),message:a&&Mo(a),starsToConvert:r?.toJSNumber(),canUpgrade:d,isUpgraded:c,upgradeMsgId:u,alreadyPaidUpgradeStars:l?.toJSNumber(),peerId:f&&ms(f),savedId:h?.toString(),inputSavedGift:m}}(e,t),o?(h="ActionGiftOutbound",p.push("%gift_payment_amount%")):(h="ActionGiftInbound",p.push("%action_origin%","%gift_payment_amount%")),s&&(T.push(s),_=s),d=e.gift.stars.toJSNumber(),l=R):e instanceof fe.jI.MessageActionStarGiftUnique&&e.gift instanceof fe.jI.StarGiftUnique?(M="starGiftUnique",o?h=e.upgrade?"Notification.StarsGift.UpgradeYou":"ActionUniqueGiftTransferOutbound":(h=e.upgrade?"Notification.StarsGift.Upgrade":"ActionUniqueGiftTransferInbound",p.push("%action_origin_chat%")),u=function(e,t){const{gift:n,canExportAt:s,refunded:i,saved:o,transferStars:a,transferred:r,upgrade:d,fromId:c,peer:u,savedId:l}=e,f=l&&u?{type:"chat",chatId:ms(u),savedId:l.toString()}:{type:"user",messageId:t};return{type:"starGiftUnique",gift:Ho(n),canExportAt:s,isRefunded:i,isSaved:o,transferStars:a?.toJSNumber(),isTransferred:r,isUpgrade:d,fromId:c&&ms(c),peerId:u&&ms(u),savedId:l?.toString(),inputSavedGift:f}}(e,t),e.peer?_=ms(e.peer):s&&(T.push(s),_=s)):h="ChatList.UnsupportedMessage";return"photo"in e&&e.photo instanceof fe.jI.Photo&&(Zi(e.photo),m=bo(e.photo)),{mediaType:"action",text:h,type:M,targetUserIds:T,targetChatId:_,photo:m,amount:d,stars:c,starGift:u,currency:l,giftCryptoInfo:f,isGiveaway:b,slug:v,translationValues:p,call:r,phoneCall:a,score:g,months:I,topicEmojiIconId:w,isTopicAction:y,isUnclaimed:S,pluralValue:j,transactionId:C,message:P}}(t.action,t.id,n,s,Boolean(t.post),r);c&&(d.action=c);const u=t.date>An()+pa,l=t.media instanceof fe.jI.MessageMediaInvoice&&Boolean(t.media.extendedMedia),f=Boolean(t.editDate)&&!t.editHide,{inlineButtons:h,keyboardButtons:p,keyboardPlaceholder:m,isKeyboardSingleUse:g,isKeyboardSelective:I}=function(e,t){const{replyMarkup:n,media:s}=e;if(!(n instanceof fe.jI.ReplyKeyboardMarkup||n instanceof fe.jI.ReplyInlineMarkup))return;const i=n.rows.map((({buttons:e})=>e.map((e=>{const{text:n}=e;if(e instanceof fe.jI.KeyboardButton)return{type:"command",text:n};if(e instanceof fe.jI.KeyboardButtonUrl)return e.url.includes("?startgroup=")?{type:"unsupported",text:n}:{type:"url",text:n,url:e.url};if(e instanceof fe.jI.KeyboardButtonCallback)return e.requiresPassword?{type:"unsupported",text:n}:{type:"callback",text:n,data:Ps(e.data)};if(e instanceof fe.jI.KeyboardButtonRequestPoll)return{type:"requestPoll",text:n,isQuiz:e.quiz};if(e instanceof fe.jI.KeyboardButtonRequestPhone)return{type:"requestPhone",text:n};if(e instanceof fe.jI.KeyboardButtonBuy){if(s instanceof fe.jI.MessageMediaInvoice&&s.receiptMsgId)return{type:"receipt",receiptMessageId:s.receiptMsgId};if(t)return;return{type:"buy",text:n}}return e instanceof fe.jI.KeyboardButtonGame?{type:"game",text:n}:e instanceof fe.jI.KeyboardButtonSwitchInline?{type:"switchBotInline",text:n,query:e.query,isSamePeer:e.samePeer}:e instanceof fe.jI.KeyboardButtonUserProfile?{type:"userProfile",text:n,userId:e.userId.toString()}:e instanceof fe.jI.KeyboardButtonSimpleWebView?{type:"simpleWebView",text:n,url:e.url}:e instanceof fe.jI.KeyboardButtonWebView?{type:"webView",text:n,url:e.url}:e instanceof fe.jI.KeyboardButtonUrlAuth?{type:"urlAuth",text:n,url:e.url,buttonId:e.buttonId}:e instanceof fe.jI.KeyboardButtonCopy?{type:"copy",text:n,copyText:e.copyText}:{type:"unsupported",text:n}})).filter(Boolean)));return i.every((e=>!e.length))?void 0:{[n instanceof fe.jI.ReplyKeyboardMarkup?"keyboardButtons":"inlineButtons"]:i,...n instanceof fe.jI.ReplyKeyboardMarkup&&{keyboardPlaceholder:n.placeholder,isKeyboardSingleUse:n.singleUse,isKeyboardSelective:n.selective}}}(t,l)||{},{mediaUnread:w,postAuthor:y}=t,v=t.groupedId&&String(t.groupedId),b=Boolean(v)&&!(d.document||d.audio||d.sticker),S=t.replyMarkup instanceof fe.jI.ReplyKeyboardHide,j=t.replyMarkup instanceof fe.jI.ReplyKeyboardHide&&t.replyMarkup.selective,C=t.noforwards||l,P=!t.noforwards,_=oi(d,v),M=t.replies?.comments,T=t.fromBoostsApplied,k=t.factcheck&&ja(t.factcheck),A=t.videoProcessingPending,E=t.reactionsArePossible,D=t.invertMedia,U=t.savedPeerId&&ms(t.savedPeerId);return li({id:t.id,chatId:e,isOutgoing:r,content:d,date:t.date,senderId:n,viewsCount:t.views,forwardsCount:t.forwards,isScheduled:u,isFromScheduled:t.fromScheduled,isSilent:t.silent,isPinned:t.pinned,reactions:t.reactions&&na(t.reactions),emojiOnlyCount:_,...t.replyTo&&{replyInfo:Sa(t.replyTo,t)},forwardInfo:o,isEdited:f,editDate:t.editDate,isMediaUnread:w,hasUnreadMention:t.mentioned&&w,areReactionsPossible:E,isMentioned:t.mentioned,...v&&{groupedId:v,isInAlbum:b},inlineButtons:h,...p&&{keyboardButtons:p,keyboardPlaceholder:m,isKeyboardSingleUse:g,isKeyboardSelective:I},...S&&{shouldHideKeyboardButtons:S,isHideKeyboardSelective:j},...t.viaBotId&&{viaBotId:ps(t.viaBotId,"user")},postAuthorTitle:y,isProtected:C,isForwardingAllowed:P,hasComments:M,savedPeerId:U,senderBoosts:T,viaBusinessBotId:t.viaBusinessBotId?.toString(),factCheck:k,effectId:t.effect?.toString(),isInvertedMedia:D,isVideoProcessingPending:A,reportDeliveryUntilDate:t.reportDeliveryUntilDate})}function va(e){if(e instanceof fe.jI.DraftMessageEmpty)return;const{message:t,entities:n,replyTo:s,date:i,effect:o}=e,a=s instanceof fe.jI.InputReplyToMessage?{type:"message",replyToMsgId:s.replyToMsgId,replyToTopId:s.topMsgId,replyToPeerId:s.replyToPeerId&&ms(s.replyToPeerId),quoteText:s.quoteText?Fo(s.quoteText,s.quoteEntities):void 0}:void 0;return{text:t?Fo(t,n):void 0,replyInfo:a,date:i,effectId:o?.toString()}}function ba(e,t=!1){const n=e.savedFromPeer&&ms(e.savedFromPeer),s=e.fromId&&ms(e.fromId);return{date:e.date,savedDate:e.savedDate,isImported:e.imported,isChannelPost:Boolean(e.channelPost),channelPostId:e.channelPost,isLinkedChannelPost:Boolean(e.channelPost&&n===s&&e.savedFromMsgId===e.channelPost&&!t),savedFromPeerId:n,isSavedOutgoing:e.savedOut,fromId:s,fromChatId:s||n,fromMessageId:e.savedFromMsgId||e.channelPost,hiddenUserName:e.fromName,postAuthorTitle:e.postAuthor}}function Sa(e,t){if(e instanceof fe.jI.MessageReplyStoryHeader)return{type:"story",peerId:ms(e.peer),storyId:e.storyId};if(e instanceof fe.jI.MessageReplyHeader){const{replyFrom:n,replyToMsgId:s,replyToTopId:i,replyMedia:o,replyToPeerId:a,forumTopic:r,quote:d,quoteText:c,quoteEntities:u}=e;return{type:"message",replyToMsgId:s,replyToTopId:i,isForumTopic:r,replyFrom:n&&ba(n),replyToPeerId:a&&ms(a),replyMedia:o&&Lo(o,t),isQuote:d,quoteText:c?Fo(c,u):void 0}}}function ja(e){return{shouldFetch:e.needCheck,hash:e.hash.toString(),text:e.text&&Mo(e.text),countryCode:e.country}}function Ca(e){const{filename:t,blobUrl:n,previewBlobUrl:s,mimeType:i,size:o,audio:a,shouldSendAsFile:r,shouldSendAsSpoiler:d,ttlSeconds:c}=e;if(!r){if(e.quick){if(F.has(i)){const{width:t,height:i}=e.quick;return{photo:{mediaType:"photo",id:fa,sizes:[],thumbnail:{width:t,height:i,dataUri:s||n},blobUrl:n,date:Math.round(Date.now()/1e3),isSpoiler:d}}}if(L.has(i)){const{width:a,height:r,duration:c}=e.quick;return{video:{mediaType:"video",id:fa,mimeType:i,duration:c||0,fileName:t,width:a,height:r,blobUrl:n,...s&&{thumbnail:{width:a,height:r,dataUri:s}},size:o,isSpoiler:d}}}}if(e.voice){const{duration:t,waveform:n}=e.voice,{data:s}=pi(n,ha);return{voice:{mediaType:"voice",id:fa,duration:t,waveform:s,size:o},ttlSeconds:c}}if(z.has(i)){const{duration:e,performer:n,title:s}=a||{};return{audio:{mediaType:"audio",id:fa,mimeType:i,fileName:t,size:o,duration:e||0,title:s,performer:n}}}}return{document:{mediaType:"document",mimeType:i,fileName:t,size:o,...s&&{previewBlobUrl:s}}}}function Pa(e){const t=js(e);if(t&&e instanceof fe.jI.Message&&e.replies)return _a(e.replies,e.id,t)}function _a(e,t,n){const{channelId:s,replies:i,maxId:o,readMaxId:a,recentRepliers:r,comments:d}=e,c=s?ps(s,"channel"):void 0;if(c===ee)return;const u={messagesCount:i,...o&&{lastMessageId:o},...a&&{lastReadMessageId:a},...r&&{recentReplierIds:r.map(ms)}};return d?{...u,isCommentsInfo:!0,chatId:c,originChannelId:n,originMessageId:t}:{...u,isCommentsInfo:!1,chatId:n,threadId:t}}function Ma(e){const{shortcutId:t,shortcut:n,topMessage:s}=e;return{id:t,shortcut:n,topMessageId:s}}function Ta(e){return e instanceof fe.jI.ReportResultReported?{type:"reported"}:e instanceof fe.jI.ReportResultAddComment?{type:"comment",isOptional:e.optional,option:Ps(e.option)}:{type:"selectOption",title:e.title,options:e.options.map((e=>({text:e.text,option:Ps(e.option)})))}}function ka(e,t){if(t instanceof fe.jI.StoryItemDeleted)return{id:t.id,peerId:e,isDeleted:!0};if(t instanceof fe.jI.StoryItemSkipped){const{id:n,date:s,expireDate:i,closeFriends:o}=t;return{id:n,peerId:e,...o&&{isForCloseFriends:!0},date:s,expireDate:i}}const{edited:n,pinned:s,expireDate:i,id:o,date:a,caption:r,entities:d,media:c,privacy:u,views:l,public:f,noforwards:h,closeFriends:p,contacts:m,selectedContacts:g,mediaAreas:I,sentReaction:w,out:y,fwdFrom:v,fromId:b}=t,S={...Lo(c)};r&&(S.text=Fo(r,d));const j=w&&ra(w);return li({id:o,peerId:e,date:a,expireDate:i,content:S,isPublic:f,isEdited:n,isInProfile:s,isForContacts:m,isForSelectedContacts:g,isForCloseFriends:p,noForwards:h,views:l&&Aa(l),isOut:y,visibility:u&&_o(u),mediaAreas:I?.map(Da).filter(Boolean),sentReaction:j,forwardInfo:v&&Ua(v),fromId:b&&ms(b)})}function Aa(e){return li({hasViewers:e.hasViewers,viewsCount:e.viewsCount,forwardsCount:e.forwardsCount,reactionsCount:e.reactionsCount,reactions:e.reactions?.map(ia).filter(Boolean),recentViewerIds:e.recentViewers?.map((e=>ps(e,"user")))})}function Ra(e){const{blockedMyStoriesFrom:t,blocked:n}=e;if(e instanceof fe.jI.StoryView)return li({type:"user",peerId:ps(e.userId,"user"),date:e.date,reaction:e.reaction&&ra(e.reaction),areStoriesBlocked:n||t,isUserBlocked:n});if(e instanceof fe.jI.StoryViewPublicForward){const s=wa(e.message);if(!s)return;return{type:"forward",peerId:s.chatId,messageId:s.id,message:s,date:s.date,areStoriesBlocked:n||t,isUserBlocked:n}}if(e instanceof fe.jI.StoryViewPublicRepost){const s=ms(e.peerId),i=ka(s,e.story);if(!("content"in i))return;return{type:"repost",peerId:s,storyId:e.story.id,date:i.date,story:i,areStoriesBlocked:n||t,isUserBlocked:n}}}function Ea(e){return{activeUntil:e.activeUntilDate,cooldownUntil:e.cooldownUntilDate}}function Da(e){const t=function(e){const{x:t,y:n,w:s,h:i,rotation:o,radius:a}=e;return{x:t,y:n,width:s,height:i,rotation:o,radius:a}}(e.coordinates);if(e instanceof fe.jI.MediaAreaVenue){const{geo:n,title:s}=e,i=Ko(n);if(!i)return;return{type:"venue",coordinates:t,geo:i,title:s}}if(e instanceof fe.jI.MediaAreaGeoPoint){const{geo:n}=e,s=Ko(n);if(!s)return;return{type:"geoPoint",coordinates:t,geo:s}}if(e instanceof fe.jI.MediaAreaSuggestedReaction){const{reaction:n,dark:s,flipped:i}=e,o=ra(n);if(!o)return;return{type:"suggestedReaction",coordinates:t,reaction:o,...s&&{isDark:!0},...i&&{isFlipped:!0}}}if(e instanceof fe.jI.MediaAreaChannelPost){const{channelId:n,msgId:s}=e;return{type:"channelPost",coordinates:t,channelId:ps(n,"channel"),messageId:s}}if(e instanceof fe.jI.MediaAreaUrl){const{url:n}=e;return{type:"url",coordinates:t,url:n}}if(e instanceof fe.jI.MediaAreaWeather){const{emoji:n,temperatureC:s,color:i}=e;return{type:"weather",coordinates:t,emoji:n,temperatureC:s,color:i}}if(e instanceof fe.jI.MediaAreaStarGift){const{slug:n}=e;return{type:"uniqueGift",coordinates:t,slug:n}}}function Ua(e){const{from:t,fromName:n,storyId:s,modified:i}=e;return{storyId:s,fromPeerId:t&&ms(t),fromName:n,isModified:i}}function xa(e){return{id:e.botId.toString(),shouldRequestWriteAccess:e.requestWriteAccess,shortName:e.shortName,isForAttachMenu:e.showInAttachMenu,isForSideMenu:e.showInSideMenu,attachMenuPeerTypes:e.peerTypes?.map(Na),icons:e.icons.map(Ba).filter(Boolean),isInactive:e.inactive,isDisclaimerNeeded:e.sideMenuDisclaimerNeeded}}function Na(e){return e instanceof fe.jI.AttachMenuPeerTypeBotPM?"bots":e instanceof fe.jI.AttachMenuPeerTypePM?"users":e instanceof fe.jI.AttachMenuPeerTypeChat?"chats":e instanceof fe.jI.AttachMenuPeerTypeBroadcast?"channels":e instanceof fe.jI.AttachMenuPeerTypeSameBotPM?"self":void 0}function Ba(e){if(!(e.icon instanceof fe.jI.Document))return;const t=$o(e.icon);return t?(eo(e.icon),{name:e.name,document:t}):void 0}function Ha(e,t){const{description:n,descriptionPhoto:s,descriptionDocument:i,userId:o,commands:a,menuButton:r,privacyPolicyUrl:d,hasPreviewMedias:c,appSettings:u}=e,l=o&&ps(o,"user"),f=s instanceof fe.jI.Photo?bo(s):void 0,h=i instanceof fe.jI.Document?zo(i):void 0,p=a?.map((e=>function(e,t){return{botId:e,...Es(t)}}(l||t,e)));return{botId:l||t,description:n,gif:h,photo:f,menuButton:Oa(r),privacyPolicyUrl:d,commands:p?.length?p:void 0,hasPreviewMedia:c,appSettings:u&&Ga(u)}}function Ga(e){const t=e.placeholderPath&&Io(e.placeholderPath);return{backgroundColor:e.backgroundColor?Eo(e.backgroundColor):void 0,backgroundDarkColor:e.backgroundDarkColor?Eo(e.backgroundDarkColor):void 0,headerColor:e.headerColor?Eo(e.headerColor):void 0,headerDarkColor:e.headerDarkColor?Eo(e.headerDarkColor):void 0,placeholderPath:t}}function Oa(e){return e instanceof fe.jI.BotMenuButton?{type:"webApp",text:e.text,url:e.url}:{type:"commands"}}function qa(e){const{address:t,geoPoint:n}=e;return{address:t,geo:n&&Ko(n)}}function Fa(e){const{timezoneId:t,weeklyOpen:n}=e;return{timezoneId:t,workHours:n.map((({startMinute:e,endMinute:t})=>({startMinute:e,endMinute:t})))}}function La(e){const{title:t,description:n,sticker:s}=e;return{title:t,description:n,sticker:s&&Do(s)}}function za(e){const{fullUser:{about:t,commonChatsCount:n,pinnedMsgId:s,botInfo:i,blocked:o,profilePhoto:a,voiceMessagesForbidden:r,premiumGifts:d,hasScheduled:c,fallbackPhoto:u,personalPhoto:l,translationsDisabled:f,storiesPinnedAvailable:h,contactRequirePremium:p,businessWorkHours:m,businessLocation:g,businessIntro:I,birthday:w,personalChannelId:y,personalChannelMessage:v,sponsoredEnabled:b,stargiftsCount:S,botVerification:j,botCanManageEmojiStatus:C},users:P}=e,_=ps(P[0].id,"user");return{bio:t,commonChatsCount:n,pinnedMessageId:s,isBlocked:Boolean(o),noVoiceMessages:r,hasPinnedStories:Boolean(h),isTranslationDisabled:f,profilePhoto:a instanceof fe.jI.Photo?bo(a):void 0,fallbackPhoto:u instanceof fe.jI.Photo?bo(u):void 0,personalPhoto:l instanceof fe.jI.Photo?bo(l):void 0,premiumGifts:d?.map((e=>function(e){const{months:t,currency:n,amount:s,botUrl:i}=e;return{months:t,currency:n,amount:s.toJSNumber(),botUrl:i}}(e))),botInfo:i&&Ha(i,_),isContactRequirePremium:p,birthday:w&&Ka(w),businessLocation:g&&qa(g),businessWorkHours:m&&Fa(m),businessIntro:I&&La(I),personalChannelId:y&&ps(y,"channel"),personalChannelMessageId:v,botVerification:j&&Ao(j),areAdsEnabled:b,starGiftCount:S,isBotCanManageEmojiStatus:C,hasScheduledMessages:c}}function Va(e){if(!(e instanceof fe.jI.User))return;const{id:t,firstName:n,lastName:s,fake:i,scam:o,support:a,closeFriend:r,storiesUnavailable:d,storiesMaxId:c,bot:u,botActiveUsers:l,botVerificationIcon:f,botInlinePlaceholder:h,botAttachMenu:p,botCanEdit:m}=e,g=e.photo instanceof fe.jI.UserProfilePhoto?Boolean(e.photo.hasVideo):void 0,I=e.photo&&ko(e.photo),w=(b=e).bot?"userTypeBot":b.deleted?"userTypeDeleted":"userTypeRegular",y=Po(e),v=e.emojiStatus?Is(e.emojiStatus):void 0;var b;return{id:ps(t,"user"),isMin:Boolean(e.min),fakeType:o?"scam":i?"fake":void 0,...e.self&&{isSelf:!0},isPremium:Boolean(e.premium),...e.verified&&{isVerified:!0},...r&&{isCloseFriend:!0},...a&&{isSupport:!0},...(e.contact||e.mutualContact)&&{isContact:!0},type:w,firstName:n,lastName:s,hasMainMiniApp:Boolean(e.botHasMainApp),canEditBot:m,..."userTypeBot"===w&&{canBeInvitedToGroup:!e.botNochats},...y&&{usernames:y},phoneNumber:e.phone||"",noStatus:!e.status,...e.accessHash&&{accessHash:String(e.accessHash)},avatarPhotoId:I,emojiStatus:v,hasVideoAvatar:g,areStoriesHidden:Boolean(e.storiesHidden),maxStoryId:c,hasStories:Boolean(c)&&!d,...u&&h&&{botPlaceholder:h},...u&&p&&{isAttachBot:p},botActiveUsers:l,botVerificationIconId:f?.toString(),color:e.color&&gs(e.color)}}function $a(e){return!e||e instanceof fe.jI.UserStatusEmpty?{type:"userStatusEmpty"}:e instanceof fe.jI.UserStatusOnline?{type:"userStatusOnline",expires:e.expires}:e instanceof fe.jI.UserStatusOffline?{type:"userStatusOffline",wasOnline:e.wasOnline}:e instanceof fe.jI.UserStatusRecently?{type:"userStatusRecently",isReadDateRestrictedByMe:e.byMe}:e instanceof fe.jI.UserStatusLastWeek?{type:"userStatusLastWeek",isReadDateRestrictedByMe:e.byMe}:{type:"userStatusLastMonth",isReadDateRestrictedByMe:e.byMe}}function Wa(e){const t={};return e.forEach((e=>{if("status"in e){const n=ps(e.id,"user");t[n]=$a(e.status)}})),t}function Ka(e){return Es(e)}function Ja(e,t=!1){const n=Boolean("min"in e&&e.min),s="accessHash"in e?String(e.accessHash):void 0,i="photo"in e&&e.photo&&"hasVideo"in e.photo&&e.photo.hasVideo,o="photo"in e&&e.photo?ko(e.photo):void 0,a=Boolean("signatures"in e&&e.signatures),r=Boolean("hasLink"in e&&e.hasLink),d=Boolean("scam"in e&&e.scam),c=Boolean("fake"in e&&e.fake),u=Boolean("joinToSend"in e&&e.joinToSend),l=Boolean("joinRequest"in e&&e.joinRequest),f=Po(e),h=Boolean("forum"in e&&e.forum),p=Boolean("storiesHidden"in e&&e.storiesHidden),m="storiesMaxId"in e?e.storiesMaxId:void 0,g="botVerificationIcon"in e?e.botVerificationIcon?.toString():void 0,I=Boolean("storiesUnavailable"in e&&e.storiesUnavailable),w="color"in e&&e.color?gs(e.color):void 0,y="emojiStatus"in e&&e.emojiStatus?Is(e.emojiStatus):void 0,v="level"in e?e.level:void 0,b=Boolean("signatureProfiles"in e&&e.signatureProfiles),S="subscriptionUntilDate"in e?e.subscriptionUntilDate:void 0;return{isMin:n,hasPrivateLink:r,areSignaturesShown:a,areProfilesShown:b,usernames:f,accessHash:s,hasVideoAvatar:i,avatarPhotoId:o,..."verified"in e&&{isVerified:e.verified},..."callActive"in e&&{isCallActive:e.callActive},..."callNotEmpty"in e&&{isCallNotEmpty:e.callNotEmpty},..."date"in e&&{creationDate:e.date},..."participantsCount"in e&&void 0!==e.participantsCount&&{membersCount:e.participantsCount},..."noforwards"in e&&{isProtected:Boolean(e.noforwards)},isSupport:t||void 0,...Ya(e),..."creator"in e&&{isCreator:e.creator},...Xa(e),...Za(e),fakeType:d?"scam":c?"fake":void 0,color:w,isJoinToSend:u,isJoinRequest:l,isForum:h,areStoriesHidden:p,maxStoryId:m,hasStories:Boolean(m)&&!I,emojiStatus:y,boostLevel:v,botVerificationIconId:g,subscriptionUntil:S}}function Qa(e,t){const{peer:n,folderId:s,unreadMark:i,unreadCount:o,unreadMentionsCount:a,unreadReactionsCount:r,notifySettings:{silent:d,muteUntil:c},readOutboxMaxId:u,readInboxMaxId:l,draft:f,viewForumAsMessages:h}=e,p=d||"number"==typeof c&&An()<c;return{id:ms(n),...s&&{folderId:s},type:tr(t),title:sr(n,t),lastReadOutboxMessageId:u,lastReadInboxMessageId:l,unreadCount:o,unreadMentionsCount:a,unreadReactionsCount:r,isMuted:p,muteUntil:c,...i&&{hasUnreadMark:!0},...f instanceof fe.jI.DraftMessage&&{draftDate:f.date},...h&&{isForumAsMessages:!0},...Ja(t)}}function Ya(e){return e instanceof fe.jI.Chat||e instanceof fe.jI.Channel?{adminRights:e.adminRights?Es(e.adminRights):void 0,currentUserBannedRights:"bannedRights"in e&&e.bannedRights?Es(e.bannedRights):void 0,defaultBannedRights:e.defaultBannedRights?Es(e.defaultBannedRights):void 0}:{}}function Xa(e){if(e instanceof fe.jI.ChatForbidden)return{isForbidden:!0};if(e instanceof fe.jI.ChannelForbidden)return{isRestricted:!0};const t={};if("restricted"in e){const n=e.restricted?function(e){if(!e)return;const t=e.find((({platform:e})=>"all"===e));return t?di(t,["reason","text"]):void 0}(e.restrictionReason):void 0;n&&Object.assign(t,{isRestricted:!0,restrictionReason:n})}return e instanceof fe.jI.Chat&&Object.assign(t,{isNotJoined:e.left}),e instanceof fe.jI.Channel&&Object.assign(t,{isNotJoined:e.left}),t}function Za(e){return!("migratedTo"in e)||!e.migratedTo||e.migratedTo instanceof fe.jI.InputChannelEmpty?{}:{migratedTo:{chatId:ms(e.migratedTo),...e.migratedTo instanceof fe.jI.InputChannel&&{accessHash:String(e.migratedTo.accessHash)}}}}function er(e,t=!1){if(!(e instanceof fe.jI.ChatEmpty||e instanceof fe.jI.UserEmpty))return{id:ps(e.id,e instanceof fe.jI.User?"user":e instanceof fe.jI.Chat||e instanceof fe.jI.ChatForbidden?"chat":"channel"),type:tr(e),title:e instanceof fe.jI.User?ir(e):e.title,...Ja(e,t)}}function tr(e){return e instanceof fe.jI.User||e instanceof fe.jI.UserEmpty?"chatTypePrivate":e instanceof fe.jI.Chat||e instanceof fe.jI.ChatForbidden||e instanceof fe.jI.ChatEmpty?"chatTypeBasicGroup":e.megagroup?"chatTypeSuperGroup":"chatTypeChannel"}function nr(e){return fs(e)?`user${e.userId}`:hs(e)?`chat${e.chatId}`:`chat${e.channelId}`}function sr(e,t){return fs(e)?ir(t):t.title}function ir(e){return e.firstName?`${e.firstName}${e.lastName?` ${e.lastName}`:""}`:e.lastName||""}function or(e){return{userId:e instanceof fe.jI.ChannelParticipantBanned||e instanceof fe.jI.ChannelParticipantLeft?ms(e.peer):ps(e.userId,"user"),inviterId:"inviterId"in e&&e.inviterId?ps(e.inviterId,"user"):void 0,joinedDate:"date"in e?e.date:void 0,kickedByUserId:"kickedBy"in e&&e.kickedBy?ps(e.kickedBy,"user"):void 0,promotedByUserId:"promotedBy"in e&&e.promotedBy?ps(e.promotedBy,"user"):void 0,bannedRights:"bannedRights"in e?Es(e.bannedRights):void 0,adminRights:"adminRights"in e?Es(e.adminRights):void 0,customTitle:"rank"in e?e.rank:void 0,isViaRequest:"viaRequest"in e?e.viaRequest:void 0,...(e instanceof fe.jI.ChannelParticipantAdmin||e instanceof fe.jI.ChatParticipantAdmin)&&{isAdmin:!0},...(e instanceof fe.jI.ChannelParticipantCreator||e instanceof fe.jI.ChatParticipantCreator)&&{isOwner:!0}}}function ar(e){return e instanceof fe.jI.ChatParticipants||e instanceof fe.jI.channels.ChannelParticipants?e.participants.map(or).filter(Boolean):void 0}function rr(e){let t,n="";if(!(e.action instanceof fe.jI.SendMessageCancelAction)){if(e.action instanceof fe.jI.SendMessageTypingAction)n="lng_user_typing";else if(e.action instanceof fe.jI.SendMessageRecordVideoAction)n="lng_send_action_record_video";else if(e.action instanceof fe.jI.SendMessageUploadVideoAction)n="lng_send_action_upload_video";else if(e.action instanceof fe.jI.SendMessageRecordAudioAction)n="lng_send_action_record_audio";else if(e.action instanceof fe.jI.SendMessageUploadAudioAction)n="lng_send_action_upload_audio";else if(e.action instanceof fe.jI.SendMessageUploadPhotoAction)n="lng_send_action_upload_photo";else if(e.action instanceof fe.jI.SendMessageUploadDocumentAction)n="lng_send_action_upload_file";else if(e.action instanceof fe.jI.SendMessageGeoLocationAction)n="selecting a location to share";else if(e.action instanceof fe.jI.SendMessageChooseContactAction)n="selecting a contact to share";else if(e.action instanceof fe.jI.SendMessageGamePlayAction)n="lng_playing_game";else if(e.action instanceof fe.jI.SendMessageRecordRoundAction)n="lng_send_action_record_round";else if(e.action instanceof fe.jI.SendMessageUploadRoundAction)n="lng_send_action_upload_round";else if(e.action instanceof fe.jI.SendMessageChooseStickerAction)n="lng_send_action_choose_sticker";else{if(e.action instanceof fe.jI.SpeakingInGroupCallAction)return;if(e.action instanceof fe.jI.SendMessageEmojiInteractionSeen)n="lng_user_action_watching_animations",t=e.action.emoticon;else if(e.action instanceof fe.jI.SendMessageEmojiInteraction)return}return{action:n,...t&&{emoji:t},...!(e instanceof fe.jI.UpdateUserTyping)&&{userId:ms(e.fromId)},timestamp:Date.now()+1e3*kn()}}}function dr(e){return e instanceof fe.jI.DialogFilterChatlist?{...ci(e,["id","emoticon"]),excludedChatIds:[],includedChatIds:e.includePeers.map(ms).filter(Boolean),pinnedChatIds:e.pinnedPeers.map(ms).filter(Boolean),hasMyInvites:e.hasMyInvites,isChatList:!0,noTitleAnimations:e.titleNoanimate,title:Mo(e.title)}:{...ci(e,["id","emoticon","contacts","nonContacts","groups","bots","excludeMuted","excludeRead","excludeArchived"]),channels:e.broadcasts,pinnedChatIds:e.pinnedPeers.map(ms).filter(Boolean),includedChatIds:e.includePeers.map(ms).filter(Boolean),excludedChatIds:e.excludePeers.map(ms).filter(Boolean),title:Mo(e.title),noTitleAnimations:e.titleNoanimate}}function cr({filter:e,description:t}){if(e instanceof fe.jI.DialogFilter||e instanceof fe.jI.DialogFilterChatlist)return{...dr(e),description:t}}function ur(e){return e.reduce(((e,t)=>{const n=ps(t.userId,"user");return t.commands&&(e=e.concat(t.commands.map((e=>({botId:n,...Es(e)}))))),e}),[])}function lr(e){const{revoked:t,date:n,expireDate:s,link:i,permanent:o,startDate:a,usage:r,usageLimit:d,requested:c,requestNeeded:u,title:l,adminId:f}=e;return{isRevoked:t,date:n,expireDate:s,link:i,isPermanent:o,startDate:a,usage:r,usageLimit:d,isRequestNeeded:u,requested:c,title:l,adminId:ps(f,"user")}}function fr({autoarchived:e,reportSpam:t,addContact:n,blockContact:s}){return{isAutoArchived:Boolean(e),canReportSpam:Boolean(t),canAddContact:Boolean(n),canBlockContact:Boolean(s)}}function hr(e){return e instanceof fe.jI.ChatReactionsAll?{type:"all",areCustomAllowed:e.allowCustom}:e instanceof fe.jI.ChatReactionsSome?{type:"some",allowed:e.reactions.map((e=>ra(e))).filter(Boolean)}:void 0}function pr(e){return{id:ms(e.peer),isPremium:e.premiumRequired}}function mr(e){if(e instanceof fe.jI.ForumTopicDeleted)return;const{id:t,my:n,closed:s,pinned:i,hidden:o,short:a,date:r,title:d,iconColor:c,iconEmojiId:u,topMessage:l,unreadCount:f,unreadMentionsCount:h,unreadReactionsCount:p,fromId:m,notifySettings:{silent:g,muteUntil:I}}=e;return{id:t,isClosed:s,isPinned:i,isHidden:o,isOwner:n,isMin:a,date:r,title:d,iconColor:c,iconEmojiId:u?.toString(),lastMessageId:l,unreadCount:f,unreadMentionsCount:h,unreadReactionsCount:p,fromId:ms(m),isMuted:g||("number"==typeof I?An()<I:void 0),muteUntil:I}}function gr(e){if(!(e instanceof fe.jI.ExportedChatlistInvite))return;const{title:t,url:n,peers:s}=e;return{title:t,url:n,peerIds:s.map(ms).filter(Boolean)}}function Ir(e){return{id:e.userId.toString(),isRequiringPremiumToMessage:e.premiumRequiredForPm,isRequiringPremiumToInvite:e.premiumWouldAllowInvite}}function wr(e){const{color:t,participants:n,participantsCount:s,photo:i,title:o,about:a,scam:r,fake:d,verified:c,megagroup:u,channel:l,broadcast:f,requestNeeded:h,subscriptionFormId:p,subscriptionPricing:m,canRefulfillSubscription:g,botVerification:I}=e;let w;return i instanceof fe.jI.Photo&&(Zi(i),w=bo(i)),n?.forEach(so),{title:o,about:a,isFake:d,isScam:r,isVerified:c,isSuperGroup:u,isPublic:e.public,participantsCount:s,color:t,isChannel:l,isBroadcast:f,isRequestNeeded:h,photo:w,subscriptionFormId:p?.toString(),subscriptionPricing:m&&yr(m),canRefulfillSubscription:g,participantIds:n?.map((e=>ps(e.id,"user"))).filter(Boolean),botVerification:I&&Ao(I)}}function yr(e){return{period:e.period,amount:e.amount.toJSNumber()}}const vr=new Set(["User","UserEmpty"]),br=new Set(["ChatEmpty","Chat","ChatForbidden","Channel","ChannelForbidden"]),Sr=new Set(["Message","MessageEmpty","MessageService"]);function jr(e){if(!e||"object"!=typeof e)return;if(!("users"in e||"chats"in e||"messages"in e))return;let t,n;const s=[],i=[];"users"in e&&Array.isArray(e.users)&&vr.has(e.users[0]?.className)&&(t=ai(e.users.map((e=>(e instanceof fe.jI.User&&so(e),Va(e)))).filter(Boolean),"id")),"chats"in e&&Array.isArray(e.chats)&&br.has(e.chats[0]?.className)&&(n=ai(e.chats.map((e=>((e instanceof fe.jI.Chat||e instanceof fe.jI.Channel)&&function(e){const t=ps(e.id,e instanceof fe.jI.Chat?"chat":"channel"),n=qs.chats[t],s=n&&"min"in n&&n.min,i="min"in e&&e.min;n&&!s&&i||(qs.chats[t]=e)}(e),er(e)))).filter(Boolean),"id")),"messages"in e&&Array.isArray(e.messages)&&Sr.has(e.messages[0]?.className)&&e.messages.forEach((e=>{Qi(e);const t=Pa(e);t&&s.push(t);const n="media"in e&&e.media&&Wo(e.media);n&&i.push(n)})),(t||n||s?.length)&&Vs({"@type":"updateEntities",users:t,chats:n,threadInfos:s?.length?s:void 0,polls:i?.length?i:void 0})}function Cr(e){Qi(e);const t=Pa(e);t&&Vs({"@type":"updateThreadInfo",threadInfo:t})}class Pr{constructor(e){var t,n,s,i;this.comparator=e,t=this,s=void 0,(n="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n="queue"))?i:i+"")in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s,this.queue=[]}add(e){const t=this.binarySearch(e);this.queue.splice(t,0,e)}pop(){return this.queue.shift()}get size(){return this.queue.length}clear(){this.queue=[]}binarySearch(e){let t=0,n=this.queue.length;for(;t<n;){const s=Math.floor((t+n)/2),i=this.comparator(e,this.queue[s]);if(0===i)return s;i>0?t=s+1:n=s}return t}}function _r(e){if(e instanceof fe.jI.WallPaperNoFile)return;const{id:t,slug:n}=e,s=$o(e.document);if(!s)return;const i=e.pattern??!1,o=e.settings?.blur??!1,a=e.settings?.motion??!1,r=e.settings?.backgroundColor?Eo(e.settings.backgroundColor):void 0,d=e.settings?.secondBackgroundColor?Eo(e.settings.secondBackgroundColor):void 0,c=e.settings?.thirdBackgroundColor?Eo(e.settings.thirdBackgroundColor):void 0,u=e.settings?.fourthBackgroundColor?Eo(e.settings.fourthBackgroundColor):void 0,l=e.settings?.intensity,f=e.settings?.rotation,h=e.settings?.emoticon;return{id:t.toString(),slug:n,pattern:i,document:s,blur:o,motion:a,backgroundColor:r,secondBackgroundColor:d,thirdBackgroundColor:c,fourthBackgroundColor:u,intensity:l,rotation:f,emoticon:h}}function Mr(e){return{isCurrent:Boolean(e.current),isOfficialApp:Boolean(e.officialApp),isPasswordPending:Boolean(e.passwordPending),hash:String(e.hash),areCallsEnabled:!e.callRequestsDisabled,areSecretChatsEnabled:!e.encryptedRequestsDisabled,isUnconfirmed:e.unconfirmed,...di(e,["deviceModel","platform","systemVersion","appName","appVersion","dateCreated","dateActive","ip","country","region"])}}function Tr(e){return{hash:String(e.hash),botId:ps(e.botId,"user"),...di(e,["platform","browser","dateCreated","dateActive","ip","region","domain"])}}function kr(e,t){const{silent:n,muteUntil:s,showPreviews:i,otherSound:o}=e,a=Boolean(o&&!(o instanceof fe.jI.NotificationSoundNone));return{chatId:ms(t),isMuted:n||"number"==typeof s&&An()<s,...!a&&{isSilent:!0},...void 0!==i&&{shouldShowPreviews:Boolean(i)},muteUntil:s}}function Ar(e,t){const{hidden:n,iso2:s,defaultName:i,name:o}=e,{countryCode:a,prefixes:r,patterns:d}=t||{};return{isHidden:n,iso2:s,defaultName:i,name:o,countryCode:a,prefixes:r,patterns:d}}function Rr(e){if(!(e instanceof fe.jI.JsonNull))return e instanceof fe.jI.JsonString||e instanceof fe.jI.JsonBool||e instanceof fe.jI.JsonNumber?e.value:e instanceof fe.jI.JsonArray?e.value.map(Rr):e.value.reduce(((e,t)=>(e[t.key]=Rr(t.value),e)),{})}function Er(e){if(e instanceof fe.jI.UrlAuthResultRequest){const{bot:t,domain:n,requestWriteAccess:s}=e,i=Va(t);if(!i)return;return so(t),{type:"request",domain:n,shouldRequestWriteAccess:s,bot:i}}return e instanceof fe.jI.UrlAuthResultAccepted?{type:"accepted",url:e.url}:e instanceof fe.jI.UrlAuthResultDefault?{type:"default"}:void 0}function Dr(e){return e.strings.reduce(((e,t)=>(e[t.key]=function(e){return e instanceof fe.jI.LangPackString?e.value:e instanceof fe.jI.LangPackStringPluralized?ui(Es(e),["key"]):void 0}(t),e)),{})}function Ur(e){const t=[],n=e.reduce(((e,n)=>(n instanceof fe.jI.LangPackStringDeleted&&t.push(n.key),n instanceof fe.jI.LangPackString&&(e[n.key]=n.value),n instanceof fe.jI.LangPackStringPluralized&&(e[n.key]=li({zero:n.zeroValue,one:n.oneValue,two:n.twoValue,few:n.fewValue,many:n.manyValue,other:n.otherValue})),e)),{});return{keysToRemove:t,strings:n}}function xr(e){const{name:t,nativeName:n,langCode:s,pluralCode:i,rtl:o,stringsCount:a,translatedCount:r,translationsUrl:d,beta:c,official:u}=e;return{name:t,nativeName:n,langCode:s,pluralCode:i,isRtl:o,isBeta:c,isOfficial:u,stringsCount:a,translatedCount:r,translationsUrl:d}}function Nr(e){if(e instanceof fe.jI.help.PeerColorSet)return e.colors.map((e=>Eo(e)))}function Br(e){const{id:t,name:n,utcOffset:s}=e;return{id:t,name:n,utcOffset:s}}const Hr=10**9;function Gr(e){return e instanceof fe.jI.PostInteractionCountersMessage?{msgId:e.msgId,forwardsCount:e.forwards,viewsCount:e.views,reactionsCount:e.reactions}:e instanceof fe.jI.PostInteractionCountersStory?{storyId:e.storyId,reactionsCount:e.reactions,viewsCount:e.views,forwardsCount:e.forwards}:void 0}function Or(e){return{viewsGraph:Lr(e.viewsGraph),reactionsGraph:Lr(e.reactionsByEmotionGraph)}}function qr(e){if(e&&"messages"in e)return e.messages.map((t=>Wr(t,e.chats)))}function Fr(e){if(e&&"forwards"in e)return e.forwards.map((t=>{if(t instanceof fe.jI.PublicForwardMessage)return Wr(t.message,e.chats);const{peer:n,story:s}=t;return{peerId:ms(n),storyId:s.id,viewsCount:s.views?.viewsCount||0,reactionsCount:s.views?.reactionsCount||0}}))}function Lr(e,t,n,s){if(e.error)return;const i=JSON.parse(e.json.data),[o,...a]=i.columns,r=i.y_scaled;return{type:t?"area":i.types.y0,zoomToken:e.zoomToken,labelFormatter:i.xTickFormatter,tooltipFormatter:i.xTooltipFormatter,labels:o.slice(1),hideCaption:!i.subchart.show,hasSecondYAxis:r,isStacked:i.stacked&&!r,isPercentage:t,isCurrency:n,currencyRate:s,datasets:a.map((e=>{const t=e[0];return{name:i.names[t],color:(n=i.colors[t],n.substring(n.indexOf("#"))),values:e.slice(1)};var n})),...zr(i.subchart.defaultZoom,o.slice(1))}}function zr(e,t){const[n,s]=e;let i=0,o=t.length-1;return t.forEach(((e,t)=>{!i&&e>=n&&(i=t),!o&&e>=s&&(o=t)})),{minimapRange:{begin:Math.max(0,i/(t.length-1)),end:Math.min(1,o/(t.length-1))},labelFromIndex:i,labelToIndex:o}}function Vr({current:e,previous:t}){const n=e-t;return{current:e,change:n,percentage:(n?Math.abs(n)/t*100:0).toFixed(2)}}function $r(e){return{part:e.part,total:e.total,percentage:(e.part/e.total*100).toFixed(2)}}function Wr(e,t){const n=ms(e.peerId),s=t.find((e=>ps(e.id,"channel")===n)),i=s&&"photo"in s&&s.photo instanceof fe.jI.Photo?s.photo:void 0;return{messageId:e.id,views:e.views,title:s.title,chat:{id:n,type:"chatTypeChannel",title:s.title,usernames:Po(s),avatarPhotoId:i&&ko(i),hasVideoAvatar:Boolean(i?.videoSizes)}}}function Kr({currentBalance:e,availableBalance:t,overallRevenue:n,withdrawalEnabled:s}){return{currentBalance:Number(e)/Hr,availableBalance:Number(t)/Hr,overallRevenue:Number(n)/Hr,isWithdrawalEnabled:s}}function Jr(e){if(e)return Object.values(e).map((e=>({id:e.id,title:e.title,amount:e.prices.reduce(((e,t)=>e+t.amount.toJSNumber()),0),prices:e.prices.map((({label:e,amount:t})=>({label:e,amount:t.toJSNumber()})))})))}function Qr(e){const{photo:t}=e;if(t&&io(t),e instanceof fe.jI.payments.PaymentReceiptStars){const{botId:n,currency:s,date:i,description:o,title:a,totalAmount:r,transactionId:d,invoice:c}=e;return{type:"stars",currency:s,date:i,botId:ps(n,"user"),description:o,title:a,totalAmount:-r.toJSNumber(),transactionId:d,photo:ea(t),invoice:Yr(c)}}const{invoice:n,info:s,shipping:i,totalAmount:o,credentialsTitle:a,tipAmount:r,title:d,description:c,botId:u,currency:l,date:f,providerId:h}=e,{shippingAddress:p,phone:m,name:g}=s||{};let I,w;return i&&(I=i.prices.map((({label:e,amount:t})=>({label:e,amount:t.toJSNumber()}))),w=i.title),{type:"regular",info:{shippingAddress:p,phone:m,name:g},totalAmount:o.toJSNumber(),currency:l,date:f,credentialsTitle:a,shippingPrices:I,shippingMethod:w,tipAmount:r?r.toJSNumber():0,title:d,description:c,botId:ps(u,"user"),providerId:h.toString(),photo:t&&ea(t),invoice:Yr(n)}}function Yr(e){const{test:t,currency:n,prices:s,recurring:i,termsUrl:o,maxTipAmount:a,suggestedTipAmounts:r,emailRequested:d,emailToProvider:c,nameRequested:u,phoneRequested:l,phoneToProvider:f,shippingAddressRequested:h,flexible:p,subscriptionPeriod:m}=e,g=s.map((({label:e,amount:t})=>({label:e,amount:t.toJSNumber()})));return{totalAmount:s.reduce(((e,t)=>e.add(t.amount)),vt()(0)).toJSNumber(),currency:n,isTest:t,isRecurring:i,termsUrl:o,prices:g,maxTipAmount:a?.toJSNumber(),suggestedTipAmounts:r?.map((e=>e.toJSNumber())),isEmailRequested:d,isEmailSentToProvider:c,isNameRequested:u,isPhoneRequested:l,isPhoneSentToProvider:f,isShippingAddressRequested:h,isFlexible:p,subscriptionPeriod:m}}function Xr(e){const{statusText:t,statusEntities:n,videos:s,videoSections:i,periodOptions:o}=e;return{statusText:t,statusEntities:n.map(To),videoSections:i,videos:s.map($o).filter(Boolean),options:o.map(Zr)}}function Zr(e){const{current:t,canPurchaseUpgrade:n,currency:s,amount:i,botUrl:o,months:a}=e;return{isCurrent:t,canPurchaseUpgrade:n,currency:s,amount:i.toJSNumber(),botUrl:o,months:a}}function ed(e){const{userId:t,multiplier:n,expires:s,giveaway:i,gift:o,stars:a}=e;return{userId:t&&ps(t,"user"),multiplier:n,expires:s,isFromGiveaway:i,isGift:o,stars:a?.toJSNumber()}}function td(e){const{date:t,expires:n,slot:s,cooldownUntilDate:i,peer:o}=e;return{date:t,expires:n,slot:s,cooldownUntil:i,chatId:o&&ms(o)}}function nd(e){const{date:t,fromId:n,months:s,giveawayMsgId:i,toId:o,usedDate:a,viaGiveaway:r}=e;return{date:t,months:s,toId:o&&ps(o,"user"),fromId:n&&ms(n),usedAt:a,isFromGiveaway:r,giveawayMessageId:i}}function sd(e){const{amount:t,currency:n,months:s,users:i}=e;return{amount:t.toJSNumber(),currency:n,months:s,users:i}}function id(e){const{extended:t,stars:n,amount:s,currency:i}=e;return{isExtended:t,stars:n.toJSNumber(),amount:s.toJSNumber(),currency:i}}function od(e){return{amount:e.amount.toJSNumber(),nanos:e.nanos}}function ad(e){const{extended:t,default:n,stars:s,yearlyBoosts:i,amount:o,winners:a,currency:r}=e,d=a?.map((e=>function(e){const{default:t,users:n,perUserStars:s}=e;return{isDefault:t,users:n,perUserStars:s.toJSNumber()}}(e))).filter(Boolean);return{isExtended:t,isDefault:n,yearlyBoosts:i,stars:s.toJSNumber(),amount:o.toJSNumber(),currency:r,winners:d}}function rd(e){return e instanceof fe.jI.StarsTransactionPeerAppStore?{type:"appStore"}:e instanceof fe.jI.StarsTransactionPeerPlayMarket?{type:"playMarket"}:e instanceof fe.jI.StarsTransactionPeerPremiumBot?{type:"premiumBot"}:e instanceof fe.jI.StarsTransactionPeerFragment?{type:"fragment"}:e instanceof fe.jI.StarsTransactionPeerAds?{type:"ads"}:e instanceof fe.jI.StarsTransactionPeerAPI?{type:"api"}:e instanceof fe.jI.StarsTransactionPeer?{type:"peer",id:ms(e.peer)}:{type:"unsupported"}}function dd(e){const{date:t,id:n,peer:s,stars:i,description:o,photo:a,title:r,refund:d,extendedMedia:c,failed:u,msgId:l,pending:f,gift:h,reaction:p,subscriptionPeriod:m,stargift:g,giveawayPostId:I,starrefCommissionPermille:w,stargiftUpgrade:y}=e;a&&io(a);const v=c?.map((e=>Lo(e))).filter(Boolean),b=w?w/10:void 0;return{id:n,date:t,peer:rd(s),stars:od(i),title:r,description:o,photo:a&&ea(a),isRefund:d,hasFailed:u,isPending:f,messageId:l,isGift:h,extendedMedia:v,subscriptionPeriod:m,isReaction:p,starGift:g&&Ho(g),giveawayPostId:I,starRefCommision:b,isGiftUpgrade:y}}function cd(e){const{id:t,peer:n,pricing:s,untilDate:i,canRefulfill:o,canceled:a,chatInviteHash:r,missingBalance:d,botCanceled:c,photo:u,title:l,invoiceSlug:f}=e;return u&&io(u),{id:t,peerId:ms(n),until:i,pricing:yr(s),isCancelled:a,canRefulfill:o,hasMissingBalance:d,chatInviteHash:r,hasBotCancelled:c,title:l,photo:u&&ea(u),invoiceSlug:f}}function ud(e){const{amount:t,currency:n,stars:s,extended:i}=e;return{amount:t.toJSNumber(),currency:n,stars:s.toJSNumber(),isExtended:i}}const ld=new Map,fd=[],hd=(e,t)=>{const n=e.topicId?`${e.chatId}-${e.topicId}`:e.chatId;if(ld.has(n)&&(clearTimeout(ld.get(n)),ld.delete(n)),e.muteUntil===E||e.muteUntil<=An())return;if(fd.push(e),fd.sort(((e,t)=>t.muteUntil-e.muteUntil)),!fd.pop())return;const s=setTimeout((()=>{if(t(),fd.length){const e=fd.pop();e&&hd(e,t)}}),1e3*(e.muteUntil-An()));ld.set(n,s)};function pd(e,t=0,n){hd({chatId:e,muteUntil:t},(()=>n({"@type":"updateNotifyExceptions",chatId:e,isMuted:!1})))}class md{constructor(e,t){this.pts=e,this.ptsCount=t}}class gd{constructor(e,t,n){this.channelId=e,this.pts=t,this.ptsCount=n}}const Id=new Set;function wd(e){if(e instanceof Dt)i=e.timeOffset,Tn=i,zs({"@type":"updateServerTimeOffset",serverTimeOffset:e.timeOffset});else if(e instanceof Et){let t;switch(e.state){case Et.disconnected:t="connectionStateConnecting";break;case Et.broken:t="connectionStateBroken";break;case Et.connected:default:t="connectionStateReady"}zs({"@type":"updateConnectionState",connectionState:t})}else if(e instanceof fe.jI.UpdateNewMessage||e instanceof fe.jI.UpdateNewScheduledMessage||e instanceof fe.jI.UpdateNewChannelMessage||e instanceof fe.jI.UpdateShortChatMessage||e instanceof fe.jI.UpdateShortMessage){let t,n,i;if(e instanceof fe.jI.UpdateShortChatMessage)t=ya(ps((s=e).chatId,"chat"),{...s,fromId:Ii(ps(s.fromId,"user")),peerId:Ii(ps(s.chatId,"chat"))});else if(e instanceof fe.jI.UpdateShortMessage)t=function(e){return ya(ps(e.userId,"user"),{...e,fromId:Ii(e.out?ma:ps(e.userId,"user")),peerId:Ii(e.out?ps(e.userId,"user"):ma)})}(e);else{const s=e.message;if(s instanceof fe.jI.MessageEmpty)return void(d&&console.error("Unexpected update:",e.className,e));Cr(s),t=wa(s),s instanceof fe.jI.Message&&(n=s.media&&Wo(s.media)),i="replyMarkup"in e.message&&e.message?.replyMarkup instanceof fe.jI.ReplyKeyboardForceReply&&(!e.message.replyMarkup.selective||t.isMentioned)}if(e instanceof fe.jI.UpdateNewScheduledMessage?zs({"@type":Id.has(t.id)?"updateScheduledMessage":"newScheduledMessage",id:t.id,chatId:t.chatId,message:t,poll:n}):zs({"@type":!Id.has(t.id)||t.viaBotId||t.content.action?"newMessage":"updateMessage",id:t.id,chatId:t.chatId,message:t,shouldForceReply:i,poll:n}),e.message instanceof fe.jI.MessageService){const{action:n}=e.message;if(n instanceof fe.jI.MessageActionChatEditTitle)zs({"@type":"updateChat",id:t.chatId,chat:{title:n.title}});else if(n instanceof fe.jI.MessageActionChatEditPhoto){const s=n.photo instanceof fe.jI.Photo&&bo(n.photo);if(!s)return;const i=function(e){if(e instanceof fe.jI.PhotoEmpty)return new fe.jI.ChatPhotoEmpty;const{dcId:t,id:n}=e;return new fe.jI.ChatPhoto({dcId:t,photoId:n})}(n.photo),o=js(e.message);qs.chats[o]&&(qs.chats[o].photo=i),Zi(n.photo),zs({"@type":"updateNewProfilePhoto",peerId:t.chatId,photo:s})}else if(n instanceof fe.jI.MessageActionChatDeletePhoto){const n=js(e.message);qs.chats[n]&&(qs.chats[n].photo=new fe.jI.ChatPhotoEmpty),zs({"@type":"updateDeleteProfilePhoto",peerId:t.chatId})}else if(n instanceof fe.jI.MessageActionChatDeleteUser)e._entities&&e._entities.some((e=>e instanceof fe.jI.User&&Boolean(e.self)&&e.id===n.userId))&&zs({"@type":"updateChat",id:t.chatId,chat:{isForbidden:!0,isNotJoined:!0}});else if(n instanceof fe.jI.MessageActionChatAddUser)e._entities&&e._entities.some((e=>e instanceof fe.jI.User&&Boolean(e.self)&&n.users.includes(e.id)))&&zs({"@type":"updateChatJoin",id:t.chatId});else if(n instanceof fe.jI.MessageActionGroupCall)!n.duration&&n.call&&zs({"@type":"updateGroupCallChatId",chatId:t.chatId,call:{id:n.call.id.toString(),accessHash:n.call.accessHash.toString()}});else if(n instanceof fe.jI.MessageActionTopicEdit){const t=e.message.replyTo instanceof fe.jI.MessageReplyHeader?e.message.replyTo:void 0,{replyToMsgId:n,replyToTopId:s,forumTopic:i}=t||{},o=i&&(s||n)||te;zs({"@type":"updateTopic",chatId:ms(e.message.peerId),topicId:o})}else n instanceof fe.jI.MessageActionTopicCreate&&zs({"@type":"updateTopics",chatId:ms(e.message.peerId)})}}else if(e instanceof fe.jI.UpdateQuickReplyMessage){const t=wa(e.message);if(!t)return;zs({"@type":"updateQuickReplyMessage",id:t.id,message:t})}else if(e instanceof fe.jI.UpdateDeleteQuickReplyMessages)zs({"@type":"deleteQuickReplyMessages",quickReplyId:e.shortcutId,messageIds:e.messages});else if(e instanceof fe.jI.UpdateQuickReplies)zs({"@type":"updateQuickReplies",quickReplies:e.quickReplies.map(Ma)});else if(e instanceof fe.jI.UpdateNewQuickReply)zs({"@type":"updateQuickReplies",quickReplies:[Ma(e.quickReply)]});else if(e instanceof fe.jI.UpdateDeleteQuickReply)zs({"@type":"deleteQuickReply",quickReplyId:e.shortcutId});else if(e instanceof fe.jI.UpdateEditMessage||e instanceof fe.jI.UpdateEditChannelMessage){const t=e.message;if(t instanceof fe.jI.MessageEmpty)return void(d&&console.error("Unexpected update:",e.className,e));Cr(t);const n=ui(wa(t),["isOutgoing"]),s=t instanceof fe.jI.Message&&t.media?Wo(t.media):void 0;zs({"@type":"updateMessage",id:n.id,chatId:n.chatId,message:n,poll:s})}else if(e instanceof fe.jI.UpdateMessageReactions)zs({"@type":"updateMessageReactions",id:e.msgId,chatId:ms(e.peer),reactions:na(e.reactions)});else if(e instanceof fe.jI.UpdateMessageExtendedMedia){const t=ms(e.peer),n=e.extendedMedia[0]instanceof fe.jI.MessageExtendedMedia;if(n){const s=ta(e.extendedMedia);if(!s?.length)return;return void zs({"@type":"updateMessageExtendedMedia",id:e.msgId,chatId:t,isBought:n,extendedMedia:s})}const s=n?void 0:e.extendedMedia.filter((e=>e instanceof fe.jI.MessageExtendedMediaPreview)).map((e=>Zo(e))).filter(Boolean);if(!s?.length)return;zs({"@type":"updateMessageExtendedMedia",id:e.msgId,chatId:t,extendedMedia:s})}else if(e instanceof fe.jI.UpdateDeleteMessages)zs({"@type":"deleteMessages",ids:e.messages});else if(e instanceof fe.jI.UpdateDeleteScheduledMessages)zs({"@type":"deleteScheduledMessages",ids:e.messages,newIds:e.sentMessages,chatId:ms(e.peer)});else if(e instanceof fe.jI.UpdateDeleteChannelMessages){const t=ps(e.channelId,"channel");zs({"@type":"deleteMessages",ids:e.messages,chatId:t})}else if(e instanceof fe.jI.UpdateServiceNotification)if(e.popup)zs({"@type":"error",error:{message:e.message}});else{const t=function(e,t){const n=Ia(t),s=qo(e);return{id:n,chatId:J,date:e.inboxDate||t,content:s,isOutgoing:!1}}(e,Date.now()/1e3+kn());Cr(Ti(t.id,t.chatId,e)),zs({"@type":"updateServiceNotification",message:t})}else if(e instanceof fe.jI.UpdateMessageID||e instanceof fe.jI.UpdateShortSentMessage)Id.add(e.id);else if(e instanceof fe.jI.UpdateReadMessagesContents)zs({"@type":"updateCommonBoxMessages",ids:e.messages,messageUpdate:{hasUnreadMention:!1,isMediaUnread:!1}});else if(e instanceof fe.jI.UpdateChannelReadMessagesContents)zs({"@type":"updateChannelMessages",channelId:ps(e.channelId,"channel"),ids:e.messages,messageUpdate:{hasUnreadMention:!1,isMediaUnread:!1}});else if(e instanceof fe.jI.UpdateMessagePoll){const{pollId:t,poll:n,results:s}=e;if(n){const e=Jo(n,s);zs({"@type":"updateMessagePoll",pollId:String(t),pollUpdate:e})}else{const e=Qo(s);zs({"@type":"updateMessagePoll",pollId:String(t),pollUpdate:{results:e}})}}else if(e instanceof fe.jI.UpdateMessagePollVote)zs({"@type":"updateMessagePollVote",pollId:String(e.pollId),peerId:ms(e.peer),options:e.options.map(Ps)});else if(e instanceof fe.jI.UpdateChannelMessageViews)zs({"@type":"updateMessage",chatId:ps(e.channelId,"channel"),id:e.id,message:{viewsCount:e.views}});else if(e instanceof fe.jI.UpdateChannelMessageForwards)zs({"@type":"updateMessage",chatId:ps(e.channelId,"channel"),id:e.id,message:{forwardsCount:e.forwards}});else if(e instanceof fe.jI.UpdateReadHistoryInbox)zs({"@type":"updateChatInbox",id:ms(e.peer),chat:{lastReadInboxMessageId:e.maxId,unreadCount:e.stillUnreadCount}});else if(e instanceof fe.jI.UpdateReadHistoryOutbox)zs({"@type":"updateChat",id:ms(e.peer),chat:{lastReadOutboxMessageId:e.maxId}});else if(e instanceof fe.jI.UpdateReadChannelInbox)zs({"@type":"updateChat",id:ps(e.channelId,"channel"),chat:{lastReadInboxMessageId:e.maxId,unreadCount:e.stillUnreadCount}});else if(e instanceof fe.jI.UpdateReadChannelOutbox)zs({"@type":"updateChat",id:ps(e.channelId,"channel"),chat:{lastReadOutboxMessageId:e.maxId}});else if(e instanceof fe.jI.UpdateReadChannelDiscussionInbox)zs({"@type":"updateThreadInfo",threadInfo:{chatId:ps(e.channelId,"channel"),threadId:e.topMsgId,lastReadInboxMessageId:e.readMaxId}});else if(e instanceof fe.jI.UpdateReadChannelDiscussionOutbox)zs({"@type":"updateChat",id:ps(e.channelId,"channel"),chat:{lastReadOutboxMessageId:e.readMaxId}});else if(e instanceof fe.jI.UpdateDialogPinned&&e.peer instanceof fe.jI.DialogPeer)zs({"@type":"updateChatPinned",id:ms(e.peer.peer),isPinned:e.pinned||!1});else if(e instanceof fe.jI.UpdatePinnedDialogs)zs({"@type":"updatePinnedChatIds",ids:e.order?e.order.filter((e=>e instanceof fe.jI.DialogPeer)).map((e=>ms(e.peer))):[],folderId:e.folderId||void 0});else if(e instanceof fe.jI.UpdateSavedDialogPinned&&e.peer instanceof fe.jI.DialogPeer)zs({"@type":"updateSavedDialogPinned",id:ms(e.peer.peer),isPinned:e.pinned||!1});else if(e instanceof fe.jI.UpdatePinnedSavedDialogs)zs({"@type":"updatePinnedSavedDialogIds",ids:e.order?e.order.filter((e=>e instanceof fe.jI.DialogPeer)).map((e=>ms(e.peer))):[]});else if(e instanceof fe.jI.UpdateFolderPeers)e.folderPeers.forEach((e=>{const{folderId:t,peer:n}=e;zs({"@type":"updateChatListType",id:ms(n),folderId:t})}));else if(e instanceof fe.jI.UpdateDialogFilter){const{id:t,filter:n}=e;zs({"@type":"updateChatFolder",id:t,folder:Cs(n)?dr(n):void 0})}else if(e instanceof fe.jI.UpdateDialogFilterOrder)zs({"@type":"updateChatFoldersOrder",orderedIds:e.order});else if(e instanceof fe.jI.UpdateChatParticipants){const t=ar(e.participants);zs({"@type":"updateChatMembers",id:ps(e.participants.chatId,"chat"),replacedMembers:t})}else if(e instanceof fe.jI.UpdateChatParticipantAdd){const t=or(di(e,["userId","inviterId","date"]));zs({"@type":"updateChatMembers",id:ps(e.chatId,"chat"),addedMember:t})}else if(e instanceof fe.jI.UpdateChatParticipantDelete)zs({"@type":"updateChatMembers",id:ps(e.chatId,"chat"),deletedMemberId:ps(e.userId,"user")});else if(e instanceof fe.jI.UpdatePinnedMessages||e instanceof fe.jI.UpdatePinnedChannelMessages)zs({"@type":"updatePinnedIds",chatId:e instanceof fe.jI.UpdatePinnedMessages?ms(e.peer):ps(e.channelId,"channel"),messageIds:e.messages,isPinned:e.pinned});else if(e instanceof fe.jI.UpdateNotifySettings&&e.peer instanceof fe.jI.NotifyPeer){const t=kr(e.notifySettings,e.peer.peer);pd(t.chatId,t.muteUntil,zs),zs({"@type":"updateNotifyExceptions",...t})}else if(e instanceof fe.jI.UpdateNotifySettings&&e.peer instanceof fe.jI.NotifyForumTopic){const t=function(e,t,n){const{silent:s,muteUntil:i,showPreviews:o,otherSound:a}=e,r=Boolean(a&&!(a instanceof fe.jI.NotificationSoundNone));return{chatId:ms(t),topicId:n,isMuted:s||"number"==typeof i&&An()<i,...!r&&{isSilent:!0},...void 0!==o&&{shouldShowPreviews:Boolean(o)},muteUntil:i}}(e.notifySettings,e.peer.peer,e.peer.topMsgId);!function(e,t,n=0,s){hd({chatId:e,topicId:t,muteUntil:n},(()=>s({"@type":"updateTopicNotifyExceptions",chatId:e,topicId:t,isMuted:!1})))}(t.chatId,t.topicId,t.muteUntil,zs),zs({"@type":"updateTopicNotifyExceptions",...t})}else if(e instanceof fe.jI.UpdateUserTyping||e instanceof fe.jI.UpdateChatUserTyping){const t=e instanceof fe.jI.UpdateUserTyping?ps(e.userId,"user"):ps(e.chatId,"chat");e.action instanceof fe.jI.SendMessageEmojiInteraction?zs({"@type":"updateStartEmojiInteraction",id:t,emoji:e.action.emoticon,messageId:e.action.msgId,interaction:(n=JSON.parse(e.action.interaction.data),{timestamps:n.a.map((({t:e})=>e))})}):zs({"@type":"updateChatTypingStatus",id:t,typingStatus:rr(e)})}else if(e instanceof fe.jI.UpdateChannelUserTyping)zs({"@type":"updateChatTypingStatus",id:ps(e.channelId,"channel"),threadId:e.topMsgId,typingStatus:rr(e)});else if(e instanceof fe.jI.UpdateChannel){const{_entities:t}=e;if(!t)return;const n=t.find((e=>e instanceof fe.jI.Channel||e instanceof fe.jI.ChannelForbidden));if(n instanceof fe.jI.Channel){const t=er(n);t&&(zs({"@type":"updateChat",id:t.id,chat:t}),zs({"@type":t.isNotJoined?"updateChatLeave":"updateChatJoin",id:ps(e.channelId,"channel")}))}else if(n instanceof fe.jI.ChannelForbidden){const t=ps(e.channelId,"channel");zs({"@type":"updateChat",id:t,chat:{isRestricted:!0}}),zs({"@type":"updateChatLeave",id:t})}else 0===t.length&&zs({"@type":"resetMessages",id:ps(e.channelId,"channel")})}else if(e instanceof fe.jI.UpdateDialogUnreadMark&&e.peer instanceof fe.jI.DialogPeer)zs({"@type":"updateChat",id:ms(e.peer.peer),chat:{hasUnreadMark:e.unread}});else if(e instanceof fe.jI.UpdateChatDefaultBannedRights)zs({"@type":"updateChat",id:ms(e.peer),chat:{defaultBannedRights:Es(e.defaultBannedRights)}});else if(e instanceof fe.jI.UpdateUserStatus)zs({"@type":"updateUserStatus",userId:ps(e.userId,"user"),status:$a(e.status)});else if(e instanceof fe.jI.UpdateUser)zs({"@type":"updateRequestUserUpdate",id:ps(e.userId,"user")});else if(e instanceof fe.jI.UpdateUserEmojiStatus){const t=Is(e.emojiStatus);zs({"@type":"updateUserEmojiStatus",userId:ps(e.userId,"user"),emojiStatus:t})}else if(e instanceof fe.jI.UpdateUserName){const t=ps(e.userId,"user"),n=qs.users[t];zs({"@type":"updateUser",id:t,user:{...n?.mutualContact&&!n.self?di(e,[]):di(e,["firstName","lastName"]),usernames:Po(e)}})}else if(e instanceof fe.jI.UpdateUserPhone){const{userId:t,phone:n}=e;zs({"@type":"updateUser",id:ps(t,"user"),user:{phoneNumber:n}})}else if(e instanceof fe.jI.UpdatePeerSettings){const{_entities:t,settings:n}=e;if(!t)return;t?.length&&(t.filter((e=>e instanceof fe.jI.User&&!e.contact)).forEach((e=>{zs({"@type":"deleteContact",id:ps(e.id,"user")})})),t.filter((e=>e instanceof fe.jI.User&&e.contact)).map(Va).forEach((e=>{e&&zs({"@type":"updateUser",id:e.id,user:{...e,...n&&{settings:fr(n)}}})})))}else if(e instanceof fe.jI.UpdateNotifySettings){const{notifySettings:{showPreviews:t,silent:n,muteUntil:s},peer:{className:i}}=e,o="NotifyUsers"===i?"contact":"NotifyChats"===i?"group":"NotifyBroadcasts"===i?"broadcast":void 0;if(!o)return;zs({"@type":"updateNotifySettings",peerType:o,isSilent:Boolean(n||"number"==typeof s&&Date.now()+1e3*kn()<1e3*s),shouldShowPreviews:Boolean(t)})}else if(e instanceof fe.jI.UpdatePeerBlocked)zs({"@type":"updatePeerBlocked",id:ms(e.peerId),isBlocked:e.blocked,isBlockedFromStories:e.blockedMyStoriesFrom});else if(e instanceof fe.jI.UpdatePrivacy){const t=function(e){switch(e.className){case"PrivacyKeyPhoneNumber":return"phoneNumber";case"PrivacyKeyAddedByPhone":return"addByPhone";case"PrivacyKeyStatusTimestamp":return"lastSeen";case"PrivacyKeyProfilePhoto":return"profilePhoto";case"PrivacyKeyPhoneCall":return"phoneCall";case"PrivacyKeyPhoneP2P":return"phoneP2P";case"PrivacyKeyForwards":return"forwards";case"PrivacyKeyVoiceMessages":return"voiceMessages";case"PrivacyKeyChatInvite":return"chatInvite";case"PrivacyKeyAbout":return"bio";case"PrivacyKeyBirthday":return"birthday";case"PrivacyKeyStarGiftsAutoSave":return"gifts"}}(e.key);t&&zs({"@type":"updatePrivacy",key:t,rules:_o(e.rules)})}else if(e instanceof fe.jI.UpdateDraftMessage)zs({"@type":"draftMessage",chatId:ms(e.peer),threadId:e.topMsgId,draft:va(e.draft)});else if(e instanceof fe.jI.UpdateContactsReset)zs({"@type":"updateResetContactList"});else if(e instanceof fe.jI.UpdateFavedStickers)zs({"@type":"updateFavoriteStickers"});else if(e instanceof fe.jI.UpdateRecentStickers)zs({"@type":"updateRecentStickers"});else if(e instanceof fe.jI.UpdateRecentReactions)zs({"@type":"updateRecentReactions"});else if(e instanceof fe.jI.UpdateSavedReactionTags)zs({"@type":"updateSavedReactionTags"});else if(e instanceof fe.jI.UpdateMoveStickerSetToTop)e.masks||zs({"@type":"updateMoveStickerSetToTop",isCustomEmoji:e.emojis,id:e.stickerset.toString()});else if(e instanceof fe.jI.UpdateStickerSets)zs({"@type":"updateStickerSets"});else if(e instanceof fe.jI.UpdateStickerSetsOrder)e.masks||zs({"@type":"updateStickerSetsOrder",order:e.order.map((e=>e.toString())),isCustomEmoji:e.emojis});else if(e instanceof fe.jI.UpdateNewStickerSet){if(e.stickerset instanceof fe.jI.messages.StickerSet){const t=Uo(e.stickerset.set);zs({"@type":"updateStickerSet",id:t.id,stickerSet:t})}}else if(e instanceof fe.jI.UpdateSavedGifs)zs({"@type":"updateSavedGifs"});else if(e instanceof fe.jI.UpdateGroupCall)zs({"@type":"updateGroupCall",call:co(e.call)});else if(e instanceof fe.jI.UpdateGroupCallConnection)zs({"@type":"updateGroupCallConnection",data:JSON.parse(e.params.data),presentation:Boolean(e.presentation)});else if(e instanceof fe.jI.UpdateGroupCallParticipants)zs({"@type":"updateGroupCallParticipants",groupCallId:(t=e.call,t.id.toString()),participants:e.participants.map(oo)});else if(e instanceof fe.jI.UpdatePendingJoinRequests)zs({"@type":"updatePendingJoinRequests",chatId:ms(e.peer),recentRequesterIds:e.recentRequesters.map((e=>ps(e,"user"))),requestsPending:e.requestsPending});else if(e instanceof fe.jI.UpdatePhoneCall)zs({"@type":"updatePhoneCall",call:uo(e.phoneCall)});else if(e instanceof fe.jI.UpdatePhoneCallSignalingData)zs({"@type":"updatePhoneCallSignalingData",callId:e.phoneCallId.toString(),data:Array.from(e.data)});else if(e instanceof fe.jI.UpdateWebViewResultSent){const{queryId:t}=e;zs({"@type":"updateWebViewResultSent",queryId:t.toString()})}else if(e instanceof fe.jI.UpdateBotMenuButton){const{botId:t,button:n}=e;zs({"@type":"updateBotMenuButton",botId:ps(t,"user"),button:Oa(n)})}else if(e instanceof fe.jI.UpdateTranscribedAudio)zs({"@type":"updateTranscribedAudio",transcriptionId:e.transcriptionId.toString(),text:e.text,isPending:e.pending});else if(e instanceof fe.jI.UpdateConfig)zs({"@type":"updateConfig"});else if(e instanceof fe.jI.UpdateChannelPinnedTopic)zs({"@type":"updatePinnedTopic",chatId:ps(e.channelId,"channel"),topicId:e.topicId,isPinned:Boolean(e.pinned)});else if(e instanceof fe.jI.UpdateChannelPinnedTopics)zs({"@type":"updatePinnedTopicsOrder",chatId:ps(e.channelId,"channel"),order:e.order||[]});else if(e instanceof fe.jI.UpdateRecentEmojiStatuses)zs({"@type":"updateRecentEmojiStatuses"});else if(e instanceof fe.jI.UpdateStory){const{story:t}=e,n=ms(e.peer),s=ka(n,t);Xi(t,n),t instanceof fe.jI.StoryItemDeleted?zs({"@type":"deleteStory",peerId:n,storyId:t.id}):zs({"@type":"updateStory",peerId:n,story:s})}else if(e instanceof fe.jI.UpdateReadStories)zs({"@type":"updateReadStories",peerId:ms(e.peer),lastReadId:e.maxId});else if(e instanceof fe.jI.UpdateSentStoryReaction){const t=ra(e.reaction);zs({"@type":"updateSentStoryReaction",peerId:ms(e.peer),storyId:e.storyId,reaction:t})}else if(e instanceof fe.jI.UpdateStoriesStealthMode)zs({"@type":"updateStealthMode",stealthMode:Ea(e.stealthMode)});else if(e instanceof fe.jI.UpdateAttachMenuBots)zs({"@type":"updateAttachMenuBots"});else if(e instanceof fe.jI.UpdateNewAuthorization)zs({"@type":"updateNewAuthorization",hash:e.hash.toString(),date:e.date,device:e.device,location:e.location,isUnconfirmed:e.unconfirmed});else if(e instanceof fe.jI.UpdateChannelViewForumAsMessages)zs({"@type":"updateViewForumAsMessages",chatId:ps(e.channelId,"channel"),isEnabled:!!e.enabled||void 0});else if(e instanceof fe.jI.UpdateStarsBalance)zs({"@type":"updateStarsBalance",balance:od(e.balance)});else if(e instanceof fe.jI.UpdatePaidReactionPrivacy)zs({"@type":"updatePaidReactionPrivacy",isPrivate:e.private});else if(e instanceof fe.jI.UpdateLangPackTooLong)zs({"@type":"updateLangPackTooLong",langCode:e.langCode});else if(e instanceof fe.jI.UpdateLangPack){const{strings:t,keysToRemove:n}=Ur(e.difference.strings);zs({"@type":"updateLangPack",version:e.difference.version,strings:t,keysToRemove:n})}else e instanceof On?zs({"@type":"updatePremiumFloodWait",isUpload:e.isUpload}):e instanceof md||e instanceof gd||d&&Ms("UNEXPECTED UPDATE","object"==typeof e&&"className"in e?e.className:e);var t,n,s,i}const yd="0",vd=1e3,bd=500;let Sd,jd,Cd=!1;const Pd=new Map,_d=new Pr((function(e,t){return("seqStart"in e?e.seqStart:e.seq)-("seqStart"in t?t.seqStart:t.seq)})),Md=new Map;function Td(e){qs.commonBoxState.seq=e.seq,qs.commonBoxState.date=e.date,qs.commonBoxState.pts=e.pts,qs.commonBoxState.qts=e.qts}function kd(e,t,n){if(e instanceof Et)return e.state===Et.connected&&Cd&&xd(),void wd(e);if(e instanceof Dt)wd(e);else if(void 0!==qs.commonBoxState.seq)return e instanceof fe.jI.Updates||e instanceof fe.jI.UpdatesCombined?(t&&(e._isFromDifference=!0),void function(e,t){_d.add(e),t||Ed()}(e,n)):"pts"in e?e instanceof fe.jI.UpdateChannelTooLong?void Hd(Nd(e)):(t&&(e._isFromDifference=!0),void function(e,t){const n=Nd(e),s=Md.get(n)||new Pr(Vd);s.add(e),Md.set(n,s),t||Dd(n)}(e,n)):void wd(e)}function Ad(e,t){if(!(qs.chats[e]instanceof fe.jI.Channel))return void(d&&console.error(`[UpdateManager] Channel ${e} not found in localDb`));const n=qs.channelPtsById[e];n&&n<t?Ud(e):qs.channelPtsById[e]=t}function Rd(e){if("seq"in e&&e.seq&&(qs.commonBoxState.seq=e.seq,qs.commonBoxState.date=e.date),"qts"in e&&(qs.commonBoxState.qts=e.qts),"pts"in e){const t=Nd(e);t!==yd?qs.channelPtsById[t]=e.pts:qs.commonBoxState.pts=e.pts}if(e instanceof fe.jI.UpdatesCombined||e instanceof fe.jI.Updates){jr(e);const t=e.users.concat(e.chats);e.updates.forEach((e=>{t&&(e._entities=t),kd(e)}))}else wd(e)}function Ed(){if(!_d.size)return;const e=_d.pop(),t=qs.commonBoxState.seq,n="seqStart"in e?e.seqStart:e.seq;if(0===n||e._isFromDifference&&n>=t+1)Rd(e);else if(n===t+1)clearTimeout(jd),jd=void 0,Rd(e);else if(n>t+1)return _d.add(e),void xd();Ed()}function Dd(e){const t=Md.get(e);if(!t?.size)return;const n=t.pop(),s=e===yd?qs.commonBoxState.pts:qs.channelPtsById[e],i=n.pts,o=zd(n);if(void 0!==s){if(n._isFromDifference&&i>=s+o)Rd(n);else if(i===s+o)clearTimeout(Pd.get(e)),Pd.delete(e),Rd(n);else if(i>s+o)return t.add(n),void(e===yd?xd():Ud(e));Dd(e)}}function Ud(e){if(Pd.has(e))return;const t=setTimeout((async()=>{await Hd(e),Pd.delete(e)}),bd);Pd.set(e,t)}function xd(){jd||(jd=setTimeout((async()=>{await Bd(),jd=void 0}),bd))}function Nd(e){return"channelId"in e&&"pts"in e?ps(e.channelId,"channel"):e instanceof fe.jI.UpdateNewChannelMessage||e instanceof fe.jI.UpdateEditChannelMessage?ps(e.message.peerId.channelId,"channel"):yd}async function Bd(){if(!Cd)throw new Error("UpdatesManager not initialized");if(!qs.commonBoxState?.date)return void Gd();zs({"@type":"updateFetchingDifference",isFetching:!0});const e=await Sd(new fe.jI.updates.GetDifference({pts:qs.commonBoxState.pts,date:qs.commonBoxState.date,qts:qs.commonBoxState.qts}));if(!e||e instanceof fe.jI.updates.DifferenceTooLong)Gd();else{if(e instanceof fe.jI.updates.DifferenceEmpty)return qs.commonBoxState.seq=e.seq,qs.commonBoxState.date=e.date,void zs({"@type":"updateFetchingDifference",isFetching:!1});Ld(e),Td(e instanceof fe.jI.updates.DifferenceSlice?e.intermediateState:e.state),e instanceof fe.jI.updates.DifferenceSlice?Bd():zs({"@type":"updateFetchingDifference",isFetching:!1})}}async function Hd(e){const t=qs.chats[e];if(!(t&&t instanceof fe.jI.Channel&&t.accessHash&&qs.channelPtsById[e]))return void(d&&console.error("[UpdateManager] Channel for difference not found",e,t));const n=await Sd(new fe.jI.updates.GetChannelDifference({channel:vi(e,t.accessHash.toString()),pts:qs.channelPtsById[e],filter:new fe.jI.ChannelMessagesFilterEmpty,limit:vd}));n?n instanceof fe.jI.updates.ChannelDifferenceTooLong?Gd():(qs.channelPtsById[e]=n.pts,n instanceof fe.jI.updates.ChannelDifferenceEmpty?Dd(e):(Ld(n,e),n.final||Hd(e))):d&&console.warn("[UpdatesManager] Failed to get ChannelDifference",e,t)}function Gd(){Od(),zs({"@type":"requestSync"}),Fd()}function Od(){Md.clear(),_d.clear(),clearTimeout(jd),jd=void 0,Pd.forEach((e=>{clearTimeout(e)})),Pd.clear(),qs.commonBoxState={},Object.keys(qs.channelPtsById).forEach((e=>{qs.channelPtsById[e]=0})),Cd=!1}function qd(e,t){const n="chatTypeChannel"===e.type||"chatTypeSuperGroup"===e.type?Hi(e.id,"channel"):void 0;var s,i,o;kd((s=t.pts,i=t.ptsCount,(o=n)?new gd(o,s,i):new md(s,i)))}async function Fd(){const e=await Sd(new fe.jI.updates.GetState);e&&(Td(e),Cd=!0)}function Ld(e,t){e.newMessages.forEach((e=>{wd(new fe.jI.UpdateNewMessage({message:e,pts:0,ptsCount:0}))})),jr(e);const n=new Set;e.otherUpdates.forEach((e=>{const t=Nd(e);e instanceof fe.jI.UpdateChannelTooLong&&n.add(Nd(e));const s=!n.has(t);kd(e,s,!s)})),t?Dd(t):Ed()}function zd(e){return"ptsCount"in e?e.ptsCount:0}function Vd(e,t){const n=e.pts-t.pts;return 0!==n?n:zd(t)-zd(e)}const $d={};function Wd(){zs({"@type":"updateWebAuthTokenFailed"})}function Kd(){return zs(ec("authorizationStateWaitPhoneNumber")),new Promise(((e,t)=>{$d.resolve=e,$d.reject=t}))}function Jd(e=!1){return zs({...ec("authorizationStateWaitCode"),isCodeViaApp:e}),new Promise(((e,t)=>{$d.resolve=e,$d.reject=t}))}function Qd(e,t){return zs({...ec("authorizationStateWaitPassword"),hint:e,noReset:t}),new Promise((e=>{$d.resolve=e}))}function Yd(){return zs(ec("authorizationStateWaitRegistration")),new Promise((e=>{$d.resolve=e}))}function Xd(e){return zs({...ec("authorizationStateWaitQrCode"),qrCode:{token:btoa(String.fromCharCode(...e.token)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""),expires:e.expires}}),new Promise(((e,t)=>{$d.reject=t}))}function Zd(e){const{messageKey:t}=ks(e);zs({"@type":"updateAuthorizationError",errorKey:t})}function ec(e){return{"@type":"updateAuthorizationState",authorizationState:e}}function tc(e){$d.resolve&&$d.resolve(e)}function nc(e){$d.resolve&&$d.resolve(e)}function sc(e){$d.resolve&&$d.resolve(e)}function ic(e){const{firstName:t,lastName:n}=e;$d.resolve&&$d.resolve([t,n])}function oc(){$d.reject&&$d.reject(new Error("RESTART_AUTH"))}function ac(){$d.reject&&$d.reject(new Error("RESTART_AUTH_WITH_QR"))}const rc=self.caches;let dc;async function cc(){return!!rc&&(dc=dc??await rc.has("test").then((()=>!0)).catch((()=>!1)),dc)}let uc=function(e){return e[e.Text=0]="Text",e[e.Blob=1]="Blob",e[e.Json=2]="Json",e[e.ArrayBuffer=3]="ArrayBuffer",e}({});async function lc(e,t,n,s=!1){if(rc)try{const i=r?`${c}/${t.replace(/:/g,"_")}`:new Request(t.replace(/:/g,"_")),o=await rc.open(e),a=await o.match(i);if(!a)return;const d=a.headers.get("Content-Type");switch(n){case uc.Text:return await a.text();case uc.Blob:{if(t.startsWith("avatar")&&d&&d.startsWith("text"))return;const e=await a.blob(),n=!e.type||!s&&e.type.includes("html");let i=e.type||d;return n&&i?(s||(i=i.replace(/html/gi,"")),new Blob([e],{type:i})):e}case uc.Json:return await a.json();case uc.ArrayBuffer:return await a.arrayBuffer();default:return}}catch(e){return void console.warn(e)}}async function fc(e,t,n){if(!rc)return!1;try{const s="string"==typeof n||n instanceof Blob||n instanceof ArrayBuffer?n:JSON.stringify(n),i=r?`${c}/${t.replace(/:/g,"_")}`:new Request(t.replace(/:/g,"_")),o=new Response(s),a=await rc.open(e);return await a.put(i,o),!0}catch(e){return console.warn(e),!1}}async function hc(e,t){try{if(!rc)return;const n=await rc.open(e);return await n.delete(t)}catch(e){return void console.warn(e)}}async function pc(e){try{if(!rc)return;return await rc.delete(e)}catch(e){return void console.warn(e)}}const mc=new Set(["sticker","wallpaper","photo","webDocument","document"]),gc=new Set(["s","m","x","y","w","a","b","c","d"]),Ic=new Set(["u","v"]);async function wc({url:e,mediaFormat:t,start:n,end:i,isHtmlAllowed:o},a,r){const{data:d,mimeType:c,fullSize:m}=await async function(e,t,n,s,i,o){const a=vc(e);if(!a)return;const{entityType:r,entityId:d,sizeType:c,params:u,mediaMatchType:l}=a;if("staticMap"===r){const e=vt()(d),n=new URLSearchParams(u),s=Number(n.get("long")),i=Number(n.get("lat")),o=Number(n.get("w")),a=Number(n.get("h")),r=Number(n.get("zoom")),c=Number(n.get("scale")),l=n.get("accuracy_radius"),f=l?Number(l):void 0;return{mimeType:"image/png",data:await t.downloadStaticMap(e,s,i,o,a,r,c,f)}}let f;switch(r){case"channel":case"chat":f=qs.chats[d];break;case"user":f=qs.users[d];break;case"sticker":case"wallpaper":case"document":f=qs.documents[d];break;case"photo":f=qs.photos[d];break;case"stickerSet":f=qs.stickerSets[d];break;case"webDocument":f=qs.webDocuments[d]}if(f){if(mc.has(r)){const e=await t.downloadMedia(f,{sizeType:c,start:s,end:i,progressCallback:n,workers:p});let a,r;return c&&gc.has(c)?a="image/jpeg":c&&Ic.has(c)?a="video/mp4":f instanceof fe.jI.Photo?a="image/jpeg":f instanceof fe.jI.WebDocument?(a=f.mimeType,r=f.size):f instanceof fe.jI.Document&&(a=f.mimeType,r=f.size.toJSNumber()),!o&&a&&(a=a.replace(/html/gi,"")),{mimeType:a,data:e,fullSize:r}}if("stickerSet"===r){const e=await t.downloadStickerSetThumb(f);return{mimeType:e&&yc(e),data:e}}{const e=await t.downloadProfilePhoto(f,"profile"===l);return{mimeType:e&&yc(e),data:e}}}}(e,a,r,n,i,o)||{};if(!d)return;const g=await async function(e,t,n){if(e instanceof File)return e;switch(t){case Zs.BlobUrl:return new Blob([e],{type:n});case Zs.Text:return e.toString();case Zs.Progressive:case Zs.DownloadUrl:return e.buffer}}(d,t,c);if(!g)return;const I=t!==Zs.Progressive&&(t!==Zs.BlobUrl||g.size<=h);return!u&&s&&I&&fc(e.startsWith("avatar")?f:l,e,g),{dataBlob:t===Zs.Progressive?"":g,arrayBuffer:t===Zs.Progressive?g:void 0,mimeType:c,fullSize:m}}function yc(e,t="image/jpeg"){if(e.length<4)return t;let n=t;switch(e.subarray(0,4).reduce(((e,t)=>e+t.toString(16)),"")){case"89504e47":n="image/png";break;case"47494638":n="image/gif";break;case"ffd8ffe0":case"ffd8ffe1":case"ffd8ffe2":case"ffd8ffe3":case"ffd8ffe8":n="image/jpeg";break;case"52494646":n="image/webp"}return n}function vc(e){const t=e.startsWith("staticMap")?e.match(/(staticMap):([0-9-]+)(\?.+)/):e.startsWith("webDocument")?e.match(/(webDocument):(.+)/):e.match(/(avatar|profile|photo|stickerSet|sticker|wallpaper|document)([-\d\w./]+)(?::\d+)?(\?size=\w+)?/);if(!t)return;const n=t[1],s=t[2];let i;const o=t[3],a=o?.replace("?size=","")||void 0;return i="avatar"===t[1]||"profile"===t[1]?gi(s):t[1],{mediaMatchType:n,entityType:i,entityId:s,sizeType:a,params:o}}class bc extends AbortController{constructor(...e){var t,n,s,i;super(...e),t=this,n="threads",s=new Map,(n="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n))?i:i+"")in t?Object.defineProperty(t,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[n]=s}getThreadSignal(e){let t=this.threads.get(e);return t||(t=new AbortController,this.threads.set(e,t)),t.signal}abortThread(e,t){this.threads.get(e)?.abort(t),this.threads.delete(e)}abort(e){super.abort(e),this.threads.forEach((t=>t.abort(e))),this.threads.clear()}}const Sc="Unknown UserAgent",jc="Unknown platform";st.setLevel("warn");const Cc={build:e=>e},Pc=new Map,_c=new Map;let Mc,Tc;function kc({isPremium:e}){Mc.setIsPremium(e)}const Ac=2500;async function Rc(e=!1,t=!1){!e&&Mc.isConnected()&&await Promise.race([xc(new fe.jI.auth.LogOut),ce(Ac)]),t||(Object.assign(Os,Gs()),Od()),await Mc.destroy()}async function Ec(){await Mc.disconnect()}function Dc(e){zs({"@type":"updateSession",sessionData:e})}function Uc(e){kd(e),e instanceof fe.jI.UpdatesTooLong?async function(){try{await xc(new fe.jI.users.GetFullUser({id:new fe.jI.InputUserSelf}),{shouldThrow:!0})}catch(e){"AUTH_KEY_UNREGISTERED"!==e.errorMessage&&"SESSION_REVOKED"!==e.errorMessage||zs({"@type":"updateConnectionState",connectionState:"connectionStateBroken"})}}():("updates"in e?e.updates:[e]).forEach((e=>{if(!(e instanceof fe.jI.UpdateConfig))return;const t=e._entities?.find((e=>e instanceof fe.jI.User&&ps(e.id,"user")===Tc));t instanceof fe.jI.User&&kc({isPremium:Boolean(t.premium)})}))}async function xc(e,t={}){const{shouldThrow:n,shouldIgnoreUpdates:s,dcId:i,shouldIgnoreErrors:o,abortControllerChatId:a,abortControllerThreadId:r,shouldRetryOnTimeout:c,abortControllerGroup:u}=t,l=Boolean(t.shouldReturnTrue);let f;if(a){let e=Pc.get(a);e||(e=new bc,Pc.set(a,e)),f=r?e.getThreadSignal(r):e.signal}if(u){let e=_c.get(u);e||(e=new AbortController,_c.set(u,e)),f=e.signal}try{d&&Ms("INVOKE",e.className);const t=await Mc.invoke(e,i,f,c);return jr(t),d&&Ms("RESPONSE",e.className,t),!s&&function(e){return e instanceof fe.jI.UpdatesTooLong||e instanceof fe.jI.UpdateShortMessage||e instanceof fe.jI.UpdateShortChatMessage||e instanceof fe.jI.UpdateShort||e instanceof fe.jI.UpdatesCombined||e instanceof fe.jI.Updates||e instanceof fe.jI.UpdateShortSentMessage}(t)&&kd(t),l?t&&!0:t}catch(t){if(o)return;if(d&&(Ms("INVOKE ERROR",e.className),console.debug("invokeRequest failed with payload",e),console.error(t)),n)throw t;return void function(e,t){const n=e instanceof pe?e.errorMessage:e.message;zs({"@type":"error",error:{message:n,isSlowMode:"FLOOD"===n&&(t instanceof fe.jI.messages.SendMessage||t instanceof fe.jI.messages.SendMedia||t instanceof fe.jI.messages.SendMultiMedia),hasErrorKey:!0}})}(t,e)}}function Nc(e,t){d&&Ms("BEACON",e.className),Mc.invokeBeacon(e,t)}async function Bc(e,t){try{return await wc(e,Mc,t)}catch(n){if(n instanceof pe){if(n.errorMessage.startsWith("FILE_REFERENCE")){if(await Lc({url:e.url}))return wc(e,Mc,t);d&&console.error("Failed to repair file reference",e.url)}if("FILE_ID_INVALID"===n.errorMessage&&e.url.includes("avatar"))return void(d&&console.warn("Inaccessible avatar image",e.url))}throw d&&console.error("Failed to download media",e.url,n),n}}function Hc(e,t){return Mc.uploadFile({file:e,onProgress:t,workers:m})}function Gc(e){return Mc.updateTwoFaSettings(e)}function Oc(e){const{chatId:t,threadId:n}=e,s=Pc.get(t);if(!n)return s?.abort("Chat change"),void Pc.delete(t);s?.abortThread(n,"Thread change")}function qc(e){_c.get(e)?.abort(),_c.delete(e)}async function Fc(){const e=await xc(new fe.jI.users.GetFullUser({id:new fe.jI.InputUserSelf}));if(!(e&&e.users[0]instanceof fe.jI.User))return;const t=e.users[0];so(t);const n=za(e),s=Va(t);var i;i=s.id,ma=i,function(e,t){zs({"@type":"updateCurrentUser",currentUser:e,currentUserFullInfo:t})}(s,n),Tc=s.id,kc({isPremium:Boolean(s.isPremium)})}async function Lc({url:e}){const t=vc(e);if(!t)return;const{entityId:n,mediaMatchType:s}=t;if("document"===s||"photo"===s||"webDocument"===s){const e="document"===s?qs.documents[n]:"webDocument"===s?qs.webDocuments[n]:qs.photos[n];if(!e)return!1;const t=e;if(!t.localRepairInfo)return!1;const{localRepairInfo:i}=t;if("story"===i.type)return await async function(e,t){const n=yi(e);if(!n)return!1;const s=await xc(new fe.jI.stories.GetStoriesByID({peer:n,id:[t]}),{shouldIgnoreErrors:!0});return!!s&&(s.stories.forEach((t=>{const n=ka(e,t);n&&!("isDeleted"in n)&&(Xi(t,e),zs({"@type":"updateStory",peerId:e,story:n}))})),!0)}(i.peerId,i.id);if("message"===i.type)return await async function(e,t){const n=gi(e),s=yi(e);if(!s)return!1;const i=await xc("channel"===n?new fe.jI.channels.GetMessages({channel:s,id:[new fe.jI.InputMessageID({id:t})]}):new fe.jI.messages.GetMessages({id:[new fe.jI.InputMessageID({id:t})]}),{shouldIgnoreErrors:!0});if(!i||i instanceof fe.jI.messages.MessagesNotModified)return!1;s&&"pts"in i&&Ad(e,i.pts);const o=i.messages[0];if(o instanceof fe.jI.MessageEmpty)return!1;Cr(o);const a=wa(o);return a&&zs({"@type":"updateMessage",chatId:a.chatId,id:a.id,message:a}),!0}(i.peerId,i.id)}return!1}function zc(e){Mc.setForceHttpTransport(e)}function Vc(e){Mc.setAllowHttpTransport(e)}function $c(e){Mc.setShouldDebugExportedSenders(e)}function Wc(e){Ud(e)}async function Kc({peer:e,reason:t,description:n}){return await xc(new fe.jI.account.ReportPeer({peer:wi(e.id,e.accessHash),reason:Ni(t),message:n}))}async function Jc({peer:e,photo:t,reason:n,description:s}){const i=Ai(t);if(i)return await xc(new fe.jI.account.ReportProfilePhoto({peer:wi(e.id,e.accessHash),photoId:i,reason:Ni(n),message:s}))}async function Qc({hash:e,areCallsEnabled:t,areSecretChatsEnabled:n,isConfirmed:s}){return await xc(new fe.jI.account.ChangeAuthorizationSettings({hash:vt()(e),...void 0!==t?{callRequestsDisabled:!t}:void 0,...void 0!==n?{encryptedRequestsDisabled:!n}:void 0,...s&&{confirmed:s}}))}async function Yc({days:e}){return await xc(new fe.jI.account.SetAuthorizationTTL({authorizationTtlDays:e}))}async function Xc({slug:e}){const t=await xc(new fe.jI.account.ResolveBusinessChatLink({slug:e}),{shouldIgnoreErrors:!0});var n;if(t)return{chatLink:{chatId:ms((n=t).peer),text:Fo(n.message,n.entities)}}}function Zc({enabled:e}){return xc(new fe.jI.account.ToggleSponsoredMessages({enabled:e}),{shouldReturnTrue:!0})}async function eu({limit:e,offsetDate:t,offsetPeer:n,offsetId:s,archived:i,withPinned:o,lastLocalServiceMessageId:a}){const r=n&&wi(n.id,n.accessHash)||new fe.jI.InputPeerEmpty,d=await xc(new fe.jI.messages.GetDialogs({offsetPeer:r,offsetId:s,limit:e,offsetDate:t,folderId:i?Z:void 0,...o&&{excludePinned:!0}})),c=o?await xc(new fe.jI.messages.GetPinnedDialogs({folderId:i?Z:void 0})):void 0;if(!d||d instanceof fe.jI.messages.DialogsNotModified)return;const u=(c?c.messages:[]).concat(d.messages).map(wa).filter(Boolean),l=Wu(d);c&&Object.assign(l,Wu(c,l));const f=[],h={},p=(c?.dialogs||[]).concat(d.dialogs),m=[],g={};p.forEach((e=>{if(!(e instanceof fe.jI.Dialog)||!i&&e.folderId===Z||i&&e.folderId!==Z)return;const t=Qa(e,l[nr(e.peer)]);if(g[t.id]=e.topMessage,e.pts&&Ad(t.id,e.pts),t.id===J&&a&&a>e.topMessage&&(g[t.id]=a),t.isListed=!0,f.push(t),pd(t.id,t.muteUntil,zs),o&&e.pinned&&m.push(t.id),e.draft){const n=va(e.draft);n&&(h[t.id]=n)}}));const I=f.map((e=>e.id)),w=d.users.map(Va).filter(Boolean),y=Wa((c?.users||[]).concat(d.users));let v;v=d instanceof fe.jI.messages.DialogsSlice?d.count:I.length;const b=f[f.length-1],S=g[b?.id],j=S,C=b?.id,P=u.reverse().find((e=>e.chatId===b?.id&&e.id===S))?.date;return{chatIds:I,chats:f,users:w,userStatusesById:y,draftsById:h,orderedPinnedIds:o?m:void 0,totalChatCount:v,lastMessageByChatId:g,messages:u,nextOffsetId:j,nextOffsetPeerId:C,nextOffsetDate:P}}async function tu({limit:e,offsetDate:t,offsetPeer:n,offsetId:s,withPinned:i}){const o=n&&wi(n.id,n.accessHash)||new fe.jI.InputPeerEmpty,a=await xc(new fe.jI.messages.GetSavedDialogs({offsetPeer:o,offsetId:s,limit:e,offsetDate:t,...i&&{excludePinned:!0}})),r=i?await xc(new fe.jI.messages.GetPinnedSavedDialogs):void 0;if(!a||a instanceof fe.jI.messages.SavedDialogsNotModified)return;const d=r&&!(r instanceof fe.jI.messages.SavedDialogsNotModified),c=(d?r.messages:[]).concat(a.messages).map(wa).filter(Boolean),u=Wu(a);d&&Object.assign(u,Wu(r,u));const l=(d?r.dialogs:[]).concat(a.dialogs),f=[],h=[],p={},m=[];l.forEach((e=>{const t=function(e,t){const{peer:n}=e;return{id:ms(n),type:tr(t),title:sr(n,t),...Ja(t)}}(e,u[nr(e.peer)]),n=ms(e.peer);f.push(n),i&&e.pinned&&h.push(n),p[n]=e.topMessage,m.push(t)}));const g=a.users.map(Va).filter(Boolean),I=Wa((d?r.users:[]).concat(a.users));let w;w=a instanceof fe.jI.messages.SavedDialogsSlice?a.count:f.length;const y=m[m.length-1],v=p[y?.id],b=v,S=y?.id,j=c.reverse().find((e=>e.chatId===y?.id&&e.id===v))?.date;return{chatIds:f,chats:m,users:g,userStatusesById:I,orderedPinnedIds:i?h:void 0,totalChatCount:w,lastMessageByChatId:p,messages:c,draftsById:{},nextOffsetId:b,nextOffsetPeerId:S,nextOffsetDate:j}}function nu(e){const{id:t,accessHash:n}=e;return vi(t,n)instanceof fe.jI.InputChannel?async function(e){const{id:t,adminRights:n}=e,s=e.accessHash,i=await xc(new fe.jI.channels.GetFullChannel({channel:vi(t,s)}));if(!(i&&i.fullChat instanceof fe.jI.ChannelFull))return;const{about:o,onlineCount:a,exportedInvite:r,slowmodeSeconds:d,slowmodeNextSendDate:c,migratedFromChatId:u,migratedFromMaxId:l,canViewParticipants:f,canViewStats:h,linkedChatId:p,hiddenPrehistory:m,call:g,botInfo:I,availableReactions:w,reactionsLimit:y,defaultSendAs:v,requestsPending:b,recentRequesters:S,statsDc:j,participantsCount:C,stickerset:P,chatPhoto:_,participantsHidden:M,translationsDisabled:T,storiesPinnedAvailable:k,viewForumAsMessages:A,emojiset:R,boostsApplied:E,boostsUnrestrict:D,botVerification:U,canViewRevenue:x,paidReactionsAvailable:N,hasScheduled:B,stargiftsCount:H,stargiftsAvailable:G}=i.fullChat;_&&Zi(_);const O=r instanceof fe.jI.ChatInviteExported?r.link:void 0,{members:q,userStatusesById:F}=f&&await Bu(t,s)||{},{members:L,userStatusesById:z}=f&&n&&await Bu(t,s,"kicked")||{},{members:V,userStatusesById:$}=f&&await Bu(t,s,"admin")||{},W=I?ur(I):void 0,K=e.isNotJoined||"chatTypeChannel"!==e.type?void 0:await Hu({chat:e}),J=K?.member,Q=J?.joinedDate?{joinedDate:J.joinedDate,inviter:J.inviterId,isViaRequest:J.isViaRequest}:void 0,Y=i.chats.map((e=>er(e))).filter(Boolean);if(i?.chats?.length>1){const[,e]=i.chats,t=er(e);t&&zs({"@type":"updateChat",id:t.id,chat:t})}i.fullChat.pts&&Ad(e.id,i.fullChat.pts);const X={...F,...z,...$};return{fullInfo:{..._ instanceof fe.jI.Photo&&{profilePhoto:bo(_)},about:o,onlineCount:a,inviteLink:O,slowMode:d?{seconds:d,nextSendDate:c}:void 0,migratedFrom:u?{chatId:ps(u,"chat"),maxMessageId:l}:void 0,canViewMembers:f,canViewStatistics:h,canViewMonetization:x,isPreHistoryHidden:m,joinInfo:Q,members:q,kickedMembers:L,adminMembersById:V?ai(V,"userId"):void 0,groupCallId:g?String(g.id):void 0,linkedChatId:p?ps(p,"channel"):void 0,botCommands:W,enabledReactions:hr(w),reactionsLimit:y,sendAsId:v?ms(v):void 0,requestsPending:b,recentRequesterIds:S?.map((e=>ps(e,"user"))),statisticsDcId:j,stickerSet:P?Uo(P):void 0,emojiSet:R?Uo(R):void 0,areParticipantsHidden:M,isTranslationDisabled:T,hasPinnedStories:Boolean(k),boostsApplied:E,boostsToUnrestrict:D,botVerification:U&&Ao(U),isPaidReactionAvailable:N,hasScheduledMessages:B,starGiftCount:H,areStarGiftsAvailable:Boolean(G)},chats:Y,userStatusesById:X,groupCall:g?{chatId:t,isLoaded:!1,id:g.id.toString(),accessHash:g?.accessHash.toString(),participants:{},version:0,participantsCount:0,connectionState:"disconnected"}:void 0,membersCount:C,...A&&{isForumAsMessages:!0}}}(e):async function(e){const t=await xc(new fe.jI.messages.GetFullChat({chatId:vi(e)}));if(!(t&&t.fullChat instanceof fe.jI.ChatFull))return;const{about:n,participants:s,exportedInvite:i,botInfo:o,call:a,availableReactions:r,recentRequesters:d,requestsPending:c,chatPhoto:u,translationsDisabled:l,reactionsLimit:f,hasScheduled:h}=t.fullChat;u&&Zi(u);const p=ar(s),m=p?p.filter((({isAdmin:e,isOwner:t})=>e||t)):void 0,g=o?ur(o):void 0,I=i instanceof fe.jI.ChatInviteExported?i.link:void 0,w=Wa(t.users),y=t.chats.map((e=>er(e))).filter(Boolean);return{fullInfo:{...u instanceof fe.jI.Photo&&{profilePhoto:bo(u)},about:n,members:p,adminMembersById:m?ai(m,"userId"):void 0,canViewMembers:!0,botCommands:g,inviteLink:I,groupCallId:a?.id.toString(),enabledReactions:hr(r),reactionsLimit:f,requestsPending:c,recentRequesterIds:d?.map((e=>ps(e,"user"))),isTranslationDisabled:l,isPreHistoryHidden:!0,hasScheduledMessages:h},chats:y,userStatusesById:w,groupCall:a?{chatId:e,isLoaded:!1,id:a.id.toString(),accessHash:a.accessHash.toString(),connectionState:"disconnected",participantsCount:0,version:0,participants:{}}:void 0,membersCount:p?.length}}(t)}async function su(e){const{id:t,accessHash:n}=e,s=await xc(new fe.jI.messages.GetPeerSettings({peer:wi(t,n)}),{abortControllerChatId:t});if(s)return{settings:fr(s.settings)}}async function iu({query:e}){const t=await xc(new fe.jI.contacts.Search({q:e,limit:g}));if(!t)return;const n=t.myResults.map(ms),s=t.results.map(ms).filter((e=>!n.includes(e)));return{accountResultIds:n,globalResultIds:s}}async function ou({type:e,user:t}){let n;if("self"===e||"user"===e){const s=await xc(new fe.jI.users.GetUsers({id:["user"===e&&t?vi(t.id,t.accessHash):new fe.jI.InputUserSelf]}));if(!s||!s.length)return;[n]=s}else if("support"===e){const e=await xc(new fe.jI.help.GetSupport);if(!e||!e.user)return;n=e.user}const s=er(n,"support"===e);if(s)return zs({"@type":"updateChat",id:s.id,chat:s}),{chatId:s.id}}async function au({chat:e,lastLocalMessage:t,noLastMessage:n}){const{id:s,accessHash:i}=e,o=await xc(new fe.jI.messages.GetPeerDialogs({peers:[new fe.jI.InputDialogPeer({peer:wi(s,i)})]}));if(!o)return;const a=o.dialogs[0];if(!(a&&a instanceof fe.jI.Dialog))return;const r=Wu(o)[nr(a.peer)];if(!r)return;const d=wa(o.messages[0]),c=t&&(!d||t.date>d.date)?t:d,u=Qa(a,r);zs({"@type":"updateChat",id:s,chat:u}),!n&&c&&zs({"@type":"updateChatLastMessage",id:s,lastMessage:c}),Td(o.state),pd(u.id,u.muteUntil,zs)}function ru({chat:e,draft:t}){return xc(new fe.jI.messages.SaveDraft({peer:wi(e.id,e.accessHash),message:t?.text?.text||"",entities:t?.text?.entities?.map(ki),replyTo:t?.replyInfo&&Wi(t.replyInfo)}))}async function du({chat:e,isMuted:t,muteUntil:n=0}){t&&!n&&(n=E),await xc(new fe.jI.account.UpdateNotifySettings({peer:new fe.jI.InputNotifyPeer({peer:wi(e.id,e.accessHash)}),settings:new fe.jI.InputPeerNotifySettings({muteUntil:n})})),zs({"@type":"updateNotifyExceptions",chatId:e.id,isMuted:t}),au({chat:e,noLastMessage:!0})}async function cu({chat:e,topicId:t,isMuted:n,muteUntil:s=0}){n&&!s&&(s=E),await xc(new fe.jI.account.UpdateNotifySettings({peer:new fe.jI.InputNotifyForumTopic({peer:wi(e.id,e.accessHash),topMsgId:t}),settings:new fe.jI.InputPeerNotifySettings({muteUntil:s})})),zs({"@type":"updateTopicNotifyExceptions",chatId:e.id,topicId:t,isMuted:n})}async function uu({title:e,about:t="",users:n}){const s=await xc(new fe.jI.channels.CreateChannel({broadcast:!0,title:e,about:t}),{shouldThrow:!0});if(!(s instanceof fe.jI.Updates))return void(d&&console.error("Unexpected channel creation update",s));const i=s.chats[0];if(!(i&&i instanceof fe.jI.Channel))return void(d&&console.error("Created channel not found",s));const o=er(i);let a;if(n?.length){const e=await xc(new fe.jI.channels.InviteToChannel({channel:vi(o.id,o.accessHash),users:n.map((({id:e,accessHash:t})=>vi(e,t)))}));if(!e)return;Uc(e.updates),a=e.missingInvitees.map(Ir)}return{channel:o,missingUsers:a}}function lu({channelId:e,accessHash:t}){return xc(new fe.jI.channels.JoinChannel({channel:vi(e,t)}),{shouldReturnTrue:!0,shouldThrow:!0})}function fu({chat:e,user:t}){if("chatTypeBasicGroup"===e.type)return xc(new fe.jI.messages.DeleteChatUser({chatId:vi(e.id,e.accessHash),userId:vi(t.id,t.accessHash)}),{shouldReturnTrue:!0})}function hu({chatId:e}){return xc(new fe.jI.messages.DeleteChat({chatId:vi(e)}),{shouldReturnTrue:!0})}function pu({channelId:e,accessHash:t}){return xc(new fe.jI.channels.LeaveChannel({channel:vi(e,t)}),{shouldReturnTrue:!0})}function mu({channelId:e,accessHash:t}){return xc(new fe.jI.channels.DeleteChannel({channel:vi(e,t)}),{shouldReturnTrue:!0})}async function gu({title:e,users:t}){const n=await xc(new fe.jI.messages.CreateChat({title:e,users:t.map((({id:e,accessHash:t})=>vi(e,t)))}));if(!n)return;Uc(n.updates);const s=n.missingInvitees.map(Ir),i=n.updates.chats[0];if(i&&i instanceof fe.jI.Chat)return{chat:er(i),missingUsers:s};d&&console.error("Created chat not found",n.updates)}async function Iu({chatId:e,accessHash:t,photo:n}){const s=vi(e,t);let i;if(n instanceof File){const e=await Hc(n);i=new fe.jI.InputChatUploadedPhoto({file:e})}else if(n){const e=Ai(n);if(!e)return!1;i=new fe.jI.InputChatPhoto({id:e})}else i=new fe.jI.InputChatPhotoEmpty;return xc(s instanceof fe.jI.InputChannel?new fe.jI.channels.EditPhoto({channel:s,photo:i}):new fe.jI.messages.EditChatPhoto({chatId:s,photo:i}),{shouldReturnTrue:!0})}async function wu({chat:e,shouldBePinned:t}){const{id:n,accessHash:s}=e;await xc(new fe.jI.messages.ToggleDialogPin({peer:new fe.jI.InputDialogPeer({peer:wi(n,s)}),pinned:t||void 0}))&&zs({"@type":"updateChatPinned",id:e.id,isPinned:t})}async function yu({chat:e,shouldBePinned:t}){const{id:n,accessHash:s}=e;await xc(new fe.jI.messages.ToggleSavedDialogPin({peer:new fe.jI.InputDialogPeer({peer:wi(n,s)}),pinned:t||void 0}))&&zs({"@type":"updateSavedDialogPinned",id:e.id,isPinned:t})}function vu({chat:e,folderId:t}){const{id:n,accessHash:s}=e;return xc(new fe.jI.folders.EditPeerFolders({folderPeers:[new fe.jI.InputFolderPeer({peer:wi(n,s),folderId:t})]}),{shouldReturnTrue:!0})}async function bu(){const e=await xc(new fe.jI.messages.GetDialogFilters);if(!e)return;const{filters:t}=e,n=t.findIndex((e=>e instanceof fe.jI.DialogFilterDefault)),s=t.filter(Cs),i=s.map((({id:e})=>e));return-1!==n&&i.splice(n,0,X),{byId:ai(s.map(dr),"id"),orderedIds:i}}async function Su(){const e=await xc(new fe.jI.messages.GetSuggestedDialogFilters);if(e)return e.map(cr).filter(Boolean)}async function ju({id:e,folderUpdate:t}){t.excludedChatIds=t.excludedChatIds.filter((e=>!t.includedChatIds.includes(e)));const n=function(e){const{emoticon:t,contacts:n,nonContacts:s,groups:i,channels:o,bots:a,excludeArchived:r,excludeMuted:d,excludeRead:c,pinnedChatIds:u,includedChatIds:l,excludedChatIds:f,noTitleAnimations:h}=e,p=u?u.map(yi).filter(Boolean):[],m=l?l.map(yi).filter(Boolean):[],g=f?f.map(yi).filter(Boolean):[];return e.isChatList?new fe.jI.DialogFilterChatlist({id:e.id,title:Vi(e.title),emoticon:t||void 0,pinnedPeers:p,includePeers:m,hasMyInvites:e.hasMyInvites,titleNoanimate:h}):new fe.jI.DialogFilter({id:e.id,title:Vi(e.title),emoticon:t||void 0,contacts:n||void 0,nonContacts:s||void 0,groups:i||void 0,bots:a||void 0,excludeArchived:r||void 0,excludeMuted:d||void 0,excludeRead:c||void 0,broadcasts:o||void 0,pinnedPeers:p,includePeers:m,excludePeers:g,titleNoanimate:h})}(t);await xc(new fe.jI.messages.UpdateDialogFilter({id:e,filter:n}))&&zs({"@type":"updateChatFolder",id:e,folder:t})}async function Cu(e){const t=await xc(new fe.jI.messages.UpdateDialogFilter({id:e,filter:void 0})),n=await Su();t&&zs({"@type":"updateChatFolder",id:e,folder:void 0}),n&&zs({"@type":"updateRecommendedChatFolders",folders:n})}function Pu(e){return xc(new fe.jI.messages.UpdateDialogFiltersOrder({order:e}))}async function _u({chat:e,hasUnreadMark:t}){const{id:n,accessHash:s}=e;await xc(new fe.jI.messages.MarkDialogUnread({peer:new fe.jI.InputDialogPeer({peer:wi(n,s)}),unread:t||void 0}))&&zs({"@type":"updateChat",id:e.id,chat:{hasUnreadMark:t}})}async function Mu(e){return ku(await xc(new fe.jI.contacts.ResolvePhone({phone:e})))}async function Tu(e,t){return ku(await xc(new fe.jI.contacts.ResolveUsername({username:e,referer:t})))}function ku(e){if(!e)return;const{users:t,chats:n}=e,s=n.length?er(n[0]):er(t[0]);return s?{chat:s,user:Va(t[0])}:void 0}function Au({chat:e,isEnabled:t}){const{id:n,accessHash:s}=e,i=vi(n,s);return xc(new fe.jI.channels.TogglePreHistoryHidden({channel:i,enabled:t}),{shouldReturnTrue:!0})}function Ru({chat:e,bannedRights:t}){const{id:n,accessHash:s}=e,i=wi(n,s);return xc(new fe.jI.messages.EditChatDefaultBannedRights({peer:i,bannedRights:Ei(t)}),{shouldReturnTrue:!0})}function Eu({chat:e,user:t,bannedRights:n,untilDate:s}){const i=vi(e.id,e.accessHash),o=wi(t.id,t.accessHash);return xc(new fe.jI.channels.EditBanned({channel:i,participant:o,bannedRights:Ei(n,s)}),{shouldReturnTrue:!0})}function Du({chat:e,user:t,adminRights:n,customTitle:s=""}){const i=vi(e.id,e.accessHash),o=vi(t.id,t.accessHash);return xc(new fe.jI.channels.EditAdmin({channel:i,userId:o,adminRights:Di(n),rank:s}),{shouldReturnTrue:!0})}async function Uu(e,t){const n=vi(e.id,e.accessHash);await xc(n instanceof fe.jI.InputChannel?new fe.jI.channels.EditTitle({channel:n,title:t}):new fe.jI.messages.EditChatTitle({chatId:n,title:t}),{shouldReturnTrue:!0})}async function xu(e,t){await xc(new fe.jI.messages.EditChatAbout({peer:wi(e.id,e.accessHash),about:t}))&&zs({"@type":"updateChatFullInfo",id:e.id,fullInfo:{about:t}})}function Nu({chat:e,areSignaturesEnabled:t,areProfilesEnabled:n}){const{id:s,accessHash:i}=e,o=vi(s,i);return xc(new fe.jI.channels.ToggleSignatures({channel:o,signaturesEnabled:t||void 0,profilesEnabled:n||void 0}),{shouldReturnTrue:!0})}async function Bu(e,t,n="recent",s){let i;switch(n){case"kicked":i=new fe.jI.ChannelParticipantsKicked({q:""});break;case"admin":i=new fe.jI.ChannelParticipantsAdmins;break;default:i=new fe.jI.ChannelParticipantsRecent}const o=await xc(new fe.jI.channels.GetParticipants({channel:vi(e,t),filter:i,offset:s,limit:I}),{abortControllerChatId:e});if(!o||o instanceof fe.jI.channels.ChannelParticipantsNotModified)return;const a=Wa(o.users);return{members:ar(o),userStatusesById:a}}async function Hu({chat:e,peer:t}){const n=t?wi(t.id,t.accessHash):new fe.jI.InputPeerSelf,s=await xc(new fe.jI.channels.GetParticipant({channel:vi(e.id,e.accessHash),participant:n}),{abortControllerChatId:e.id});if(!s)return;const i=Wa(s.users),o=or(s.participant);return o?{member:o,userStatusesById:i}:void 0}async function Gu(){const e=await xc(new fe.jI.channels.GetGroupsForDiscussion);if(e)return e.chats.map((e=>er(e)))}function Ou({channel:e,chat:t}){return xc(new fe.jI.channels.SetDiscussionGroup({broadcast:wi(e.id,e.accessHash),group:t?wi(t.id,t.accessHash):new fe.jI.InputChannelEmpty}),{shouldReturnTrue:!0})}async function qu(e){const t=await xc(new fe.jI.messages.MigrateChat({chatId:vi(e.id)}),{shouldThrow:!0});if(!(t&&t instanceof fe.jI.Updates))return void(d&&console.error("Unexpected channel creation update",t));const n=t.updates.find((e=>e instanceof fe.jI.UpdateChannel)).channelId;return er(t.chats.find((e=>e instanceof fe.jI.Channel&&e.id.toString()===n.toString())))}async function Fu(e){const t=await xc(new fe.jI.messages.CheckChatInvite({hash:e}));if(!t)return;if(t instanceof fe.jI.ChatInvite)return{chat:void 0,invite:wr(t),users:t.participants?.map(Va).filter(Boolean)};const n=er(t.chat);return n?{chat:n,invite:void 0,users:void 0}:void 0}async function Lu(e,t){try{if("chatTypeChannel"===e.type||"chatTypeSuperGroup"===e.type){const n=await xc(new fe.jI.channels.InviteToChannel({channel:vi(e.id,e.accessHash),users:t.map((e=>vi(e.id,e.accessHash)))}));if(!n)return;return Uc(n.updates),n.missingInvitees.map(Ir)}const n=await Promise.all(t.map((async t=>{const n=await xc(new fe.jI.messages.AddChatUser({chatId:vi(e.id),userId:vi(t.id,t.accessHash)}));if(n)return Uc(n.updates),n.missingInvitees.map(Ir)})));if(n)return n.flat().filter(Boolean)}catch(e){zs({"@type":"error",error:{message:e instanceof pe?e.errorMessage:e.message}})}}function zu(e,t){return"chatTypeChannel"===e.type||"chatTypeSuperGroup"===e.type?Eu({chat:e,user:t,bannedRights:{viewMessages:!0,sendMessages:!0,sendMedia:!0,sendStickers:!0,sendGifs:!0,sendGames:!0,sendInline:!0,embedLinks:!0,sendPolls:!0,changeInfo:!0,inviteUsers:!0,pinMessages:!0,manageTopics:!0,sendPhotos:!0,sendVideos:!0,sendRoundvideos:!0,sendAudios:!0,sendVoices:!0,sendDocs:!0,sendPlain:!0},untilDate:E}):xc(new fe.jI.messages.DeleteChatUser({chatId:vi(e.id),userId:vi(t.id,t.accessHash)}),{shouldReturnTrue:!0})}function Vu(e,t){return xc(new fe.jI.channels.ToggleJoinToSend({channel:vi(e.id,e.accessHash),enabled:t}),{shouldReturnTrue:!0})}function $u(e,t){return xc(new fe.jI.channels.ToggleJoinRequest({channel:vi(e.id,e.accessHash),enabled:t}),{shouldReturnTrue:!0})}function Wu(e,t){const n={};return e.chats?.forEach((e=>{const s=`chat${e.id}`;t?.[s]&&"min"in e&&e.min||(n[s]=e)})),e.users?.forEach((e=>{const s=`user${e.id}`;t?.[s]&&"min"in e&&e.min||(n[s]=e)})),n}async function Ku({hash:e}){const t=await xc(new fe.jI.messages.ImportChatInvite({hash:e}));if(t instanceof fe.jI.Updates&&t.chats.length)return er(t.chats[0])}function Ju({chat:e,enabledReactions:t,reactionsLimit:n}){return xc(new fe.jI.messages.SetChatAvailableReactions({peer:wi(e.id,e.accessHash),availableReactions:(s=t,"all"===s?.type?new fe.jI.ChatReactionsAll({allowCustom:s.areCustomAllowed}):"some"===s?.type?new fe.jI.ChatReactionsSome({reactions:s.allowed.map(Li)}):new fe.jI.ChatReactionsNone),reactionsLimit:n}),{shouldReturnTrue:!0});var s}function Qu({chat:e,isProtected:t}){const{id:n,accessHash:s}=e;return xc(new fe.jI.messages.ToggleNoForwards({peer:wi(n,s),enabled:t}),{shouldReturnTrue:!0})}function Yu({chat:e,isEnabled:t}){const{id:n,accessHash:s}=e;return xc(new fe.jI.channels.ToggleParticipantsHidden({channel:wi(n,s),enabled:t}),{shouldReturnTrue:!0})}function Xu({chat:e,isEnabled:t}){const{id:n,accessHash:s}=e;return xc(new fe.jI.channels.ToggleForum({channel:wi(n,s),enabled:t}),{shouldReturnTrue:!0,shouldThrow:!0})}async function Zu({chat:e,title:t,iconColor:n,iconEmojiId:s,sendAs:i}){const{id:o,accessHash:a}=e,r=await xc(new fe.jI.channels.CreateForumTopic({channel:wi(o,a),title:t,iconColor:n,iconEmojiId:s?vt()(s):void 0,sendAs:i?wi(i.id,i.accessHash):void 0,randomId:Pi()}));if(r instanceof fe.jI.Updates&&r.updates.length)return r.updates?.find((e=>e instanceof fe.jI.UpdateMessageID))?.id}async function el({chat:e,query:t,offsetTopicId:n,offsetId:s,offsetDate:i,limit:o=k}){const{id:a,accessHash:r}=e,d=await xc(new fe.jI.channels.GetForumTopics({channel:wi(a,r),limit:o,q:t,offsetTopic:n,offsetId:s,offsetDate:i}));if(!d)return;const{count:c,orderByCreateDate:u}=d;return{topics:d.topics.map(mr).filter(Boolean),messages:d.messages.map(wa).filter(Boolean),count:c+1,shouldOrderByCreateDate:u,draftsById:d.topics.reduce(((e,t)=>(t instanceof fe.jI.ForumTopic&&t.draft&&(e[t.id]=va(t.draft)),e)),{}),readInboxMessageIdByTopicId:d.topics.reduce(((e,t)=>(t instanceof fe.jI.ForumTopic&&t.readInboxMaxId&&(e[t.id]=t.readInboxMaxId),e)),{})}}async function tl({chat:e,topicId:t}){const{id:n,accessHash:s}=e,i=await xc(new fe.jI.channels.GetForumTopicsByID({channel:wi(n,s),topics:[t]}));if(!(i?.topics.length&&i.topics[0]instanceof fe.jI.ForumTopic))return;const o=i.messages.map(wa).filter(Boolean);return{topic:mr(i.topics[0]),messages:o}}async function nl({chat:e,topicId:t}){const{id:n,accessHash:s}=e,i=await xc(new fe.jI.channels.DeleteTopicHistory({channel:wi(n,s),topMsgId:t}));i&&(qd(e,i),i.offset&&await nl({chat:e,topicId:t}))}function sl({chat:e,topicId:t,isPinned:n}){const{id:s,accessHash:i}=e;return xc(new fe.jI.channels.UpdatePinnedForumTopic({channel:wi(s,i),topicId:t,pinned:n}),{shouldReturnTrue:!0})}function il({chat:e,topicId:t,title:n,iconEmojiId:s,isClosed:i,isHidden:o}){const{id:a,accessHash:r}=e;return xc(new fe.jI.channels.EditForumTopic({channel:wi(a,r),topicId:t,title:n,iconEmojiId:t!==te&&s?vt()(s):void 0,closed:i,hidden:o}),{shouldReturnTrue:!0})}async function ol({slug:e}){const t=await xc(new fe.jI.chatlists.CheckChatlistInvite({slug:e})),n=function(e,t){return e instanceof fe.jI.chatlists.ChatlistInvite?{slug:t,title:Mo(e.title),noTitleAnimations:e.titleNoanimate,emoticon:e.emoticon,peerIds:e.peers.map(ms).filter(Boolean)}:e instanceof fe.jI.chatlists.ChatlistInviteAlready?{slug:t,folderId:e.filterId,missingPeerIds:e.missingPeers.map(ms).filter(Boolean),alreadyPeerIds:e.alreadyPeers.map(ms).filter(Boolean)}:void 0}(t,e);if(t&&n)return{invite:n}}function al({slug:e,peers:t}){return xc(new fe.jI.chatlists.JoinChatlistInvite({slug:e,peers:t.map((e=>wi(e.id,e.accessHash)))}),{shouldReturnTrue:!0,shouldThrow:!0})}async function rl({folderId:e}){const t=await xc(new fe.jI.chatlists.GetLeaveChatlistSuggestions({chatlist:new fe.jI.InputChatlistDialogFilter({filterId:e})}));if(t)return t.map(ms)}function dl({folderId:e,peers:t}){return xc(new fe.jI.chatlists.LeaveChatlist({chatlist:new fe.jI.InputChatlistDialogFilter({filterId:e}),peers:t.map((e=>wi(e.id,e.accessHash)))}),{shouldReturnTrue:!0})}async function cl({folderId:e,title:t,peers:n}){const s=await xc(new fe.jI.chatlists.ExportChatlistInvite({chatlist:new fe.jI.InputChatlistDialogFilter({filterId:e}),title:t||"",peers:n.map((e=>wi(e.id,e.accessHash)))}),{shouldThrow:!0});if(s&&!(s.filter instanceof fe.jI.DialogFilterDefault))return{filter:dr(s.filter),invite:gr(s.invite)}}function ul({folderId:e,slug:t}){return xc(new fe.jI.chatlists.DeleteExportedInvite({chatlist:new fe.jI.InputChatlistDialogFilter({filterId:e}),slug:t}))}async function ll({folderId:e,slug:t,title:n,peers:s}){const i=await xc(new fe.jI.chatlists.EditExportedInvite({chatlist:new fe.jI.InputChatlistDialogFilter({filterId:e}),slug:t,title:n,peers:s.map((e=>wi(e.id,e.accessHash)))}),{shouldThrow:!0});if(i)return gr(i)}async function fl({folderId:e}){const t=await xc(new fe.jI.chatlists.GetExportedInvites({chatlist:new fe.jI.InputChatlistDialogFilter({filterId:e})}));if(t)return{invites:t.invites.map(gr).filter(Boolean)}}function hl({chat:e,isEnabled:t}){return xc(new fe.jI.messages.TogglePeerTranslations({disabled:!t||void 0,peer:wi(e.id,e.accessHash)}))}function pl({chat:e,isEnabled:t}){const{id:n,accessHash:s}=e,i=vi(n,s);return xc(new fe.jI.channels.ToggleViewForumAsMessages({channel:i,enabled:Boolean(t)}),{shouldReturnTrue:!0})}async function ml({chat:e}){const t=await xc(new fe.jI.channels.GetChannelRecommendations({channel:e&&vi(e.id,e.accessHash)}));if(!t)return;const n=t?.chats.map((e=>er(e))).filter(Boolean);return{similarChannels:n,count:t instanceof fe.jI.messages.ChatsSlice?t.count:n.length}}var gl=n(48287).hp;const Il=1e3,wl=63;async function yl({chat:e,threadId:t,offsetId:n,isSavedDialog:s,...i}){const o=t===Ys?fe.jI.messages.GetHistory:s?fe.jI.messages.GetSavedHistory:fe.jI.messages.GetReplies;let a;try{a=await xc(new o({peer:wi(e.id,e.accessHash),...t!==Ys&&!s&&{msgId:Number(t)},...n&&{offsetId:Math.min(n,E)},...i}),{shouldThrow:!0,abortControllerChatId:e.id,abortControllerThreadId:t})}catch(t){"CHANNEL_PRIVATE"===t.errorMessage&&zs({"@type":"updateChat",id:e.id,chat:{isRestricted:!0}})}if(a&&!(a instanceof fe.jI.messages.MessagesNotModified)&&a.messages)return{messages:a.messages.map(wa).filter(Boolean),users:a.users.map(Va).filter(Boolean),chats:a.chats.map((e=>er(e))).filter(Boolean),count:!(a instanceof fe.jI.messages.Messages)&&a.count}}async function vl({chat:e,messageId:t}){const n="channel"===gi(e.id);let s;try{s=await xc(n?new fe.jI.channels.GetMessages({channel:vi(e.id,e.accessHash),id:[new fe.jI.InputMessageID({id:t})]}):new fe.jI.messages.GetMessages({id:[new fe.jI.InputMessageID({id:t})]}),{shouldThrow:!0,abortControllerChatId:e.id})}catch(e){const{message:t}=e;"CHANNEL_PRIVATE"!==t&&zs({"@type":"error",error:{message:t,isSlowMode:!1,hasErrorKey:!0}})}if(!s||s instanceof fe.jI.messages.MessagesNotModified)return;"pts"in s&&Ad(e.id,s.pts);const i=s.messages[0];if(!i)return;if(i instanceof fe.jI.MessageEmpty)return Xs;Cr(i);const o=wa(i);return o?{message:o}:void 0}let bl=Promise.resolve();function Sl({chat:e,lastMessageId:t,text:n,entities:s,replyInfo:i,attachment:o,sticker:a,story:r,gif:c,poll:u,contact:l,isSilent:f,scheduledAt:h,groupedId:p,noWebPage:m,sendAs:g,shouldUpdateStickerSetOrder:I,wasDrafted:w,isInvertedMedia:y,effectId:v,webPageMediaSize:b,webPageUrl:S},j){const{message:C,poll:P}=function(e,t,n,s,i,o,a,r,d,c,u,l,f,h,p,m){const g=Ia(t),I=o&&Ca(o),w="chatTypeChannel"===e.type,y=i&&(j=i,C=e.isForum,"story"===j.type?{type:"story",peerId:j.peerId,storyId:j.storyId}:{type:"message",replyToMsgId:j.replyToMsgId,replyToTopId:j.replyToTopId,replyToPeerId:j.replyToPeerId,quoteText:j.quoteText,isForumTopic:!(!C||!j.replyToTopId)||void 0,...Boolean(j.quoteText)&&{isQuote:!0}}),v=d&&function(e,t){return{mediaType:"poll",id:String(t),summary:di(e.summary,["question","answers"]),results:{}}}(d,g),b={id:g,chatId:e.id,content:li({text:n?{text:n,entities:s}:void 0,...I,sticker:a,video:r||I?.video,contact:c,storyData:h&&{mediaType:"storyData",...h},pollId:v?.id}),date:l||Math.round(Date.now()/1e3)+kn(),isOutgoing:!w,senderId:f?.id||ma,replyInfo:y,...u&&{groupedId:u,...I&&(I.photo||I.video)&&{isInAlbum:!0}},...l&&{isScheduled:!0},isForwardingAllowed:!0,isInvertedMedia:p,effectId:m},S=oi(b.content,b.groupedId);var j,C;return{message:{...b,...S&&{emojiOnlyCount:S}},poll:v}}(e,t,n,s,i,o,a,c,u,l,p,h,g,r,y,v);zs({"@type":C.isScheduled?"newScheduledMessage":"newMessage",id:C.id,chatId:e.id,message:C,poll:P,wasDrafted:w});const _=setTimeout((()=>{zs({"@type":C.isScheduled?"updateScheduledMessage":"updateMessage",id:C.id,chatId:e.id,message:{sendingState:"messageSendingStatePending"}})}),Il),M=Pi();if(p)return function({chat:e,text:t,entities:n,replyInfo:s,attachment:i,groupedId:o,isSilent:a,scheduledAt:r,sendAs:c},u,l,f){let h=-1;jl[o]||(jl[o]={counter:0,singleMediaByIndex:{},localMessages:{}}),h=jl[o].counter++;const p=bl;return bl=(async()=>{let m;try{m=await _l(l,i,f)}catch(e){return d&&console.warn(e),jl[o].counter--,void await p}const g=await async function(e,t){const n=await xc(new fe.jI.messages.UploadMedia({peer:e,media:t})),s=t.spoiler;if(n instanceof fe.jI.MessageMediaPhoto&&n.photo&&n.photo instanceof fe.jI.Photo){const{photo:{id:e,accessHash:t,fileReference:i}}=n;return new fe.jI.InputMediaPhoto({id:new fe.jI.InputPhoto({id:e,accessHash:t,fileReference:i}),spoiler:s})}if(n instanceof fe.jI.MessageMediaDocument&&n.document&&n.document instanceof fe.jI.Document){const{document:{id:e,accessHash:t,fileReference:i}}=n;return new fe.jI.InputMediaDocument({id:new fe.jI.InputDocument({id:e,accessHash:t,fileReference:i}),spoiler:s})}}(wi(e.id,e.accessHash),m);if(await p,!g)return jl[o].counter--,void(d&&console.warn("Failed to upload grouped media"));if(jl[o].singleMediaByIndex[h]=new fe.jI.InputSingleMedia({media:g,randomId:u,message:t||"",entities:n?n.map(ki):void 0}),jl[o].localMessages[u.toString()]=l,Object.keys(jl[o].singleMediaByIndex).length<jl[o].counter)return;const{singleMediaByIndex:I,localMessages:w}=jl[o];delete jl[o];const y=await xc(new fe.jI.messages.SendMultiMedia({clearDraft:!0,peer:wi(e.id,e.accessHash),multiMedia:Object.values(I),replyTo:s&&Wi(s),...a&&{silent:a},...r&&{scheduleDate:r},...c&&{sendAs:wi(c.id,c.accessHash)}}),{shouldIgnoreUpdates:!0});y&&gf(w,y)})(),bl}({chat:e,text:n,entities:s,replyInfo:i,attachment:o,groupedId:p,isSilent:f,scheduledAt:h},M,C,j);const T=(async()=>{let t;if(o)try{t=await _l(C,o,j)}catch(e){return d&&console.warn(e),void await bl}else a?t=ji(a):c?t=ji(c):u?t=function(e,t){const{summary:n,quiz:s}=e,i=new fe.jI.Poll({id:t,publicVoters:n.isPublic,question:Vi(n.question),answers:n.answers.map((({text:e,option:t})=>new fe.jI.PollAnswer({text:Vi(e),option:_s(t)}))),quiz:n.quiz,multipleChoice:n.multipleChoice});if(!s)return new fe.jI.InputMediaPoll({poll:i});const o=s.correctAnswers.map(_s),{solution:a}=s,r=s.solutionEntities?s.solutionEntities.map(ki):[];return new fe.jI.InputMediaPoll({poll:i,correctAnswers:o,...a&&{solution:a,solutionEntities:r}})}(u,M):r?t=function(e){const t=yi(e.peerId);return new fe.jI.InputMediaStory({peer:t,id:e.id})}(r):S&&b?t=new fe.jI.InputMediaWebPage({url:S,forceLargeMedia:"large"===b||void 0,forceSmallMedia:"small"===b||void 0}):l&&(t=new fe.jI.InputMediaContact({phoneNumber:l.phoneNumber,firstName:l.firstName,lastName:l.lastName,vcard:""}));const p=t?fe.jI.messages.SendMedia:fe.jI.messages.SendMessage;try{const o=await xc(new p({clearDraft:!0,message:n||"",entities:s?s.map(ki):void 0,peer:wi(e.id,e.accessHash),randomId:M,replyTo:i&&Wi(i),...f&&{silent:f},...h&&{scheduleDate:h},...t&&{media:t},...m&&{noWebpage:m},...g&&{sendAs:wi(g.id,g.accessHash)},...I&&{updateStickersetsOrder:I},...y&&{invertMedia:y},...v&&{effect:vt()(v)}}),{shouldThrow:!0,shouldIgnoreUpdates:!0});o&&If(C,o)}catch(t){"PRIVACY_PREMIUM_REQUIRED"===t.errorMessage&&zs({"@type":"updateRequestUserUpdate",id:e.id}),zs({"@type":"updateMessageSendFailed",chatId:e.id,localId:C.id,error:t.message}),clearTimeout(_)}})();return T}const jl={};async function Cl({chat:e,message:t,text:n,entities:s,attachment:i,noWebPage:o},a){const r=1e3*t.date>Date.now()+1e3*kn(),c=i&&Ca(i),u=n&&!i?.shouldSendAsFile?t.isInvertedMedia:void 0,l={...c||t.content,...n&&{text:{text:n,entities:s}}},f={...t,content:l,isInvertedMedia:u};zs({"@type":r?"updateScheduledMessage":"updateMessage",id:t.id,chatId:e.id,message:f});try{let d;i&&(d=await _l(t,i,a));const c=s&&s.map(ki);await xc(new fe.jI.messages.EditMessage({message:n||"",entities:c,media:d,peer:wi(e.id,e.accessHash),id:t.id,...r&&{scheduleDate:t.date},...o&&{noWebpage:o},...u&&{invertMedia:u}}),{shouldThrow:!0})}catch(n){d&&console.warn(n);const{message:s}=n;zs({"@type":"error",error:{message:s,hasErrorKey:!0}}),zs({"@type":r?"updateScheduledMessage":"updateMessage",id:t.id,chatId:e.id,message:t})}}async function Pl({chat:e,message:t,scheduledAt:n}){await xc(new fe.jI.messages.EditMessage({peer:wi(e.id,e.accessHash),id:t.id,scheduleDate:n}))}async function _l(e,t,n){const{filename:s,blobUrl:i,mimeType:o,quick:a,voice:r,audio:d,previewBlobUrl:c,shouldSendAsFile:u,shouldSendAsSpoiler:l,ttlSeconds:f}=t,h=t=>{n.isCanceled?h.isCanceled=!0:n(t,function(e){const{chatId:t}=e;return function(e,t){return`msg${e}-${t}`}(t,"randomId"in e?Number(e.randomId):e.previousLocalId||e.id)}(e))},p=async(e,t)=>Hc(await async function(e,t){const n=await async function(e){return(await fetch(e)).blob()}(e);return function(e,t){return new File([e],t,{lastModified:Date.now(),type:e.type})}(n,t)}(e,s),t),m=L.has(o),g=d||m||u,[I,w]=await Promise.all(fi([p(i,h),g&&c&&p(c)])),y=[new fe.jI.DocumentAttributeFilename({fileName:s})];if(!u){if(a){if(F.has(o)&&o!==G)return new fe.jI.InputMediaUploadedPhoto({file:I,spoiler:l});if(m){const{width:e,height:t,duration:n}=a;void 0!==n&&y.push(new fe.jI.DocumentAttributeVideo({duration:n,w:e,h:t,supportsStreaming:!0}))}}if(d){const{duration:e,title:t,performer:n}=d;y.push(new fe.jI.DocumentAttributeAudio({duration:e,title:t,performer:n}))}if(r){const{duration:e,waveform:t}=r,{data:n}=pi(t,wl);y.push(new fe.jI.DocumentAttributeAudio({voice:!0,duration:e,waveform:gl.from(n)}))}}return new fe.jI.InputMediaUploadedDocument({file:I,mimeType:o,attributes:y,thumb:w,forceFile:u,spoiler:l,ttlSeconds:f})}async function Ml({chat:e,messageId:t,isUnpin:n,isOneSide:s,isSilent:i}){await xc(new fe.jI.messages.UpdatePinnedMessage({peer:wi(e.id,e.accessHash),id:t,...n&&{unpin:!0},...s&&{pmOneside:!0},...i&&{silent:!0}}))}async function Tl({chat:e,threadId:t}){const n=await xc(new fe.jI.messages.UnpinAllMessages({peer:wi(e.id,e.accessHash),...t&&{topMsgId:Number(t)}}));n&&(qd(e,n),n.offset&&await Tl({chat:e,threadId:t}))}async function kl({chat:e,messageIds:t,shouldDeleteForAll:n}){const s="channel"===gi(e.id),i=await xc(s?new fe.jI.channels.DeleteMessages({channel:vi(e.id,e.accessHash),id:t}):new fe.jI.messages.DeleteMessages({id:t,...n&&{revoke:!0}}));i&&(qd(e,i),zs({"@type":"deleteMessages",ids:t,...s&&{chatId:e.id}}))}function Al({chat:e,messageIds:t}){xc(new fe.jI.messages.DeleteScheduledMessages({peer:wi(e.id,e.accessHash),id:t}))}async function Rl({chat:e,shouldDeleteForAll:t}){const n="channel"===gi(e.id),s=await xc(n?new fe.jI.channels.DeleteHistory({channel:vi(e.id,e.accessHash)}):new fe.jI.messages.DeleteHistory({peer:wi(e.id,e.accessHash),...t&&{revoke:!0},...!t&&{just_clear:!0}}));s&&("offset"in s&&(qd(e,s),s.offset)?await Rl({chat:e,shouldDeleteForAll:t}):zs({"@type":"deleteHistory",chatId:e.id}))}async function El({chat:e}){const t=await xc(new fe.jI.messages.DeleteSavedHistory({peer:wi(e.id,e.accessHash)}));t&&(qd(e,t),t.offset?await El({chat:e}):zs({"@type":"deleteSavedHistory",chatId:e.id}))}async function Dl({peer:e,messageIds:t,description:n,option:s}){try{const i=await xc(new fe.jI.messages.Report({peer:wi(e.id,e.accessHash),id:t,option:_s(s),message:n}),{shouldThrow:!0});if(!i)return;return{result:Ta(i),error:void 0}}catch(e){const t=e.message;if(t===V)return{result:void 0,error:t};throw e}}function Ul({peer:e,chat:t,messageIds:n}){return xc(new fe.jI.channels.ReportSpam({participant:wi(e.id,e.accessHash),channel:vi(t.id,t.accessHash),id:n}))}async function xl({peer:e,threadId:t,action:n}){const s=function(e){switch(e.type){case"cancel":return new fe.jI.SendMessageCancelAction;case"typing":return new fe.jI.SendMessageTypingAction;case"recordAudio":return new fe.jI.SendMessageRecordAudioAction;case"chooseSticker":return new fe.jI.SendMessageChooseStickerAction;case"playingGame":return new fe.jI.SendMessageGamePlayAction}}(n);if(s)try{return await xc(new fe.jI.messages.SetTyping({peer:wi(e.id,e.accessHash),topMsgId:Number(t),action:s}),{shouldThrow:!0,abortControllerChatId:e.id,abortControllerThreadId:t})}catch(e){}else d&&console.warn("Unsupported message action",n)}async function Nl({chat:e,threadId:t,maxId:n=0}){const s="channel"===gi(e.id),i=Math.min(n,E);if(s&&t===Ys)await xc(new fe.jI.channels.ReadHistory({channel:vi(e.id,e.accessHash),maxId:i}));else if(s)await xc(new fe.jI.messages.ReadDiscussion({peer:wi(e.id,e.accessHash),msgId:Number(t),readMaxId:i}));else{const t=await xc(new fe.jI.messages.ReadHistory({peer:wi(e.id,e.accessHash),maxId:i}));t&&qd(e,t)}t===Ys?au({chat:e,noLastMessage:!0}):e.isForum&&zs({"@type":"updateTopic",chatId:e.id,topicId:Number(t)})}async function Bl({chat:e,messageIds:t}){const n="channel"===gi(e.id),s=await xc(n?new fe.jI.channels.ReadMessageContents({channel:vi(e.id,e.accessHash),id:t}):new fe.jI.messages.ReadMessageContents({id:t}));s&&(!0!==s&&qd(e,s),zs({...n?{"@type":"updateChannelMessages",channelId:e.id}:{"@type":"updateCommonBoxMessages"},ids:t,messageUpdate:{hasUnreadMention:!1,isMediaUnread:!1}}))}async function Hl({chat:e,ids:t,shouldIncrement:n}){const s=hi(t,S),i=await Promise.all(s.map((t=>xc(new fe.jI.messages.GetMessagesViews({peer:wi(e.id,e.accessHash),id:t,increment:n})))));if(!i||i.some((e=>!e)))return;const o=i.flatMap((e=>e.views));return{viewsInfo:t.map(((t,n)=>{const{views:s,forwards:i,replies:a}=o[n];return{id:t,views:s,forwards:i,threadInfo:a?_a(a,t,e.id):void 0}}))}}async function Gl({chat:e,ids:t}){const n=hi(t,S),s=await Promise.all(n.map((t=>xc(new fe.jI.messages.GetFactCheck({peer:wi(e.id,e.accessHash),msgId:t})))));if(s&&!s.some((e=>!e)))return s.flatMap((e=>e)).map(ja)}function Ol(){return xc(new fe.jI.messages.GetPaidReactionPrivacy,{shouldReturnTrue:!0})}function ql({chat:e,messageIds:t}){return xc(new fe.jI.messages.ReportMessagesDelivery({peer:wi(e.id,e.accessHash),id:t}))}async function Fl({chat:e,messageId:t}){const[n,s]=await Promise.all([xc(new fe.jI.messages.GetDiscussionMessage({peer:wi(e.id,e.accessHash),msgId:t}),{abortControllerChatId:e.id,abortControllerThreadId:t}),yl({chat:e,threadId:t,offsetId:1,addOffset:-1,limit:1})]);if(!n||!s)return;const i=n.messages.map(wa).filter(Boolean),o=i.concat(s.messages),a=n.messages[n.messages.length-1]?.id;if(!a)return;const{unreadCount:r,maxId:d,readInboxMaxId:c,readOutboxMaxId:u}=n;return{messages:o,topMessages:i,unreadCount:r,threadId:a,lastReadInboxMessageId:c,lastReadOutboxMessageId:u,lastMessageId:d,chatId:i[0]?.chatId,firstMessageId:s.messages[0]?.id}}async function Ll({peer:e,isSavedDialog:t,savedTag:n,type:s,query:i="",threadId:o,minDate:a,maxDate:r,...d}){let c;switch(s){case"media":c=new fe.jI.InputMessagesFilterPhotoVideo;break;case"documents":c=new fe.jI.InputMessagesFilterDocument;break;case"links":c=new fe.jI.InputMessagesFilterUrl;break;case"audio":c=new fe.jI.InputMessagesFilterMusic;break;case"voice":c=new fe.jI.InputMessagesFilterRoundVoice;break;case"profilePhoto":c=new fe.jI.InputMessagesFilterChatPhotos;break;default:c=new fe.jI.InputMessagesFilterEmpty}const u=wi(e.id,e.accessHash),l=await xc(new fe.jI.messages.Search({peer:t?new fe.jI.InputPeerSelf:u,savedPeerId:t?u:void 0,savedReaction:n&&[Li(n)],topMsgId:o===Ys||t?void 0:Number(o),filter:c,q:i,minDate:a,maxDate:r,...d}),{abortControllerChatId:e.id,abortControllerThreadId:o});if(!l||l instanceof fe.jI.messages.MessagesNotModified||!l.messages)return;const f=Wa(l.users),h=l.messages.map(wa).filter(Boolean);let p,m=h.length;return(l instanceof fe.jI.messages.MessagesSlice||l instanceof fe.jI.messages.ChannelMessages)&&(m=l.count,h.length&&(p=h[h.length-1].id)),{userStatusesById:f,messages:h,totalCount:m,nextOffsetId:p}}async function zl({query:e,offsetRate:t=0,offsetPeer:n,offsetId:s,limit:i,type:o="text",minDate:a,maxDate:r,context:d="all"}){let c;switch(o){case"media":c=new fe.jI.InputMessagesFilterPhotoVideo;break;case"documents":c=new fe.jI.InputMessagesFilterDocument;break;case"links":c=new fe.jI.InputMessagesFilterUrl;break;case"audio":c=new fe.jI.InputMessagesFilterMusic;break;case"voice":c=new fe.jI.InputMessagesFilterRoundVoice;break;default:if(!(e||r&&a))return;c=new fe.jI.InputMessagesFilterEmpty}const u=n&&wi(n.id,n.accessHash)||new fe.jI.InputPeerEmpty,l=await xc(new fe.jI.messages.SearchGlobal({q:e,offsetRate:t,offsetPeer:u,offsetId:s,broadcastsOnly:"channels"===o||"channels"===d||void 0,groupsOnly:"groups"===d||void 0,usersOnly:"users"===d||void 0,limit:i,filter:c,minDate:a,maxDate:r}));if(!l||l instanceof fe.jI.messages.MessagesNotModified||!l.messages)return;const f=Wa(l.users),h=l.messages.map(wa).filter(Boolean);let p=h.length;p=l instanceof fe.jI.messages.MessagesSlice||l instanceof fe.jI.messages.ChannelMessages?l.count:l.messages.length;const m=l.messages[l.messages.length-1],g=js(m),I="nextRate"in l&&l.nextRate?l.nextRate:void 0,w=m?.id;return{messages:h,userStatusesById:f,totalCount:p,nextOffsetRate:I,nextOffsetPeerId:g,nextOffsetId:w}}async function Vl({hashtag:e,offsetRate:t,offsetPeer:n,offsetId:s,limit:i}){const o=n&&wi(n.id,n.accessHash)||new fe.jI.InputPeerEmpty,a=await xc(new fe.jI.channels.SearchPosts({hashtag:e,offsetRate:t,offsetId:s,offsetPeer:o,limit:i}));if(!a||a instanceof fe.jI.messages.MessagesNotModified)return;const r=Wa(a.users),d=a.messages.map(wa).filter(Boolean);let c=d.length;c=a instanceof fe.jI.messages.MessagesSlice||a instanceof fe.jI.messages.ChannelMessages?a.count:a.messages.length;const u=a.messages[a.messages.length-1],l=js(u),f="nextRate"in a&&a.nextRate?a.nextRate:void 0,h=u?.id;return{messages:d,userStatusesById:r,totalCount:c,nextOffsetRate:f,nextOffsetPeerId:l,nextOffsetId:h}}async function $l({text:e}){const t=Vi(e),n=await xc(new fe.jI.messages.GetWebPagePreview({message:t.text,entities:t.entities}));return n&&Yo(n.media)}async function Wl({chat:e,messageId:t,options:n}){const{id:s,accessHash:i}=e;await xc(new fe.jI.messages.SendVote({peer:wi(s,i),msgId:t,options:n.map(_s)}))}async function Kl({chat:e,messageId:t,poll:n}){const{id:s,accessHash:i}=e;await xc(new fe.jI.messages.EditMessage({peer:wi(s,i),id:t,media:Ci(n,!0)}))}async function Jl({chat:e,messageId:t,option:n,offset:s,limit:i,shouldResetVoters:o}){const{id:a,accessHash:r}=e,d=await xc(new fe.jI.messages.GetPollVotes({peer:wi(a,r),id:t,...n&&{option:_s(n)},...s&&{offset:s},...i&&{limit:i}}));if(!d)return;const c=d.votes.map((e=>({peerId:ms(e.peer),date:e.date})));return{count:d.count,votes:c,nextOffset:d.nextOffset,shouldResetVoters:o}}async function Ql({chat:e,ids:t}){await xc(new fe.jI.messages.GetExtendedMedia({peer:wi(e.id,e.accessHash),id:t}))}async function Yl({fromChat:e,toChat:t,toThreadId:n,messages:s,isSilent:i,scheduledAt:o,sendAs:a,withMyScore:r,noAuthors:d,noCaptions:c,isCurrentUserPremium:u,wasDrafted:l,lastMessageId:f}){const h=s.map((({id:e})=>e)),p=s.map(Pi),m={};s.forEach(((e,s)=>{const i=function({toChat:e,toThreadId:t,message:n,scheduledAt:s,noAuthors:i,noCaptions:o,isCurrentUserPremium:a,lastMessageId:r,sendAs:d}){const c=Ia(r),{content:u,chatId:l,id:f,senderId:h,groupedId:p,isInAlbum:m,isInvertedMedia:g}=n,I=u.audio,w=e.id===ma&&(l!==e.id||n.forwardInfo)&&!I,y=Object.keys(u).length>1&&u.text&&o,v=!a,b=u.text?.entities&&v?{text:u.text.text,entities:u.text.entities.filter((e=>e.type!==Qs.CustomEmoji))}:u.text,S=oi(u,p),j={...u,text:y?void 0:b},C=t&&t!==Ys?{type:"message",replyToMsgId:t,replyToTopId:t,isForumTopic:e.isForum||void 0}:void 0;return{id:c,chatId:e.id,content:j,date:s||Math.round(Date.now()/1e3)+kn(),isOutgoing:!w&&"chatTypeChannel"!==e.type,senderId:d?.id||ma,sendingState:"messageSendingStatePending",groupedId:p,isInAlbum:m,isForwardingAllowed:!0,replyInfo:C,isInvertedMedia:g,...t&&e?.isForum&&{isTopicReply:!0},...S&&{emojiOnlyCount:S},...n.chatId!==ma&&!I&&!i&&{forwardInfo:{date:n.forwardInfo?.date||n.date,savedDate:n.date,isChannelPost:!1,fromChatId:l,fromMessageId:f,fromId:h,savedFromPeerId:n.chatId}},...n.chatId===ma&&!i&&{forwardInfo:n.forwardInfo},...s&&{isScheduled:!0}}}({toChat:t,toThreadId:Number(n),message:e,scheduledAt:o,noAuthors:d,noCaptions:c,isCurrentUserPremium:u,lastMessageId:f,sendAs:a});m[p[s].toString()]=i,zs({"@type":i.isScheduled?"newScheduledMessage":"newMessage",id:i.id,chatId:t.id,message:i,wasDrafted:l})}));try{const s=await xc(new fe.jI.messages.ForwardMessages({fromPeer:wi(e.id,e.accessHash),toPeer:wi(t.id,t.accessHash),randomId:p,id:h,withMyScore:r||void 0,silent:i||void 0,dropAuthor:d||void 0,dropMediaCaptions:c||void 0,...n&&{topMsgId:Number(n)},...o&&{scheduleDate:o},...a&&{sendAs:wi(a.id,a.accessHash)}}),{shouldThrow:!0,shouldIgnoreUpdates:!0});s&&gf(m,s)}catch(e){Object.values(m).forEach((n=>{zs({"@type":"updateMessageSendFailed",chatId:t.id,localId:n.id,error:e.message})}))}}async function Xl({chat:e,timestamp:t}){const n=await xc(new fe.jI.messages.GetHistory({peer:wi(e.id,e.accessHash),offsetDate:t,addOffset:-1,limit:1}));if(n&&!(n instanceof fe.jI.messages.MessagesNotModified)&&n.messages&&n.messages.length)return n.messages[0].id}async function Zl({chat:e}){const{id:t,accessHash:n}=e,s=await xc(new fe.jI.messages.GetScheduledHistory({peer:wi(t,n)}),{abortControllerChatId:t});if(s&&!(s instanceof fe.jI.messages.MessagesNotModified)&&s.messages)return{messages:s.messages.map(wa).filter(Boolean)}}async function ef({chat:e,ids:t}){const{id:n,accessHash:s}=e;await xc(new fe.jI.messages.SendScheduledMessages({peer:wi(n,s),id:t}))}async function tf({chat:e,threadId:t}){const n=await xc(new fe.jI.messages.Search({peer:wi(e.id,e.accessHash),filter:new fe.jI.InputMessagesFilterPinned,q:"",limit:w,topMsgId:Number(t)}),{abortControllerChatId:e.id,abortControllerThreadId:t});if(n&&!(n instanceof fe.jI.messages.MessagesNotModified)&&n.messages)return{messages:n.messages.map(wa).filter(Boolean)}}async function nf({chat:e,messageId:t}){const n=await xc(new fe.jI.messages.GetMessageReadParticipants({peer:wi(e.id,e.accessHash),msgId:t}));return n?n.reduce(((e,t)=>(e[t.userId.toString()]=t.date,e)),{}):void 0}async function sf({chat:e}){const t=await xc(new fe.jI.channels.GetSendAs({peer:wi(e.id,e.accessHash)}),{shouldIgnoreErrors:!0,abortControllerChatId:e.id});if(t)return{sendAs:t.peers.map(pr)}}function of({sendAs:e,chat:t}){return xc(new fe.jI.messages.SaveDefaultSendAs({peer:wi(t.id,t.accessHash),sendAs:wi(e.id,e.accessHash)}))}async function af({peer:e}){const t=await xc(new fe.jI.messages.GetSponsoredMessages({peer:wi(e.id,e.accessHash)}));if(t&&!(t instanceof fe.jI.messages.SponsoredMessagesEmpty)&&t.messages.length)return{messages:t.messages.map((t=>function(e,t){const{message:n,entities:s,randomId:i,recommended:o,sponsorInfo:a,additionalInfo:r,buttonText:d,canReport:c,title:u,url:l,color:f}=e;let h,p;return e.photo instanceof fe.jI.Photo&&(Zi(e.photo),h=bo(e.photo)),e.media&&(p=Lo(e.media)),{chatId:t,randomId:Ps(i),expiresAt:Math.round(Date.now()/1e3)+A,isRecommended:o,sponsorInfo:a,additionalInfo:r,buttonText:d,canReport:c,title:u,url:l,peerColor:f&&gs(f),photo:h,content:{...p,text:Fo(n,s)}}}(t,e.id))).filter(Boolean)}}async function rf({peer:e,random:t}){await xc(new fe.jI.messages.ViewSponsoredMessage({peer:wi(e.id,e.accessHash),randomId:_s(t)}))}function df({peer:e,random:t,isMedia:n,isFullscreen:s}){return xc(new fe.jI.messages.ClickSponsoredMessage({media:n||void 0,fullscreen:s||void 0,peer:wi(e.id,e.accessHash),randomId:_s(t)}))}async function cf({peer:e,randomId:t,option:n}){try{const s=await xc(new fe.jI.messages.ReportSponsoredMessage({peer:wi(e.id,e.accessHash),randomId:_s(t),option:_s(n)}),{shouldThrow:!0});if(!s)return;return function(e){return e instanceof fe.jI.channels.SponsoredMessageReportResultReported?{type:"reported"}:e instanceof fe.jI.channels.SponsoredMessageReportResultAdsHidden?{type:"hidden"}:{type:"selectOption",title:e.title,options:e.options.map((e=>({text:e.text,option:Ps(e.option)})))}}(s)}catch(e){return e instanceof pe&&"PREMIUM_ACCOUNT_REQUIRED"===e.errorMessage?{type:"premiumRequired"}:void 0}}async function uf({chat:e}){const t=await xc(new fe.jI.messages.ReadMentions({peer:wi(e.id,e.accessHash)}));t&&(qd(e,t),t.offset&&await uf({chat:e}))}async function lf({chat:e}){const t=await xc(new fe.jI.messages.ReadReactions({peer:wi(e.id,e.accessHash)}));t&&(qd(e,t),t.offset&&await lf({chat:e}))}async function ff({chat:e,...t}){const n=await xc(new fe.jI.messages.GetUnreadMentions({peer:wi(e.id,e.accessHash),limit:T,...t}));if(n&&!(n instanceof fe.jI.messages.MessagesNotModified)&&n.messages)return{messages:n.messages.map(wa).filter(Boolean)}}async function hf({chat:e,...t}){const n=await xc(new fe.jI.messages.GetUnreadReactions({peer:wi(e.id,e.accessHash),limit:M,...t}));if(n&&!(n instanceof fe.jI.messages.MessagesNotModified)&&n.messages)return{messages:n.messages.map(wa).filter(Boolean)}}async function pf({chat:e,messageId:t}){const n=await xc(new fe.jI.messages.TranscribeAudio({msgId:t,peer:wi(e.id,e.accessHash)}));if(n)return zs({"@type":"updateTranscribedAudio",isPending:n.pending,transcriptionId:n.transcriptionId.toString(),text:n.text}),n.transcriptionId.toString()}async function mf(e){let t;const n="chat"in e;if(n){const{chat:n,messageIds:s,toLanguageCode:i}=e;t=await xc(new fe.jI.messages.TranslateText({peer:wi(n.id,n.accessHash),id:s,toLang:i}))}else{const{text:n,toLanguageCode:s}=e;t=await xc(new fe.jI.messages.TranslateText({text:n.map((e=>Vi(e))),toLang:s}))}if(!t)return;const s=t.result.map((e=>Mo(e)));return n&&zs({"@type":"updateMessageTranslations",chatId:e.chat.id,messageIds:e.messageIds,translations:s,toLanguageCode:e.toLanguageCode}),s}function gf(e,t){if(!("updates"in t))return void Uc(t);t.updates.filter((e=>e instanceof fe.jI.UpdateMessageID)).forEach((n=>{const s=t.updates.find((e=>e instanceof fe.jI.UpdateNewScheduledMessage&&e.message.id===n.id));If(e[n.randomId.toString()],n,s)}));const n=t.updates.filter((e=>!(e instanceof fe.jI.UpdateMessageID||e instanceof fe.jI.UpdateNewScheduledMessage)));t.updates=n,Uc(t)}function If(e,t,n){let s,i,o;if(t instanceof fe.jI.UpdateShortSentMessage||t instanceof fe.jI.UpdateMessageID?s=t:"updates"in t&&(s=t.updates.find((e=>e instanceof fe.jI.UpdateMessageID)),n=t.updates.find((e=>e instanceof fe.jI.UpdateNewScheduledMessage))),!s)return void Uc(t);s instanceof fe.jI.UpdateShortSentMessage&&(e.content.text&&s.entities&&(i={text:Fo(e.content.text.text,s.entities)}),s.media&&(i={...i,...Lo(s.media,{peerId:Ii(e.chatId),id:s.id})},o=Wo(s.media)),Cr(Ti(s.id,e.chatId,s)));const a=n?.message&&wa(n.message),r="date"in s&&s.date<An();if(a?.isVideoProcessingPending)zs({"@type":"updateVideoProcessingPending",chatId:e.chatId,localId:e.id,newScheduledMessageId:a?.id});else{const t={...e,...i&&{content:{...e.content,...i}},id:s.id,sendingState:void 0,..."date"in s&&{date:s.date}};zs({"@type":e.isScheduled&&!r?"updateScheduledMessageSendSucceeded":"updateMessageSendSucceeded",chatId:e.chatId,localId:e.id,message:t,poll:o})}Uc(t)}async function wf({chat:e,messageId:t}){const{id:n,accessHash:s}=e,i=wi(n,s),o=await xc(new fe.jI.messages.GetOutboxReadDate({peer:i,msgId:t}),{shouldThrow:!0});if(o)return{date:o.date}}async function yf(){const e=await xc(new fe.jI.messages.GetQuickReplies({}));if(e&&!(e instanceof fe.jI.messages.QuickRepliesNotModified))return{messages:e.messages.map(wa).filter(Boolean),quickReplies:e.quickReplies.map(Ma)}}async function vf({chat:e,shortcutId:t}){const n=await xc(new fe.jI.messages.GetQuickReplyMessages({shortcutId:t}));if(!n||n instanceof fe.jI.messages.MessagesNotModified)return;const s=n.messages.map((e=>e.id)),i=s.map(Pi),o=await xc(new fe.jI.messages.SendQuickReplyMessages({peer:wi(e.id,e.accessHash),shortcutId:t,id:s,randomId:i}),{shouldIgnoreUpdates:!0});if(o){if("updates"in o){const e=o.updates.filter((e=>!(e instanceof fe.jI.UpdateMessageID)));o.updates=e}Uc(o)}}async function bf({id:e,chat:t,shouldIncludeThread:n,shouldIncludeGrouped:s}){const i=await xc(new fe.jI.channels.ExportMessageLink({channel:vi(t.id,t.accessHash),id:e,thread:n||void 0,grouped:s||void 0}));return i?.link}async function Sf({id:e,accessHash:t}){const n=vi(e,t);if(!(n instanceof fe.jI.InputUser))return;const s=await xc(new fe.jI.users.GetFullUser({id:n}));if(!s)return;s.fullUser.profilePhoto&&Zi(s.fullUser.profilePhoto),s.fullUser.personalPhoto&&Zi(s.fullUser.personalPhoto),s.fullUser.fallbackPhoto&&Zi(s.fullUser.fallbackPhoto);const i=s.fullUser.botInfo;i?.descriptionPhoto&&Zi(i.descriptionPhoto),i?.descriptionDocument instanceof fe.jI.Document&&(qs.documents[i.descriptionDocument.id.toString()]=i.descriptionDocument),s.fullUser.businessIntro?.sticker instanceof fe.jI.Document&&(qs.documents[s.fullUser.businessIntro.sticker.id.toString()]=s.fullUser.businessIntro.sticker);const o=za(s),a=s.users.map(Va).filter(Boolean),r=s.chats.map((e=>er(e))).filter(Boolean),d=a.find((({id:t})=>t===e));return zs({"@type":"updateUser",id:e,user:d,fullInfo:o}),{user:d,fullInfo:o,users:a,chats:r}}async function jf(e,t){const n=await xc(new fe.jI.messages.GetCommonChats({userId:vi(e.id,e.accessHash),maxId:t?Hi(t,gi(t)):void 0}));if(!n)return;const s=n.chats.map((e=>er(e))).filter(Boolean).map((({id:e})=>e));return{chatIds:s,count:"count"in n?n.count:s.length}}async function Cf(){const e=await xc(new fe.jI.help.GetNearestDc);return e?.country}async function Pf(){const e=await xc(new fe.jI.contacts.GetTopPeers({correspondents:!0}));if(e instanceof fe.jI.contacts.TopPeers)return{ids:e.users.map(Va).filter((e=>Boolean(e)&&!e.isSelf)).map((({id:e})=>e))}}async function _f(){const e=await xc(new fe.jI.contacts.GetContacts({hash:vt()("0")}));if(e&&!(e instanceof fe.jI.contacts.ContactsNotModified))return{users:e.users.map(Va).filter(Boolean),userStatusesById:Wa(e.users)}}async function Mf({users:e}){const t=await xc(new fe.jI.users.GetUsers({id:e.map((({id:e,accessHash:t})=>wi(e,t)))}));if(t&&t.length)return{users:t.map(Va).filter(Boolean),userStatusesById:Wa(t)}}async function Tf({phone:e,firstName:t,lastName:n}){const s=await xc(new fe.jI.contacts.ImportContacts({contacts:[Ri({phone:e||"",firstName:t||"",lastName:n||""})]}));return s instanceof fe.jI.contacts.ImportedContacts&&s.users.length&&so(s.users[0]),s?.imported.length?ps(s.imported[0].userId,"user"):void 0}function kf({id:e,accessHash:t,phoneNumber:n="",firstName:s="",lastName:i="",shouldSharePhoneNumber:o=!1}){return xc(new fe.jI.contacts.AddContact({id:vi(e,t),firstName:s,lastName:i,phone:n,...o&&{addPhonePrivacyException:o}}),{shouldReturnTrue:!0})}async function Af({id:e,accessHash:t}){const n=vi(e,t);n instanceof fe.jI.InputUser&&await xc(new fe.jI.contacts.DeleteContacts({id:[n]}))&&zs({"@type":"deleteContact",id:e})}async function Rf({peer:e,offset:t=0,limit:n=0}){const s="title"in e?e:void 0,i=s?void 0:e;if(i){const{id:e,accessHash:s}=i,o=await xc(new fe.jI.photos.GetUserPhotos({userId:vi(e,s),limit:n,offset:t,maxId:vt()("0")}));if(!o)return;o.photos.forEach(Zi);const a=o instanceof fe.jI.photos.PhotosSlice?o.count:o.photos.length,r=t+o.photos.length,d=r<a?r:void 0;return{count:a,photos:o.photos.filter((e=>e instanceof fe.jI.Photo)).map((e=>bo(e))),nextOffsetId:d}}if(s?.isRestricted)return;const o=await Ll({peer:e,type:"profilePhoto",limit:n});if(!o)return;const{messages:a,totalCount:r,nextOffsetId:d}=o;return{count:r,photos:a.map((e=>e.content.action.photo)).filter(Boolean),nextOffsetId:d}}function Ef(e){const{id:t,accessHash:n}=e;return xc(new fe.jI.messages.ReportSpam({peer:wi(t,n)}),{shouldReturnTrue:!0})}function Df(e,t){return xc(new fe.jI.account.UpdateEmojiStatus({emojiStatus:zi(e,t)}),{shouldReturnTrue:!0})}function Uf(e){const t=e.map((e=>Hi(e,"user")));return xc(new fe.jI.contacts.EditCloseFriends({id:t}),{shouldReturnTrue:!0})}async function xf({hash:e="0"}){const t=await xc(new fe.jI.messages.GetEmojiStickers({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.AllStickersNotModified))return t.sets.forEach((e=>{(e.thumbs?.length||e.thumbDocumentId)&&(qs.stickerSets[String(e.id)]=e)})),{hash:String(t.hash),sets:t.sets.map(Uo)}}async function Nf({hash:e="0"}){const t=await xc(new fe.jI.messages.GetAllStickers({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.AllStickersNotModified))return t.sets.forEach((e=>{e.thumbs?.length&&(qs.stickerSets[String(e.id)]=e)})),{hash:String(t.hash),sets:t.sets.map(Uo)}}async function Bf({hash:e="0"}){const t=await xc(new fe.jI.messages.GetRecentStickers({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.RecentStickersNotModified))return{hash:String(t.hash),stickers:Bo(t.stickers.slice(0,x))}}async function Hf({hash:e="0"}){const t=await xc(new fe.jI.messages.GetFavedStickers({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.FavedStickersNotModified))return{hash:String(t.hash),stickers:Bo(t.stickers)}}async function Gf({hash:e="0"}){const t=await xc(new fe.jI.messages.GetFeaturedStickers({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.FeaturedStickersNotModified))return{hash:String(t.hash),isPremium:Boolean(t.premium),sets:t.sets.map(xo)}}async function Of(){const e=await xc(new fe.jI.messages.GetFeaturedEmojiStickers({hash:vt()(0)}));if(e&&!(e instanceof fe.jI.messages.FeaturedStickersNotModified))return e.sets.forEach((({set:e})=>{e.thumbDocumentId&&(qs.stickerSets[String(e.id)]=e)})),{isPremium:Boolean(e.premium),sets:e.sets.map(xo)}}async function qf({sticker:e,unfave:t}){const n=new fe.jI.messages.FaveSticker({id:Si(e),unfave:t});await xc(n)&&zs({"@type":"updateFavoriteStickers"})}function Ff({sticker:e}){return xc(new fe.jI.messages.SaveRecentSticker({id:Si(e),unsave:!0}))}function Lf(){return xc(new fe.jI.messages.ClearRecentStickers)}async function zf({stickerSetInfo:e}){if("isMissing"in e)return;const t=await xc(new fe.jI.messages.GetStickerSet({stickerset:"id"in e?bi(e.id,e.accessHash):(n=e.shortName,new fe.jI.InputStickerSetShortName({shortName:n}))}),{shouldThrow:!0});var n;return t instanceof fe.jI.messages.StickerSet?(qs.stickerSets[String(t.set.id)]=t.set,{set:Uo(t.set),stickers:Bo(t.documents),packs:No(t.packs)}):void 0}async function Vf({documentId:e}){if(!e.length)return;const t=await xc(new fe.jI.messages.GetCustomEmojiDocuments({documentId:e.map((e=>vt()(e)))}));return t?Bo(t):void 0}async function $f(){const e=await xc(new fe.jI.messages.GetStickerSet({stickerset:new fe.jI.InputStickerSetAnimatedEmoji}));if(e instanceof fe.jI.messages.StickerSet)return{set:Uo(e.set),stickers:Bo(e.documents)}}async function Wf(){const e=await xc(new fe.jI.messages.GetStickerSet({stickerset:new fe.jI.InputStickerSetAnimatedEmojiAnimations}));if(e instanceof fe.jI.messages.StickerSet)return{set:Uo(e.set),stickers:Bo(e.documents)}}async function Kf(){const e=await xc(new fe.jI.messages.GetStickerSet({stickerset:new fe.jI.InputStickerSetEmojiGenericAnimations}));if(e instanceof fe.jI.messages.StickerSet)return{set:Uo(e.set),stickers:Bo(e.documents)}}async function Jf(){const e=await xc(new fe.jI.messages.GetStickerSet({stickerset:new fe.jI.InputStickerSetPremiumGifts}));if(e instanceof fe.jI.messages.StickerSet)return{set:Uo(e.set),stickers:Bo(e.documents)}}async function Qf(){const e=await xc(new fe.jI.messages.GetStickerSet({stickerset:new fe.jI.InputStickerSetEmojiDefaultTopicIcons}));if(e instanceof fe.jI.messages.StickerSet)return{set:Uo(e.set),stickers:Bo(e.documents)}}async function Yf(){const e=await xc(new fe.jI.messages.GetStickerSet({stickerset:new fe.jI.InputStickerSetEmojiDefaultStatuses}));if(e instanceof fe.jI.messages.StickerSet)return{set:Uo(e.set),stickers:Bo(e.documents)}}async function Xf({query:e,hash:t="0"}){const n=await xc(new fe.jI.messages.SearchStickerSets({q:e,hash:vt()(t)}));if(n&&!(n instanceof fe.jI.messages.FoundStickerSetsNotModified))return{hash:String(n.hash),sets:n.sets.map(xo)}}async function Zf({hash:e="0"}){const t=await xc(new fe.jI.messages.GetSavedGifs({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.SavedGifsNotModified))return{hash:String(t.hash),gifs:dh(t.gifs)}}function eh({gif:e,shouldUnsave:t}){return xc(new fe.jI.messages.SaveGif({id:Si(e),unsave:t}),{shouldReturnTrue:!0})}async function th({stickerSetId:e,accessHash:t}){await xc(new fe.jI.messages.InstallStickerSet({stickerset:bi(e,t)}))&&zs({"@type":"updateStickerSet",id:e,stickerSet:{installedDate:Date.now()}})}async function nh({stickerSetId:e,accessHash:t}){await xc(new fe.jI.messages.UninstallStickerSet({stickerset:bi(e,t)}))&&zs({"@type":"updateStickerSet",id:e,stickerSet:{installedDate:void 0}})}let sh;async function ih({query:e,offset:t="",username:n=Y}){if(!sh){const e=await xc(new fe.jI.contacts.ResolveUsername({username:n}));if(!(e&&e.users[0]instanceof fe.jI.User))return;sh=new fe.jI.InputUser({userId:e.peer.userId,accessHash:e.users[0].accessHash})}const s=await xc(new fe.jI.messages.GetInlineBotResults({bot:sh,peer:new fe.jI.InputPeerEmpty,query:e,offset:t}));if(!s)return;const i=s.results.map((e=>{if(e instanceof fe.jI.BotInlineMediaResult)return e.document})).filter(Boolean);return{nextOffset:s.nextOffset,gifs:dh(i)}}async function oh({emoji:e,hash:t="0"}){const n=await xc(new fe.jI.messages.GetStickers({emoticon:e,hash:vt()(t)}));if(n&&!(n instanceof fe.jI.messages.StickersNotModified))return{stickers:Bo(n.stickers),hash:String(n.hash)}}async function ah({language:e,fromVersion:t}){const n=await xc(new fe.jI.messages.GetEmojiKeywordsDifference({langCode:e,fromVersion:t}));if(n)return{language:n.langCode,version:n.version,keywords:n.keywords.reduce(((e,t)=>(e[t.keyword]=t.emoticons,e)),{})}}async function rh(e="0"){const t=await xc(new fe.jI.account.GetRecentEmojiStatuses({hash:vt()(e)}));if(!t||t instanceof fe.jI.account.EmojiStatusesNotModified)return;const n=t.statuses.slice(0,N).map(Is).filter(Boolean).map((({documentId:e})=>e)),s=await Vf({documentId:n});return{hash:String(t.hash),emojiStatuses:s}}function dh(e){return e.map((e=>{if(e instanceof fe.jI.Document){const t=zo(e);if(t)return qs.documents[String(e.id)]=e,t}})).filter(Boolean)}async function ch({username:e}){try{return{result:await xc(new fe.jI.channels.CheckUsername({channel:new fe.jI.InputChannelEmpty,username:e}),{shouldThrow:!0}),error:void 0}}catch(e){const t=e.message;if($.has(t))return{result:!1,error:t};throw e}}async function uh({chat:e,username:t}){const n=await xc(new fe.jI.channels.UpdateUsername({channel:vi(e.id,e.accessHash),username:t}));let s=t?[{username:t,isEditable:!0,isActive:!0}]:[];return e.usernames&&(s=s.concat(e.usernames.filter((e=>e.username&&!e.isEditable)))),n&&zs({"@type":"updateChat",id:e.id,chat:{usernames:s.length?s:void 0}}),n}async function lh({chat:e}){const t=await xc(new fe.jI.channels.DeactivateAllUsernames({channel:vi(e.id,e.accessHash)}));if(t){const t=e.usernames?e.usernames.map((e=>({...e,isActive:!1}))).filter((e=>e.username)):void 0;zs({"@type":"updateChat",id:e.id,chat:{usernames:t}})}return t}async function fh({chat:e,usageLimit:t,expireDate:n}){const s=await xc(new fe.jI.messages.ExportChatInvite({peer:wi(e.id,e.accessHash),usageLimit:t,expireDate:n}));if(s instanceof fe.jI.ChatInviteExported)return zs({"@type":"updateChatFullInfo",id:e.id,fullInfo:{inviteLink:s.link}}),s.link}async function hh({peer:e,admin:t,limit:n=0,isRevoked:s}){const i=await xc(new fe.jI.messages.GetExportedChatInvites({peer:wi(e.id,e.accessHash),adminId:vi(t.id,t.accessHash),limit:n,revoked:s||void 0}),{abortControllerChatId:e.id});if(i)return{invites:i.invites.filter((e=>e instanceof fe.jI.ChatInviteExported)).map(lr)}}async function ph({peer:e,isRevoked:t,link:n,expireDate:s,usageLimit:i,isRequestNeeded:o,title:a}){const r=await xc(new fe.jI.messages.EditExportedChatInvite({link:n,peer:wi(e.id,e.accessHash),expireDate:s,usageLimit:o?void 0:i,requestNeeded:o,title:a,revoked:t||void 0}));if(r){if(r instanceof fe.jI.messages.ExportedChatInvite&&r.invite instanceof fe.jI.ChatInviteExported){const e=lr(r.invite);return{oldInvite:e,newInvite:e}}if(r instanceof fe.jI.messages.ExportedChatInviteReplaced&&r.invite instanceof fe.jI.ChatInviteExported&&r.newInvite instanceof fe.jI.ChatInviteExported)return{oldInvite:lr(r.invite),newInvite:lr(r.newInvite)}}}async function mh({peer:e,expireDate:t,usageLimit:n,isRequestNeeded:s,title:i}){const o=await xc(new fe.jI.messages.ExportChatInvite({peer:wi(e.id,e.accessHash),expireDate:t,usageLimit:s?void 0:n,requestNeeded:s||void 0,title:i}));if(o instanceof fe.jI.ChatInviteExported)return lr(o)}async function gh({peer:e,link:t}){return await xc(new fe.jI.messages.DeleteExportedChatInvite({peer:wi(e.id,e.accessHash),link:t}))}async function Ih({peer:e,admin:t}){return await xc(new fe.jI.messages.DeleteRevokedExportedChatInvites({peer:wi(e.id,e.accessHash),adminId:vi(t.id,t.accessHash)}))}async function wh({peer:e,link:t,offsetDate:n=0,offsetUser:s,limit:i=0,isRequested:o}){const a=await xc(new fe.jI.messages.GetChatInviteImporters({peer:wi(e.id,e.accessHash),link:t,offsetDate:n,offsetUser:s?vi(s.id,s.accessHash):new fe.jI.InputUserEmpty,limit:i,requested:o||void 0}),{abortControllerChatId:e.id});if(a)return{importers:a.importers.map((e=>function(e){const{userId:t,date:n,about:s,requested:i,viaChatlist:o}=e;return{userId:ps(t,"user"),date:n,about:s,isRequested:i,isFromChatList:o}}(e)))}}function yh({peer:e,user:t,isApproved:n}){return xc(new fe.jI.messages.HideChatJoinRequest({peer:wi(e.id,e.accessHash),userId:vi(t.id,t.accessHash),approved:n||void 0}),{shouldReturnTrue:!0})}function vh({peer:e,isApproved:t,link:n}){return xc(new fe.jI.messages.HideAllChatJoinRequests({peer:wi(e.id,e.accessHash),approved:t||void 0,link:n}),{shouldReturnTrue:!0})}function bh(e){const{id:t,accessHash:n}=e;return xc(new fe.jI.messages.HidePeerSettingsBar({peer:wi(t,n)}))}var Sh=n(48287).hp;function jh(e){const{emojies_sounds:t}=e;return t?Object.keys(t).reduce(((e,n)=>{const s=t[n];return qs.documents[s.id]=new fe.jI.Document({id:vt()(s.id),accessHash:vt()(s.access_hash),dcId:1,mimeType:"audio/ogg",fileReference:Sh.alloc(0),size:vt()(0)}),e[n]=s.id,e}),{}):{}}function Ch(e,t,n){return[e[`${t}_default`]||oe[n][0],e[`${t}_premium`]||oe[n][1]]}const Ph=["ar","fa","id","ko","uz","en"];function _h({firstName:e,lastName:t,about:n}){return xc(new fe.jI.account.UpdateProfile({firstName:e||"",lastName:t||"",about:n||""}),{shouldReturnTrue:!0})}async function Mh(e){try{return{result:await xc(new fe.jI.account.CheckUsername({username:e}),{shouldThrow:!0}),error:void 0}}catch(e){if(e instanceof pe&&$.has(e.errorMessage))return{result:!1,error:e.errorMessage};throw e}}function Th(e){return xc(new fe.jI.account.UpdateUsername({username:e}),{shouldReturnTrue:!0})}async function kh(e,t){const n=e?Ai(e):new fe.jI.InputPhotoEmpty,s=await xc(new fe.jI.photos.UpdateProfilePhoto({id:n,...t?{fallback:!0}:void 0}));if(s)return s.photo instanceof fe.jI.Photo?(Zi(s.photo),{photo:bo(s.photo)}):void 0}async function Ah(e,t,n=!1,s=0,i){const o=await Hc(e),a=await xc(new fe.jI.photos.UploadProfilePhoto({...i?{bot:wi(i.id,i.accessHash)}:void 0,...n?{video:o,videoStartTs:s}:{file:o},...t?{fallback:!0}:void 0}));if(a)return a.photo instanceof fe.jI.Photo?(Zi(a.photo),{photo:bo(a.photo)}):void 0}async function Rh({file:e,isSuggest:t,user:n}){const s=e?await Hc(e):void 0,i=await xc(new fe.jI.photos.UploadContactProfilePhoto({userId:vi(n.id,n.accessHash),file:s,...t?{suggest:!0}:{save:!0}}));if(i)return i.photo instanceof fe.jI.Photo?(Zi(i.photo),{photo:bo(i.photo)}):{photo:void 0}}async function Eh(e){const t=e.map(Ai).filter(Boolean),n=await xc(new fe.jI.photos.DeletePhotos({id:t}),{shouldReturnTrue:!0});return n&&e.forEach((e=>{delete qs.photos[e.id]})),n}async function Dh(){const e=await xc(new fe.jI.account.GetWallPapers({hash:vt()("0")}));if(!e||e instanceof fe.jI.account.WallPapersNotModified)return;const t=e.wallpapers.filter((e=>e instanceof fe.jI.WallPaper&&e.document instanceof fe.jI.Document));return t.forEach((e=>{qs.documents[String(e.document.id)]=e.document})),{wallpapers:t.map(_r).filter(Boolean)}}async function Uh(e){const t=await Hc(e),n=await xc(new fe.jI.account.UploadWallPaper({file:t,mimeType:e.type,settings:new fe.jI.WallPaperSettings}));if(!(n&&n instanceof fe.jI.WallPaper))return;const s=_r(n);return s?(qs.documents[String(n.document.id)]=n.document,{wallpaper:s}):void 0}async function xh({isOnlyStories:e}){const t=await xc(new fe.jI.contacts.GetBlocked({myStoriesFrom:e,limit:y}));if(t)return{blockedIds:t.blocked.map((e=>ms(e.peerId))),totalCount:t instanceof fe.jI.contacts.BlockedSlice?t.count:t.blocked.length}}function Nh({user:e,isOnlyStories:t}){return xc(new fe.jI.contacts.Block({id:wi(e.id,e.accessHash),myStoriesFrom:t}))}function Bh({user:e,isOnlyStories:t}){return xc(new fe.jI.contacts.Unblock({id:wi(e.id,e.accessHash),myStoriesFrom:t}))}async function Hh(){const e=await xc(new fe.jI.account.GetAuthorizations);if(e)return{authorizations:ai(e.authorizations.map(Mr),"hash"),ttlDays:e.authorizationTtlDays}}function Gh(e){return xc(new fe.jI.account.ResetAuthorization({hash:vt()(e)}))}function Oh(){return xc(new fe.jI.auth.ResetAuthorizations)}async function qh(){const e=await xc(new fe.jI.account.GetWebAuthorizations);if(e)return{webAuthorizations:ai(e.authorizations.map(Tr),"hash")}}function Fh(e){return xc(new fe.jI.account.ResetWebAuthorization({hash:vt()(e)}))}function Lh(){return xc(new fe.jI.account.ResetWebAuthorizations)}async function zh(){const e=await xc(new fe.jI.account.GetNotifyExceptions({compareSound:!0}),{shouldIgnoreUpdates:!0});if(e instanceof fe.jI.Updates||e instanceof fe.jI.UpdatesCombined)return e.updates.reduce(((e,t)=>t instanceof fe.jI.UpdateNotifySettings&&t.peer instanceof fe.jI.NotifyPeer?(e.push(kr(t.notifySettings,t.peer.peer)),e):e),[])}async function Vh(){const[e,t,n,s]=await Promise.all([xc(new fe.jI.account.GetContactSignUpNotification),xc(new fe.jI.account.GetNotifySettings({peer:new fe.jI.InputNotifyUsers})),xc(new fe.jI.account.GetNotifySettings({peer:new fe.jI.InputNotifyChats})),xc(new fe.jI.account.GetNotifySettings({peer:new fe.jI.InputNotifyBroadcasts}))]);if(!t||!n||!s)return!1;const{silent:i,muteUntil:o,showPreviews:a}=t,{silent:r,muteUntil:d,showPreviews:c}=n,{silent:u,muteUntil:l,showPreviews:f}=s;return{hasContactJoinedNotifications:!e,hasPrivateChatsNotifications:!(i||"number"==typeof o&&An()<o),hasPrivateChatsMessagePreview:a,hasGroupNotifications:!(r||"number"==typeof d&&An()<d),hasGroupMessagePreview:c,hasBroadcastNotifications:!(u||"number"==typeof l&&An()<l),hasBroadcastMessagePreview:f}}function $h(e){return xc(new fe.jI.account.SetContactSignUpNotification({silent:e}))}function Wh(e,{isSilent:t,shouldShowPreviews:n}){let s;s="contact"===e?new fe.jI.InputNotifyUsers:"group"===e?new fe.jI.InputNotifyChats:new fe.jI.InputNotifyBroadcasts;const i={showPreviews:n,silent:t,muteUntil:t?E:0};return xc(new fe.jI.account.UpdateNotifySettings({peer:s,settings:new fe.jI.InputPeerNotifySettings(i)}))}async function Kh({langPack:e,langCode:t}){const n=await xc(new fe.jI.langpack.GetLangPack({langPack:e,langCode:t}));if(!n)return;const{strings:s,keysToRemove:i}=Ur(n.strings);return{version:n.version,strings:s,keysToRemove:i}}async function Jh({langPack:e,langCode:t,fromVersion:n}){const s=await xc(new fe.jI.langpack.GetDifference({langPack:e,langCode:t,fromVersion:n}));if(!s)return;const{strings:i,keysToRemove:o}=Ur(s.strings);return{version:s.version,strings:i,keysToRemove:o}}async function Qh(){const e=await xc(new fe.jI.langpack.GetLanguages({langPack:K}));if(e)return e.map(xr)}async function Yh({langPack:e,langCode:t}){const n=await xc(new fe.jI.langpack.GetLanguage({langPack:e,langCode:t}));if(n)return xr(n)}async function Xh({langPack:e,langCode:t,keys:n}){const s=await xc(new fe.jI.langpack.GetStrings({langPack:e,langCode:t,keys:n}));if(s)return Ur(s)}async function Zh({sourceLangPacks:e,langCode:t}){const n=(await Promise.all(e.map((e=>xc(new fe.jI.langpack.GetLangPack({langPack:e,langCode:Ph.includes(t)?`${t}-raw`:t})))))).filter(Boolean).map(Dr);if(n.length)return{langPack:Object.assign({},...n.reverse())}}async function ep(e){const t=xi(e),n=await xc(new fe.jI.account.GetPrivacy({key:t}));if(n)return{rules:_o(n.rules)}}function tp(e){const t=Mc.session.getAuthKey().getKey();return xc(new fe.jI.account.RegisterDevice({tokenType:10,secret:t,appSandbox:!1,otherUids:[],token:e}))}function np(e){return xc(new fe.jI.account.UnregisterDevice({tokenType:10,otherUids:[],token:e}))}async function sp(e,t){const n=xi(e),s=Ki(t),i=await xc(new fe.jI.account.SetPrivacy({key:n,rules:s}));if(i)return{rules:_o(i.rules)}}async function ip(e){await xc(new fe.jI.account.UpdateStatus({offline:!e}))}async function op(){const e=await xc(new fe.jI.account.GetContentSettings);if(e)return{isSensitiveEnabled:Boolean(e.sensitiveEnabled),canChangeSensitive:Boolean(e.sensitiveCanChange)}}function ap(e){return xc(new fe.jI.account.SetContentSettings({sensitiveEnabled:e||void 0}))}async function rp(e){const t=await xc(new fe.jI.help.GetAppConfig({hash:e}));if(!t||t instanceof fe.jI.help.AppConfigNotModified)return;const{config:n,hash:s}=t;return function(e,t){const n=Rr(e);return{emojiSounds:jh(n),seenByMaxChatMembers:n.chat_read_mark_size_threshold,seenByExpiresAt:n.chat_read_mark_expire_period,readDateExpiresAt:n.pm_read_date_expire_period,autologinDomains:n.autologin_domains||[],urlAuthDomains:n.url_auth_domains||[],maxUniqueReactions:n.reactions_uniq_max??ie,premiumBotUsername:n.premium_bot_username,premiumInvoiceSlug:n.premium_invoice_slug,premiumPromoOrder:n.premium_promo_order,isPremiumPurchaseBlocked:n.premium_purchase_blocked,isGiveawayGiftsPurchaseAvailable:n.giveaway_gifts_purchase_available,defaultEmojiStatusesStickerSetId:n.default_emoji_statuses_stickerset_id,topicsPinnedLimit:n.topics_pinned_limit,maxUserReactionsDefault:n.reactions_user_max_default,maxUserReactionsPremium:n.reactions_user_max_premium,hiddenMembersMinCount:n.hidden_members_group_size_min,giveawayAddPeersMax:n.giveaway_add_peers_max,giveawayBoostsPerPremium:n.giveaway_boosts_per_premium,giveawayCountriesMax:n.giveaway_countries_max,boostsPerSentGift:n.boosts_per_sent_gift,canDisplayAutoarchiveSetting:n.autoarchive_setting_available,limits:{uploadMaxFileparts:Ch(n,"upload_max_fileparts","uploadMaxFileparts"),stickersFaved:Ch(n,"stickers_faved_limit","stickersFaved"),savedGifs:Ch(n,"saved_gifs_limit","savedGifs"),dialogFiltersChats:Ch(n,"dialog_filters_chats_limit","dialogFiltersChats"),dialogFilters:Ch(n,"dialog_filters_limit","dialogFilters"),dialogFolderPinned:Ch(n,"dialogs_pinned_limit","dialogFolderPinned"),captionLength:Ch(n,"caption_length_limit","captionLength"),channels:Ch(n,"channels_limit","channels"),channelsPublic:Ch(n,"channels_public_limit","channelsPublic"),aboutLength:Ch(n,"about_length_limit","aboutLength"),chatlistInvites:Ch(n,"chatlist_invites_limit","chatlistInvites"),chatlistJoined:Ch(n,"chatlist_joined_limit","chatlistJoined"),recommendedChannels:Ch(n,"recommended_channels_limit","recommendedChannels"),savedDialogsPinned:Ch(n,"saved_dialogs_pinned_limit","savedDialogsPinned")},hash:t,areStoriesHidden:n.stories_all_hidden,storyExpirePeriod:n.story_expire_period??ne,storyViewersExpirePeriod:n.story_viewers_expire_period??se,storyChangelogUserId:n.stories_changelog_user_id?.toString()??J,maxPinnedStoriesCount:n.stories_pinned_to_top_count_max,groupTranscribeLevelMin:n.group_transcribe_level_min,canLimitNewMessagesWithoutPremium:n.new_noncontact_peers_require_premium_without_ownpremium,bandwidthPremiumNotifyPeriod:n.upload_premium_speedup_notify_period,bandwidthPremiumUploadSpeedup:n.upload_premium_speedup_upload,bandwidthPremiumDownloadSpeedup:n.upload_premium_speedup_download,channelRestrictAdsLevelMin:n.channel_restrict_sponsored_level_min,paidReactionMaxAmount:n.stars_paid_reaction_amount_max,isChannelRevenueWithdrawalEnabled:n.channel_revenue_withdrawal_enabled,isStarsGiftEnabled:n.stars_gifts_enabled,starGiftMaxMessageLength:n.stargifts_message_length_max,starGiftMaxConvertPeriod:n.stargifts_convert_period_max,starRefStartPrefixes:n.starref_start_param_prefixes}}(n,s)}async function dp(){const e=await xc(new fe.jI.help.GetConfig);if(e)return function(e){const{testMode:t,expires:n,gifSearchUsername:s,chatSizeMax:i,autologinToken:o,reactionsDefault:a,messageLengthMax:r,editTimeLimit:d,forwardedCountMax:c}=e;return{isTestServer:t,expiresAt:n,gifSearchUsername:s,defaultReaction:a&&ra(a),maxGroupSize:i,autologinToken:o,maxMessageLength:r,editTimeLimit:d,maxForwardedCount:c}}(e)}async function cp(e){const t=await xc(new fe.jI.help.GetPeerColors({hash:e}));if(!t)return;const n=function(e){if(e instanceof fe.jI.help.PeerColors)return ri(e.colors,(e=>[e.colorId,{isHidden:e.hidden,colors:e.colors&&Nr(e.colors),darkColors:e.darkColors&&Nr(e.darkColors)}]))}(t);return n?{colors:n,hash:t instanceof fe.jI.help.PeerColors?t.hash:void 0}:void 0}async function up(e){const t=await xc(new fe.jI.help.GetTimezonesList({hash:e}));if(t&&!(t instanceof fe.jI.help.TimezonesListNotModified))return{timezones:t.timezones.map(Br),hash:t.hash}}async function lp({langCode:e="en"}){const t=await xc(new fe.jI.help.GetCountriesList({langCode:e}));if(t instanceof fe.jI.help.CountriesList)return function(e){const t=e.filter((({hidden:e})=>!e));return{phoneCodes:t.map((e=>e.countryCodes.map((t=>Ar(e,t))))).flat().sort(((e,t)=>e.name?e.name.localeCompare(t.name):e.defaultName.localeCompare(t.defaultName))),general:t.map((e=>Ar(e,e.countryCodes[0]))).sort(((e,t)=>e.name?e.name.localeCompare(t.name):e.defaultName.localeCompare(t.defaultName)))}}(t.countries)}async function fp(){const e=await xc(new fe.jI.account.GetGlobalPrivacySettings);if(e)return{shouldArchiveAndMuteNewNonContact:Boolean(e.archiveAndMuteNewNoncontactPeers),shouldHideReadMarks:Boolean(e.hideReadMarks),shouldNewNonContactPeersRequirePremium:Boolean(e.newNoncontactPeersRequirePremium)}}async function hp({shouldArchiveAndMuteNewNonContact:e,shouldHideReadMarks:t,shouldNewNonContactPeersRequirePremium:n}){const s=await xc(new fe.jI.account.SetGlobalPrivacySettings({settings:new fe.jI.GlobalPrivacySettings({...e&&{archiveAndMuteNewNoncontactPeers:!0},...t&&{hideReadMarks:!0},...n&&{newNoncontactPeersRequirePremium:!0}})}));if(s)return{shouldArchiveAndMuteNewNonContact:Boolean(s.archiveAndMuteNewNoncontactPeers),shouldHideReadMarks:Boolean(s.hideReadMarks),shouldNewNonContactPeersRequirePremium:Boolean(s.newNoncontactPeersRequirePremium)}}function pp({chatId:e,accessHash:t,username:n,isActive:s}){return xc(e?new fe.jI.channels.ToggleUsername({channel:vi(e,t),username:n,active:s}):new fe.jI.account.ToggleUsername({username:n,active:s}))}function mp({chatId:e,accessHash:t,usernames:n}){return xc(e?new fe.jI.channels.ReorderUsernames({channel:vi(e,t),order:n}):new fe.jI.account.ReorderUsernames({order:n}))}const gp={};async function Ip(){const e=await xc(new fe.jI.account.GetPassword);if(!e)return;const{hint:t,hasPassword:n}=e;return{hint:t,hasPassword:n}}function wp(e){return zs({"@type":"updateTwoFaStateWaitCode",length:e}),new Promise(((e,t)=>{gp.resolve=e,gp.reject=t}))}function yp(e,t){try{return function(e,t){return Mc.getTmpPassword(e,t)}(e,t)}catch(e){if(!Ts(e))return;return Promise.resolve(ks(e))}}function vp(e){try{return t=e,Mc.getCurrentPassword(t)}catch(e){if(!Ts(e))return;return Promise.resolve(ks(e))}var t}async function bp(e){try{return await Gc({isCheckPassword:!0,currentPassword:e}),!0}catch(e){return _p(e),!1}}async function Sp(e){try{return await Gc({currentPassword:e}),!0}catch(e){return _p(e),!1}}async function jp(e,t,n,s){try{return await Gc({currentPassword:e,newPassword:t,hint:n,email:s,emailCodeCallback:wp,onEmailCodeError:_p}),!0}catch(e){return _p(e),!1}}async function Cp(e,t){try{return await Gc({currentPassword:e,newPassword:e,email:t,emailCodeCallback:wp,onEmailCodeError:_p}),!0}catch(e){return _p(e),!1}}function Pp(e){gp.resolve(e)}function _p(e){zs({"@type":"updateTwoFaError",messageKey:ks(e).messageKey})}async function Mp({chatId:e,accessHash:t,messageId:n,data:s,isGame:i}){const o=await xc(new fe.jI.messages.GetBotCallbackAnswer({peer:wi(e,t),msgId:n,data:s?_s(s):void 0,game:i||void 0}));return o?Es(o):void 0}async function Tp(){const e=await xc(new fe.jI.contacts.GetTopPeers({botsInline:!0}));if(e instanceof fe.jI.contacts.TopPeers)return{ids:e.users.map(Va).filter(Boolean).map((({id:e})=>e))}}async function kp(){const e=await xc(new fe.jI.contacts.GetTopPeers({botsApp:!0}));if(e instanceof fe.jI.contacts.TopPeers)return{ids:e.users.map(Va).filter(Boolean).map((({id:e})=>e))}}async function Ap({username:e}){const t=await xc(new fe.jI.contacts.ResolveUsername({username:e}));if(t&&t.users[0]instanceof fe.jI.User&&t.users[0].bot&&t.users[0].botInlinePlaceholder)return so(t.users[0]),{user:Va(t.users[0]),chat:er(t.users[0])}}async function Rp({bot:e,chat:t,query:n,offset:s=""}){const i=await xc(new fe.jI.messages.GetInlineBotResults({bot:wi(e.id,e.accessHash),peer:wi(t.id,t.accessHash),query:n,offset:s}));var o,a,r,d,c,u;if(i)return{isGallery:Boolean(i.gallery),help:e.botPlaceholder,nextOffset:(c=e.usernames[0].username,u=i.nextOffset,"gif"===c&&"0"===u?"":u),switchPm:(d=i.switchPm,d?di(d,["text","startParam"]):void 0),switchWebview:(r=i.switchWebview,r?di(r,["text","url"]):void 0),results:(o=String(i.queryId),a=i.results,a.map((e=>e instanceof fe.jI.BotInlineMediaResult?(e.document instanceof fe.jI.Document&&eo(e.document),e.photo instanceof fe.jI.Photo&&Zi(e.photo),function(e,t){const{id:n,type:s,title:i,description:o,photo:a,document:r}=e;return{id:n,queryId:t,type:s,title:i,description:o,..."sticker"===s&&r instanceof fe.jI.Document&&{sticker:Do(r)},...a instanceof fe.jI.Photo&&{photo:bo(a)},..."gif"===s&&r instanceof fe.jI.Document&&{gif:zo(r)},..."video"===s&&r instanceof fe.jI.Document&&{thumbnail:yo(r.thumbs)}}}(e,o)):(e.thumb&&io(e.thumb),function(e,t){const{id:n,type:s,title:i,description:o,url:a,thumb:r}=e;return{id:n,queryId:t,type:s,title:i,description:o,url:a,webThumbnail:ea(r)}}(e,o))))),cacheTime:i.cacheTime}}async function Ep({chat:e,replyInfo:t,resultId:n,queryId:s,sendAs:i,isSilent:o,scheduleDate:a}){const r=Pi();await xc(new fe.jI.messages.SendInlineBotResult({clearDraft:!0,randomId:r,queryId:vt()(s),peer:wi(e.id,e.accessHash),id:n,scheduleDate:a,replyTo:t&&Wi(t),...o&&{silent:!0},...i&&{sendAs:wi(i.id,i.accessHash)}}))}async function Dp({bot:e,startParam:t}){const n=Pi();await xc(new fe.jI.messages.StartBot({bot:wi(e.id,e.accessHash),peer:wi(e.id,e.accessHash),randomId:n,startParam:t}))}async function Up({isSilent:e,peer:t,bot:n,url:s,startParam:i,replyInfo:o,theme:a,sendAs:r,isFromBotMenu:d,isFullscreen:c}){const u=await xc(new fe.jI.messages.RequestWebView({silent:e||void 0,peer:wi(t.id,t.accessHash),bot:wi(n.id,n.accessHash),url:s,startParam:i,themeParams:a?Bi(a):void 0,fromBotMenu:d||void 0,platform:W,replyTo:o&&Wi(o),fullscreen:!!c||void 0,...r&&{sendAs:wi(r.id,r.accessHash)}}));if(u instanceof fe.jI.WebViewResultUrl)return{url:u.url,queryId:u.queryId?.toString(),isFullScreen:Boolean(u.fullscreen)}}async function xp({peer:e,bot:t,startParam:n,mode:s,theme:i}){const o=await xc(new fe.jI.messages.RequestMainWebView({peer:wi(e.id,e.accessHash),bot:wi(t.id,t.accessHash),startParam:n,fullscreen:"fullscreen"===s||void 0,themeParams:i?Bi(i):void 0,platform:W}));if(o instanceof fe.jI.WebViewResultUrl)return{url:o.url,queryId:o.queryId?.toString(),isFullscreen:Boolean(o.fullscreen)}}async function Np({bot:e,url:t,theme:n,startParam:s,isFromSwitchWebView:i,isFromSideMenu:o}){const a=await xc(new fe.jI.messages.RequestSimpleWebView({url:t,bot:wi(e.id,e.accessHash),themeParams:n?Bi(n):void 0,platform:W,startParam:s,fromSwitchWebview:i||void 0,fromSideMenu:o||void 0}));return a?.url}async function Bp({bot:e,appName:t}){const n=await xc(new fe.jI.messages.GetBotApp({app:new fe.jI.InputBotAppShortName({botId:vi(e.id,e.accessHash),shortName:t})}));if(n&&!(n instanceof fe.jI.BotAppNotModified))return function(e){const{app:t,inactive:n,requestWriteAccess:s}=e,i=function(e){if(e instanceof fe.jI.BotAppNotModified)return;const{id:t,accessHash:n,title:s,description:i,shortName:o,photo:a,document:r}=e,d=a instanceof fe.jI.Photo?bo(a):void 0,c=r instanceof fe.jI.Document?$o(r):void 0;return{id:t.toString(),accessHash:n.toString(),title:s,description:i,shortName:o,photo:d,document:c}}(t);if(i)return{...i,isInactive:n,shouldRequestWriteAccess:s}}(n)}async function Hp({peer:e,app:t,startParam:n,mode:s,theme:i,isWriteAllowed:o}){const a=await xc(new fe.jI.messages.RequestAppWebView({peer:wi(e.id,e.accessHash),app:$i(t),startParam:n,themeParams:i?Bi(i):void 0,platform:W,writeAllowed:o||void 0,fullscreen:"fullscreen"===s||void 0}));return{url:a?.url,isFullscreen:Boolean(a?.fullscreen)}}function Gp({isSilent:e,peer:t,bot:n,queryId:s,replyInfo:i,sendAs:o}){return xc(new fe.jI.messages.ProlongWebView({silent:e||void 0,peer:wi(t.id,t.accessHash),bot:wi(n.id,n.accessHash),queryId:vt()(s),replyTo:i&&Wi(i),...o&&{sendAs:wi(o.id,o.accessHash)}}))}async function Op({bot:e,buttonText:t,data:n}){const s=Pi();await xc(new fe.jI.messages.SendWebViewData({bot:wi(e.id,e.accessHash),buttonText:t,data:n,randomId:s}))}async function qp({hash:e}){const t=await xc(new fe.jI.messages.GetAttachMenuBots({hash:e?vt()(e):void 0}));if(t instanceof fe.jI.AttachMenuBots)return{hash:t.hash.toString(),bots:ai(t.bots.map(xa),"id")}}async function Fp({bot:e}){const t=await xc(new fe.jI.messages.GetAttachMenuBot({bot:wi(e.id,e.accessHash)}));if(t instanceof fe.jI.AttachMenuBotsBot)return{bot:xa(t.bot)}}function Lp({bot:e,isWriteAllowed:t,isEnabled:n}){return xc(new fe.jI.messages.ToggleBotInAttachMenu({bot:wi(e.id,e.accessHash),writeAllowed:t||void 0,enabled:n}))}async function zp({chat:e,buttonId:t,messageId:n}){const s=await xc(new fe.jI.messages.RequestUrlAuth({peer:wi(e.id,e.accessHash),buttonId:t,msgId:n}));if(!s)return;const i=Er(s);return"request"===i?.type&&zs({"@type":"updateUser",id:i.bot.id,user:i.bot}),i}async function Vp({chat:e,messageId:t,buttonId:n,isWriteAllowed:s}){const i=await xc(new fe.jI.messages.AcceptUrlAuth({peer:wi(e.id,e.accessHash),msgId:t,buttonId:n,writeAllowed:s||void 0}));if(!i)return;const o=Er(i);return"request"===o?.type&&zs({"@type":"updateUser",id:o.bot.id,user:o.bot}),o}async function $p({url:e}){const t=await xc(new fe.jI.messages.RequestUrlAuth({url:e}));if(!t)return;const n=Er(t);return"request"===n?.type&&zs({"@type":"updateUser",id:n.bot.id,user:n.bot}),n}async function Wp({url:e,isWriteAllowed:t}){const n=await xc(new fe.jI.messages.AcceptUrlAuth({url:e,writeAllowed:t||void 0}));if(!n)return;const s=Er(n);return"request"===s?.type&&zs({"@type":"updateUser",id:s.bot.id,user:s.bot}),s}function Kp({bot:e}){return xc(new fe.jI.bots.CanSendMessage({bot:vi(e.id,e.accessHash)}))}function Jp({bot:e}){return xc(new fe.jI.bots.AllowSendMessage({bot:vi(e.id,e.accessHash)}),{shouldReturnTrue:!0})}async function Qp({bot:e,customMethod:t,parameters:n}){try{const s=await xc(new fe.jI.bots.InvokeWebViewCustomMethod({bot:wi(e.id,e.accessHash),params:new fe.jI.DataJSON({data:n}),customMethod:t}),{shouldThrow:!0});return{result:JSON.parse(s.data)}}catch(e){return{error:e.message}}}async function Yp({bot:e}){const t=await xc(new fe.jI.bots.GetPreviewMedias({bot:wi(e.id,e.accessHash)}));if(t)return t.map((e=>({content:Lo(e.media),date:e.date})))}function Xp({bot:e,fileName:t,url:n}){return xc(new fe.jI.bots.CheckDownloadFileParams({bot:wi(e.id,e.accessHash),fileName:t,url:n}),{shouldReturnTrue:!0})}function Zp({bot:e,isEnabled:t}){return xc(new fe.jI.bots.ToggleUserEmojiStatusPermission({bot:wi(e.id,e.accessHash),enabled:t}),{shouldReturnTrue:!0})}function em({bot:e,langCode:t,name:n,about:s,description:i}){return xc(new fe.jI.bots.SetBotInfo({bot:wi(e.id,e.accessHash),langCode:t,name:n||"",about:s||"",description:i||""}),{shouldReturnTrue:!0})}async function tm({offset:e="",limit:t}){const n=await xc(new fe.jI.bots.GetPopularAppBots({offset:e,limit:t}));if(n)return{peerIds:n.users.map(Va).filter(Boolean).map((({id:e})=>e)),nextOffset:n.nextOffset}}async function nm({user:e}){if(!e)return;const t=vi(e.id,e.accessHash),n=await xc(new fe.jI.bots.GetBotRecommendations({bot:t}));if(!n)return;const s=n?.users.map(Va).filter(Boolean);return{similarBots:s,count:n instanceof fe.jI.users.UsersSlice?n.count:s.length}}var sm=n(48287).hp;async function im({call:e}){const t=await xc(new fe.jI.phone.GetGroupCall({call:Gi(e)}));if(t)return{groupCall:co(t.call)}}function om({call:e}){return xc(new fe.jI.phone.DiscardGroupCall({call:Gi(e)}),{shouldReturnTrue:!0})}function am({call:e,participant:t,muted:n,presentationPaused:s,videoStopped:i,videoPaused:o,volume:a,raiseHand:r}){return xc(new fe.jI.phone.EditGroupCallParticipant({call:Gi(e),participant:wi(t.id,t.accessHash),...void 0!==i&&{videoStopped:i},...void 0!==o&&{videoPaused:o},...void 0!==n&&{muted:n},...void 0!==s&&{presentationPaused:s},...void 0!==r&&{raiseHand:r},...void 0!==a&&{volume:a}}),{shouldReturnTrue:!0})}function rm({groupCall:e,title:t}){return xc(new fe.jI.phone.EditGroupCallTitle({title:t,call:Gi(e)}),{shouldReturnTrue:!0})}async function dm({call:e,canSelfUnmute:t}){const n=await xc(new fe.jI.phone.ExportGroupCallInvite({canSelfUnmute:t||void 0,call:Gi(e)}));if(n)return n.link}async function cm({call:e,offset:t}){const n=await xc(new fe.jI.phone.GetGroupParticipants({call:Gi(e),ids:[],sources:[],offset:t||"",limit:v}));n&&zs({"@type":"updateGroupCallParticipants",groupCallId:e.id,participants:n.participants.map(oo),nextOffset:n.nextOffset})}function um({call:e,isPageUnload:t}){const n=new fe.jI.phone.LeaveGroupCall({call:Gi(e)});t?Nc(n):xc(n,{shouldReturnTrue:!0})}async function lm({call:e,inviteHash:t,params:n}){const s=await xc(new fe.jI.phone.JoinGroupCall({call:Gi(e),joinAs:new fe.jI.InputPeerSelf,muted:!0,videoStopped:!0,params:new fe.jI.DataJSON({data:JSON.stringify(n)}),inviteHash:t}),{shouldRetryOnTimeout:!0,abortControllerGroup:"call"});if(s&&s instanceof fe.jI.Updates){const e=s.updates.find((e=>e instanceof fe.jI.UpdateGroupCall));if(!(e instanceof fe.jI.UpdateGroupCall))return;return co(e.call)}}async function fm({peer:e}){const t=Mi(),n=await xc(new fe.jI.phone.CreateGroupCall({peer:wi(e.id,e.accessHash),randomId:t}));if(n&&n instanceof fe.jI.Updates){const e=n.updates[0];if(e instanceof fe.jI.UpdateGroupCall)return co(e.call)}}function hm({call:e,params:t}){return xc(new fe.jI.phone.JoinGroupCallPresentation({call:Gi(e),params:new fe.jI.DataJSON({data:JSON.stringify(t)})}),{shouldReturnTrue:!0})}function pm({call:e,subscribed:t}){return xc(new fe.jI.phone.ToggleGroupCallStartSubscription({call:Gi(e),subscribed:t}),{shouldReturnTrue:!0,shouldIgnoreErrors:!0})}function mm({call:e}){return xc(new fe.jI.phone.LeaveGroupCallPresentation({call:Gi(e)}),{shouldReturnTrue:!0})}async function gm(){const e=await xc(new fe.jI.messages.GetDhConfig({}));if(e&&!(e instanceof fe.jI.messages.DhConfigNotModified))return{g:e.g,p:Array.from(e.p),random:Array.from(e.random)}}function Im({call:e,isBusy:t,isPageUnload:n}){const s=new fe.jI.phone.DiscardCall({peer:Oi(e),reason:t?new fe.jI.PhoneCallDiscardReasonBusy:new fe.jI.PhoneCallDiscardReasonHangup});n?Nc(s):xc(s,{shouldReturnTrue:!0})}async function wm({user:e,gAHash:t,isVideo:n}){const s=await xc(new fe.jI.phone.RequestCall({randomId:Mi(),userId:wi(e.id,e.accessHash),gAHash:sm.from(t),...n&&{video:!0},protocol:po()}));if(s)return zs({"@type":"updatePhoneCall",call:uo(s.phoneCall)}),!0}function ym({call:e,rating:t,comment:n}){return xc(new fe.jI.phone.SetCallRating({rating:t,peer:Oi(e),comment:n}),{shouldReturnTrue:!0})}function vm({call:e}){return xc(new fe.jI.phone.ReceivedCall({peer:Oi(e)}))}async function bm({call:e,gB:t}){const n=await xc(new fe.jI.phone.AcceptCall({peer:Oi(e),gB:sm.from(t),protocol:po()}));if(n)return zs({"@type":"updatePhoneCall",call:e=uo(n.phoneCall)}),!0}async function Sm({call:e,gA:t,keyFingerprint:n}){const s=await xc(new fe.jI.phone.ConfirmCall({peer:Oi(e),gA:sm.from(t),keyFingerprint:vt()(n),protocol:po()}));if(s)return zs({"@type":"updatePhoneCall",call:e=uo(s.phoneCall)}),!0}function jm({data:e,call:t}){return xc(new fe.jI.phone.SendSignalingData({data:sm.from(e),peer:Oi(t)}))}function Cm({chat:e,emoticon:t}){return xc(new fe.jI.messages.SetTyping({peer:wi(e.id,e.accessHash),action:new fe.jI.SendMessageEmojiInteractionSeen({emoticon:t})}),{abortControllerChatId:e.id})}function Pm({chat:e,emoticon:t,messageId:n,timestamps:s}){return xc(new fe.jI.messages.SetTyping({peer:wi(e.id,e.accessHash),action:new fe.jI.SendMessageEmojiInteraction({emoticon:t,msgId:n,interaction:new fe.jI.DataJSON({data:JSON.stringify({v:1,a:s.map((e=>({t:e,i:1})))})})})}),{abortControllerChatId:e.id})}async function _m(){const e=await xc(new fe.jI.messages.GetAvailableReactions({}));if(e&&!(e instanceof fe.jI.messages.AvailableReactionsNotModified))return e.reactions.forEach((e=>{e.staticIcon instanceof fe.jI.Document&&(qs.documents[String(e.staticIcon.id)]=e.staticIcon),e.selectAnimation instanceof fe.jI.Document&&(qs.documents[String(e.selectAnimation.id)]=e.selectAnimation),e.aroundAnimation instanceof fe.jI.Document&&(qs.documents[String(e.aroundAnimation.id)]=e.aroundAnimation),e.appearAnimation instanceof fe.jI.Document&&(qs.documents[String(e.appearAnimation.id)]=e.appearAnimation),e.centerIcon instanceof fe.jI.Document&&(qs.documents[String(e.centerIcon.id)]=e.centerIcon)})),e.reactions.map(ca)}async function Mm(){const e=await xc(new fe.jI.messages.GetAvailableEffects({}));if(!e||e instanceof fe.jI.messages.AvailableEffectsNotModified)return;const t=new Map(e.documents.map((e=>[String(e.id),e])));e.documents.forEach((e=>{e instanceof fe.jI.Document&&(qs.documents[String(e.id)]=e)}));const n=e.effects.map(ua),s=[],i=[];for(const e of n)if(e.effectAnimationId){const n=t.get(e.effectStickerId),s=n&&Do(n,!1,e.isPremium);s&&i.push(s)}else{const t=Do(qs.documents[e.effectStickerId]);t&&s.push(t)}return{effects:n,emojis:i,stickers:s}}function Tm({chat:e,messageId:t,reactions:n,shouldAddToRecent:s}){return xc(new fe.jI.messages.SendReaction({reaction:n?.map((e=>Li(e))),peer:wi(e.id,e.accessHash),msgId:t,...s&&{addToRecent:!0}}),{shouldReturnTrue:!0,shouldThrow:!0})}function km({chat:e,messageId:t,count:n,isPrivate:s}){return xc(new fe.jI.messages.SendPaidReaction({peer:wi(e.id,e.accessHash),msgId:t,randomId:_i(),count:n,private:s||void 0}),{shouldReturnTrue:!0,shouldThrow:!0})}function Am({ids:e,chat:t}){hi(e,S).forEach((e=>{xc(new fe.jI.messages.GetMessagesReactions({id:e,peer:wi(t.id,t.accessHash)}),{shouldReturnTrue:!0,abortControllerChatId:t.id})}))}async function Rm({chat:e,messageId:t,reaction:n,offset:s}){const i=await xc(new fe.jI.messages.GetMessageReactionsList({peer:wi(e.id,e.accessHash),id:t,...n&&{reaction:Li(n)},limit:_,...s&&{offset:s}}));if(!i)return;const{nextOffset:o,reactions:a,count:r}=i;return{nextOffset:o,reactions:a.map(aa).filter(Boolean),count:r}}function Em({reaction:e}){return xc(new fe.jI.messages.SetDefaultReaction({reaction:Li(e)}))}async function Dm({hash:e="0"}){const t=await xc(new fe.jI.messages.GetTopReactions({limit:C,hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.ReactionsNotModified))return{hash:String(t.hash),reactions:t.reactions.map((e=>ra(e))).filter(Boolean)}}async function Um({hash:e="0"}){const t=await xc(new fe.jI.messages.GetRecentReactions({limit:P,hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.ReactionsNotModified))return{hash:String(t.hash),reactions:t.reactions.map((e=>ra(e))).filter(Boolean)}}function xm(){return xc(new fe.jI.messages.ClearRecentReactions)}async function Nm({hash:e="0"}){const t=await xc(new fe.jI.messages.GetDefaultTagReactions({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.ReactionsNotModified))return{hash:String(t.hash),reactions:t.reactions.map((e=>ra(e))).filter(Boolean)}}async function Bm({hash:e="0"}){const t=await xc(new fe.jI.messages.GetSavedReactionTags({hash:vt()(e)}));if(t&&!(t instanceof fe.jI.messages.SavedReactionTagsNotModified))return{hash:String(t.hash),tags:t.tags.map(da).filter(Boolean)}}function Hm({reaction:e,title:t}){return xc(new fe.jI.messages.UpdateSavedReactionTag({reaction:Li(e),title:t}),{shouldReturnTrue:!0})}async function Gm({chat:e,dcId:t}){const n=await xc(new fe.jI.stats.GetBroadcastStats({channel:vi(e.id,e.accessHash)}),{dcId:t});var s;if(n)return{stats:(s=n,{growthGraph:Lr(s.growthGraph),followersGraph:Lr(s.followersGraph),muteGraph:Lr(s.muteGraph),topHoursGraph:Lr(s.topHoursGraph),languagesGraph:s.languagesGraph.token,viewsBySourceGraph:s.viewsBySourceGraph.token,newFollowersBySourceGraph:s.newFollowersBySourceGraph.token,interactionsGraph:s.interactionsGraph.token,reactionsByEmotionGraph:s.reactionsByEmotionGraph.token,storyInteractionsGraph:s.storyInteractionsGraph.token,storyReactionsByEmotionGraph:s.storyReactionsByEmotionGraph.token,followers:Vr(s.followers),viewsPerPost:Vr(s.viewsPerPost),sharesPerPost:Vr(s.sharesPerPost),enabledNotifications:$r(s.enabledNotifications),reactionsPerPost:Vr(s.reactionsPerPost),viewsPerStory:Vr(s.viewsPerStory),sharesPerStory:Vr(s.sharesPerStory),reactionsPerStory:Vr(s.reactionsPerStory),recentPosts:s.recentPostsInteractions.map(Gr).filter(Boolean)}),users:[]}}async function Om({peer:e,dcId:t}){const n=await xc(new fe.jI.stats.GetBroadcastRevenueStats({peer:wi(e.id,e.accessHash)}),{dcId:t});var s;if(n)return{topHoursGraph:Lr((s=n).topHoursGraph),revenueGraph:Lr(s.revenueGraph,void 0,!0,s.usdRate),balances:Kr(s.balances),usdRate:s.usdRate}}async function qm({chat:e,dcId:t}){const n=await xc(new fe.jI.stats.GetMegagroupStats({channel:vi(e.id,e.accessHash)}),{dcId:t});var s,i;if(n)return{stats:(s=n,{growthGraph:Lr(s.growthGraph),membersGraph:Lr(s.membersGraph),topHoursGraph:Lr(s.topHoursGraph),languagesGraph:s.languagesGraph.token,messagesGraph:s.messagesGraph.token,actionsGraph:s.actionsGraph.token,period:(i=s.period,{maxDate:i.maxDate,minDate:i.minDate}),members:Vr(s.members),viewers:Vr(s.viewers),messages:Vr(s.messages),posters:Vr(s.posters)})}}async function Fm({chat:e,messageId:t,dcId:n}){const s=await xc(new fe.jI.stats.GetMessageStats({channel:vi(e.id,e.accessHash),msgId:t}),{dcId:n});if(s)return Or(s)}async function Lm({chat:e,messageId:t,dcId:n,offset:s}){const i=await xc(new fe.jI.stats.GetMessagePublicForwards({channel:vi(e.id,e.accessHash),msgId:t,offset:s,limit:j}),{dcId:n});if(i)return{forwards:qr(i),count:i.count,nextOffset:i.nextOffset}}async function zm({token:e,x:t,isPercentage:n,dcId:s}){const i=await xc(new fe.jI.stats.LoadAsyncGraph({token:e,...t&&{x:vt()(t)}}),{dcId:s});if(i)return Lr(i,n)}async function Vm({chat:e,storyId:t,dcId:n}){const s=await xc(new fe.jI.stats.GetStoryStats({peer:wi(e.id,e.accessHash),id:t}),{dcId:n});if(s)return Or(s)}async function $m({chat:e,storyId:t,dcId:n,offset:s}){const i=await xc(new fe.jI.stats.GetStoryPublicForwards({peer:wi(e.id,e.accessHash),id:t,offset:s,limit:j}),{dcId:n});if(i)return{publicForwards:Fr(i),count:i.count,nextOffset:i.nextOffset}}async function Wm({peer:e,currentPassword:t}){try{const n=await vp(t);if(!n)return;if("error"in n)return n;const s=await xc(new fe.jI.stats.GetBroadcastRevenueWithdrawalUrl({peer:wi(e.id,e.accessHash),password:n}),{shouldThrow:!0});if(!s)return;return{url:s.url}}catch(e){if(!Ts(e))return;return ks(e)}}var Km=n(48287).hp;function Jm(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let Qm;class Ym{constructor(e){this.isOutgoing=e,Jm(this,"state",void 0),Jm(this,"seq",0),Jm(this,"gA",void 0),Jm(this,"gB",void 0),Jm(this,"p",void 0),Jm(this,"random",void 0),Jm(this,"waitForState",void 0),Jm(this,"resolveState",void 0),this.waitForState=new Promise((e=>{this.resolveState=e}))}async requestCall({p:e,g:t,random:n}){const s=(0,ze.op)(Km.from(e),!1),i=(0,ze.op)(Km.from(n),!1),o=(0,ze.gS)(vt()(t),i,s);this.gA=o,this.p=s,this.random=i;const a=await(0,ze.sc)((0,ze.ON)(o));return Array.from(a)}acceptCall({p:e,g:t,random:n}){const s=(0,ze.op)(e,!1),i=(0,ze.op)(n,!1),o=(0,ze.gS)(vt()(t),i,s);return this.gB=o,this.p=s,this.random=i,Array.from((0,ze.ON)(o))}async confirmCall(e,t,n){if(!this.random||!this.p)throw new Error("Values not set");this.isOutgoing?this.gB=(0,ze.op)(Km.from(e),!1):this.gA=(0,ze.op)(Km.from(e),!1);const s=(0,ze.gS)(this.isOutgoing?this.gB:this.gA,this.random,this.p),i=await(0,ze.e8)((0,ze.ON)(s)),o=(0,ze.op)(i.slice(-8).reverse(),!1),a=await async function(e,t,n,s){const i=await(0,ze.sc)(Km.concat([new Uint8Array(e),new Uint8Array(t)])),o=[],a=s.length-1;for(let e=0;e!==i.byteLength;e+=8){const t=(r=i.subarray(e,e+8),vt()(r[0]).and(127).shiftLeft(56).or(vt()(r[1]).shiftLeft(48)).or(vt()(r[2]).shiftLeft(40)).or(vt()(r[3]).shiftLeft(32)).or(vt()(r[4]).shiftLeft(24)).or(vt()(r[5]).shiftLeft(16)).or(vt()(r[6]).shiftLeft(8)).or(vt()(r[7]))).modPow(1,a).toJSNumber(),d=s[t],c=s[t+1]-d;o.push(String.fromCharCode(...n.subarray(d,d+c)))}var r;return o.join("")}((0,ze.ON)(s),(0,ze.ON)(this.gA),t,n),r=new Vt;return await r.setKey((0,ze.ON)(s)),this.state=new Gt(r,new st,!0,this.isOutgoing),this.resolveState(),{gA:Array.from((0,ze.ON)(this.gA)),keyFingerprint:o.toString(),emojis:a}}async encode(e){if(!this.state)return;const t=new Uint32Array(1);t[0]=this.seq++;const n=await this.state.encryptMessageData(Km.concat([(0,ze.Jk)(t),Km.from(e)]));return Array.from(n)}async decode(e){if(!this.state)return this.waitForState.then((()=>this.decode(e)));const t=await this.state.decryptMessageData(Km.from(e));return JSON.parse(t.toString())}}function Xm(e){Qm=new Ym(...e)}function Zm(){Qm=void 0}function eg(e){return Qm.encode(...e)}async function tg(e){if(Qm)return await Qm.decode(...e)}function ng(e){return Qm.confirmCall(...e)}function sg(e){return Qm.acceptCall(...e)}function ig(e){return Qm.requestCall(...e)}async function og({stateHash:e,isFirstRequest:t=!1,isHidden:n=!1}){const s=t?n?{hidden:!0}:{}:{state:e,next:!0,...n&&{hidden:!0}},i=await xc(new fe.jI.stories.GetAllStories(s));if(!i)return;if(i instanceof fe.jI.stories.AllStoriesNotModified)return{state:i.state,stealthMode:Ea(i.stealthMode)};const o=i.peerStories.reduce(((e,t)=>{const n=ms(t.peer),s=function(e){const t=ms(e.peer);return ri(e.stories,(e=>[e.id,ka(t,e)]))}(t),{profileIds:i,orderedIds:o,lastUpdatedAt:a}=Object.values(s).reduce(((e,t)=>("isInProfile"in t&&t.isInProfile&&e.profileIds.push(t.id),"isDeleted"in t||(e.orderedIds.push(t.id),e.lastUpdatedAt=Math.max(t.date,e.lastUpdatedAt||0)),e)),{profileIds:[],orderedIds:[],lastUpdatedAt:void 0});return 0===o.length||(e[n]={byId:s,orderedIds:o,profileIds:i,lastUpdatedAt:a,lastReadId:t.maxReadId}),e}),{});return i.peerStories.forEach((e=>e.stories.forEach((t=>Xi(t,ms(e.peer)))))),{peerStories:o,hasMore:i.hasMore,state:i.state,stealthMode:Ea(i.stealthMode)}}async function ag({peer:e}){const t=await xc(new fe.jI.stories.GetPeerStories({peer:wi(e.id,e.accessHash)}));if(!t)return;const n=ri(t.stories.stories,(t=>[t.id,ka(e.id,t)]));return t.stories.stories.forEach((t=>Xi(t,e.id))),{stories:n,lastReadStoryId:t.stories.maxReadId}}function rg({peer:e,offsetId:t}){return Sg({method:new fe.jI.stories.GetPinnedStories({peer:wi(e.id,e.accessHash),offsetId:t,limit:b}),peerId:e.id})}function dg({peer:e,offsetId:t}){return Sg({method:new fe.jI.stories.GetStoriesArchive({peer:e&&wi(e.id,e.accessHash),offsetId:t,limit:b}),peerId:e.id})}async function cg({peer:e,ids:t}){const n=await xc(new fe.jI.stories.GetStoriesByID({peer:wi(e.id,e.accessHash),id:t}));if(!n)return;const s=t.reduce(((t,s)=>{const i=n.stories.find((({id:e})=>e===s));return t[s]=i?ka(e.id,i):{id:s,peerId:e.id,isDeleted:!0},t}),{});return n.stories.forEach((t=>Xi(t,e.id))),{pinnedIds:n.pinnedToTop,stories:s}}function ug({peer:e,storyId:t}){return xc(new fe.jI.stories.IncrementStoryViews({peer:wi(e.id,e.accessHash),id:[t]}))}function lg({peer:e,storyId:t}){return xc(new fe.jI.stories.ReadStories({peer:wi(e.id,e.accessHash),maxId:t}))}function fg({peer:e,storyId:t}){return xc(new fe.jI.stories.DeleteStories({peer:wi(e.id,e.accessHash),id:[t]}))}function hg({peer:e,storyId:t,isInProfile:n}){return xc(new fe.jI.stories.TogglePinned({peer:wi(e.id,e.accessHash),id:[t],pinned:n}))}function pg({peer:e,storyIds:t}){return xc(new fe.jI.stories.TogglePinnedToTop({peer:wi(e.id,e.accessHash),id:t}))}async function mg({peer:e,storyId:t,areJustContacts:n,query:s,areReactionsFirst:i,limit:o=b,offset:a=""}){const r=await xc(new fe.jI.stories.GetStoryViewsList({peer:wi(e.id,e.accessHash),id:t,justContacts:n,q:s,reactionsFirst:i,limit:o,offset:a}));if(r)return{views:r.views.map(Ra).filter(Boolean),nextOffset:r.nextOffset,reactionsCount:r.reactionsCount,viewsCount:r.count}}async function gg({peer:e,storyIds:t}){const n=await xc(new fe.jI.stories.GetStoriesViews({peer:wi(e.id,e.accessHash),id:t}));if(n?.views[0])return{views:Aa(n.views[0])}}async function Ig({peer:e,storyId:t}){const n=await xc(new fe.jI.stories.ExportStoryLink({peer:wi(e.id,e.accessHash),id:t}));if(n)return n.link}async function wg({peer:e,storyId:t,description:n,option:s}){try{const i=await xc(new fe.jI.stories.Report({peer:wi(e.id,e.accessHash),id:[t],option:_s(s),message:n}),{shouldThrow:!0});if(!i)return;return{result:Ta(i),error:void 0}}catch(e){const t=e.message;if(t===V)return{result:void 0,error:t};throw e}}function yg({peer:e,id:t,privacy:n}){return xc(new fe.jI.stories.EditStory({peer:wi(e.id,e.accessHash),id:t,privacyRules:Ki(n)}),{shouldReturnTrue:!0})}function vg({peer:e,isHidden:t}){return xc(new fe.jI.stories.TogglePeerStoriesHidden({peer:wi(e.id,e.accessHash),hidden:t}))}function bg({peers:e}){return xc(new fe.jI.stories.GetPeerMaxIDs({id:e.map((e=>wi(e.id,e.accessHash)))}),{shouldIgnoreErrors:!0})}async function Sg({method:e,peerId:t}){const n=await xc(e);if(!n)return;const s=ri(n.stories,(e=>[e.id,ka(t,e)]));return n.stories.forEach((e=>Xi(e,t))),{stories:s,pinnedIds:n.pinnedToTop}}function jg({peer:e,storyId:t,reaction:n,shouldAddToRecent:s}){return xc(new fe.jI.stories.SendReaction({reaction:n?Li(n):new fe.jI.ReactionEmpty,peer:wi(e.id,e.accessHash),storyId:t,...s&&{addToRecent:!0}}),{shouldReturnTrue:!0})}function Cg({isForPast:e,isForFuture:t}){return xc(new fe.jI.stories.ActivateStealthMode({past:e,future:t}),{shouldReturnTrue:!0})}async function Pg({inputInvoice:e,requestInfo:t,shouldSave:n}){const s=await xc(new fe.jI.payments.ValidateRequestedInfo({invoice:Fi(e),save:n||void 0,info:Ui(t)}));if(!s)return;const{id:i,shippingOptions:o}=s;return i?{id:i,shippingOptions:Jr(o)}:void 0}async function _g({inputInvoice:e,formId:t,requestedInfoId:n,shippingOptionId:s,credentials:i,savedCredentialId:o,temporaryPassword:a,tipAmount:r}){const d=a&&o?new fe.jI.InputPaymentCredentialsSaved({id:o,tmpPassword:_s(a)}):new fe.jI.InputPaymentCredentials({save:i.save,data:new fe.jI.DataJSON({data:JSON.stringify(i.data)})}),c=await xc(new fe.jI.payments.SendPaymentForm({formId:vt()(t),invoice:Fi(e),requestedInfoId:n,shippingOptionId:s,credentials:d,...r&&{tipAmount:vt()(r)}}));return!!c&&(c instanceof fe.jI.payments.PaymentVerificationNeeded?void zs({"@type":"updatePaymentVerificationNeeded",url:c.url}):(Uc(c.updates),Boolean(c)))}async function Mg({formId:e,inputInvoice:t}){const n=await xc(new fe.jI.payments.SendStarsForm({formId:vt()(e),invoice:Fi(t)}));if(n){if(!(n instanceof fe.jI.payments.PaymentVerificationNeeded)){if(Uc(n.updates),"chatInviteSubscription"===t.type){const e="updates"in n.updates?n.updates.updates:void 0,t=e?.find((e=>e instanceof fe.jI.UpdateChannel))?.channelId;if(!t)return;return{channelId:ps(t,"channel")}}return{completed:!0}}d&&console.warn("Unexpected PaymentVerificationNeeded in sendStarsForm")}}async function Tg(e,t){try{const n=await xc(new fe.jI.payments.GetPaymentForm({invoice:Fi(e),themeParams:t?Bi(t):void 0}),{shouldThrow:!0});if(!n)return;return function(e){if(e instanceof fe.jI.payments.PaymentFormStarGift){const{formId:t}=e;return{type:"stargift",formId:String(t),invoice:Yr(e.invoice)}}if(e instanceof fe.jI.payments.PaymentFormStars){const{botId:t,formId:n,title:s,description:i,photo:o}=e;return o&&io(o),{type:"stars",botId:ps(t,"user"),formId:String(n),title:s,description:i,photo:ea(o),invoice:Yr(e.invoice)}}const{formId:t,canSaveCredentials:n,passwordMissing:s,providerId:i,nativeProvider:o,nativeParams:a,savedInfo:r,invoice:d,savedCredentials:c,url:u,botId:l,description:f,title:h,photo:p}=e;p&&io(p);const{shippingAddress:m}=r||{},g=r?Es(r):void 0;g&&m&&(g.shippingAddress=Es(m));const I=a?JSON.parse(a.data):{};return{type:"regular",title:h,description:f,photo:ea(p),url:u,botId:ps(l,"user"),canSaveCredentials:n,isPasswordMissing:s,formId:String(t),providerId:String(i),nativeProvider:o,savedInfo:g,invoice:Yr(d),nativeParams:{needCardholderName:Boolean(I?.need_cardholder_name),needCountry:Boolean(I?.need_country),needZip:Boolean(I?.need_zip),publishableKey:I?.publishable_key,publicToken:I?.public_token,tokenizeUrl:I?.tokenize_url},savedCredentials:c&&(w=c,w.map((({id:e,title:t})=>({id:e,title:t}))))};var w}(n)}catch(e){return e instanceof Error?(zs({"@type":"error",error:{message:e.message,hasErrorKey:!0}}),{error:e.message}):void 0}}async function kg(e,t){const n=await xc(new fe.jI.payments.GetPaymentReceipt({peer:wi(e.id,e.accessHash),msgId:t}));if(n)return{receipt:Qr(n)}}async function Ag(){const e=await xc(new fe.jI.help.GetPremiumPromo);if(e)return e.videos.forEach((e=>{e instanceof fe.jI.Document&&(qs.documents[e.id.toString()]=e)})),{promo:Xr(e)}}async function Rg(e){const t=await yp(e);if(t)return"error"in t?t:{value:Ps(t.tmpPassword),validUntil:t.validUntil}}async function Eg(){const e=await xc(new fe.jI.premium.GetMyBoosts);if(e)return{boosts:e.myBoosts.map(td)}}async function Dg({chat:e,slots:t}){const n=await xc(new fe.jI.premium.ApplyBoost({peer:wi(e.id,e.accessHash),slots:t}));if(n)return{boosts:n.myBoosts.map(td)}}async function Ug({chat:e}){const t=await xc(new fe.jI.premium.GetBoostsStatus({peer:wi(e.id,e.accessHash)}));if(t)return function(e){const{level:t,boostUrl:n,boosts:s,giftBoosts:i,myBoost:o,currentLevelBoosts:a,nextLevelBoosts:r,premiumAudience:d,prepaidGiveaways:c}=e;return{level:t,currentLevelBoosts:a,boosts:s,hasMyBoost:Boolean(o),boostUrl:n,giftBoosts:i,nextLevelBoosts:r,...d&&{premiumSubscribers:$r(d)},...c&&{prepaidGiveaways:c.map((e=>{return(t=e)instanceof fe.jI.PrepaidGiveaway?{type:"giveaway",id:t.id.toString(),date:t.date,months:t.months,quantity:t.quantity}:{type:"starsGiveaway",id:t.id.toString(),stars:t.stars.toJSNumber(),quantity:t.quantity,boosts:t.boosts,date:t.date};var t}))}}}(t)}async function xg({chat:e,isGifts:t,offset:n="",limit:s}){const i=await xc(new fe.jI.premium.GetBoostsList({peer:wi(e.id,e.accessHash),gifts:t||void 0,offset:n,limit:s}));if(!i)return;const o=i.boosts.map(ed);return{count:i.count,boostList:o,nextOffset:i.nextOffset}}async function Ng({peer:e,messageId:t}){const n=await xc(new fe.jI.payments.GetGiveawayInfo({peer:wi(e.id,e.accessHash),msgId:t}));if(n)return function(e){if(e instanceof fe.jI.payments.GiveawayInfo){const{startDate:t,adminDisallowedChatId:n,disallowedCountry:s,joinedTooEarlyDate:i,participating:o,preparingResults:a}=e;return{type:"active",startDate:t,isParticipating:o,adminDisallowedChatId:n&&ps(n,"channel"),disallowedCountry:s,joinedTooEarlyDate:i,isPreparingResults:a}}{const{activatedCount:t,finishDate:n,giftCodeSlug:s,winner:i,refunded:o,startDate:a,winnersCount:r,starsPrize:d}=e;return{type:"results",startDate:a,activatedCount:t,finishDate:n,winnersCount:r,giftCodeSlug:s,isRefunded:o,isWinner:i,starsPrize:d?.toJSNumber()}}}(n)}async function Bg({slug:e}){const t=await xc(new fe.jI.payments.CheckGiftCode({slug:e}));if(t)return{code:nd(t)}}function Hg({slug:e}){return xc(new fe.jI.payments.ApplyGiftCode({slug:e}),{shouldReturnTrue:!0})}async function Gg({chat:e}){const t=await xc(new fe.jI.payments.GetPremiumGiftCodeOptions({boostPeer:e&&wi(e.id,e.accessHash)}));if(t)return t.map(sd)}async function Og({chat:e}){const t=await xc(new fe.jI.payments.GetStarsGiftOptions({userId:e&&wi(e.id,e.accessHash)}));if(t)return t.map(id)}async function qg(){const e=await xc(new fe.jI.payments.GetStarsGiveawayOptions);if(e)return e.map(ad)}async function Fg(){const e=await xc(new fe.jI.payments.GetStarGifts({}));if(e&&!(e instanceof fe.jI.payments.StarGiftsNotModified))return e.gifts.map(Ho).filter((e=>"starGift"===e.type))}async function Lg({peer:e,offset:t="",limit:n}){const s=await xc(new fe.jI.payments.GetSavedStarGifts({peer:wi(e.id,e.accessHash),offset:t,limit:n}));if(s)return{gifts:s.gifts.map((t=>function(e,t){const{gift:n,date:s,convertStars:i,fromId:o,message:a,msgId:r,nameHidden:d,unsaved:c,upgradeStars:u,transferStars:l,canUpgrade:f,savedId:h,canExportAt:p}=e,m=h&&t?{type:"chat",chatId:t,savedId:h.toString()}:r?{type:"user",messageId:r}:void 0;return{gift:Ho(n),date:s,starsToConvert:i?.toJSNumber(),fromId:o&&ms(o),message:a&&Mo(a),messageId:r,isNameHidden:d,isUnsaved:c,canUpgrade:f,alreadyPaidUpgradeStars:u?.toJSNumber(),transferStars:l?.toJSNumber(),inputGift:m,savedId:h?.toString(),canExportAt:p}}(t,e.id))),nextOffset:s.nextOffset}}function zg({inputGift:e,shouldUnsave:t}){return xc(new fe.jI.payments.SaveStarGift({stargift:Ji(e),unsave:t||void 0}))}function Vg({inputSavedGift:e}){return xc(new fe.jI.payments.ConvertStarGift({stargift:Ji(e)}))}function $g({chat:e,giveawayId:t,paymentPurpose:n}){return xc(new fe.jI.payments.LaunchPrepaidGiveaway({peer:wi(e.id,e.accessHash),giveawayId:vt()(t),purpose:qi(n)}),{shouldReturnTrue:!0})}async function Wg(){const e=await xc(new fe.jI.payments.GetStarsStatus({peer:new fe.jI.InputPeerSelf}));if(e)return{nextHistoryOffset:e.nextOffset,history:e.history?.map(dd),nextSubscriptionOffset:e.subscriptionsNextOffset,subscriptions:e.subscriptions?.map(cd),balance:od(e.balance)}}async function Kg({peer:e,offset:t,isInbound:n,isOutbound:s}){const i=e?wi(e.id,e.accessHash):new fe.jI.InputPeerSelf,o=await xc(new fe.jI.payments.GetStarsTransactions({peer:i,offset:t,inbound:n,outbound:s}));if(o)return{nextOffset:o.nextOffset,history:o.history?.map(dd),balance:od(o.balance)}}async function Jg({id:e,peer:t}){const n=t?wi(t.id,t.accessHash):new fe.jI.InputPeerSelf,s=await xc(new fe.jI.payments.GetStarsTransactionsByID({peer:n,id:[new fe.jI.InputStarsTransaction({id:e})]}));if(s?.history?.[0])return{transaction:dd(s?.history[0])}}async function Qg({offset:e,peer:t}){const n=t?wi(t.id,t.accessHash):new fe.jI.InputPeerSelf,s=await xc(new fe.jI.payments.GetStarsSubscriptions({peer:n,offset:e}));if(s?.subscriptions)return{nextOffset:s.subscriptionsNextOffset,subscriptions:s.subscriptions.map(cd),balance:od(s.balance)}}async function Yg({peer:e,subscriptionId:t,isCancelled:n}){return await xc(new fe.jI.payments.ChangeStarsSubscription({peer:e?wi(e.id,e.accessHash):new fe.jI.InputPeerSelf,subscriptionId:t,canceled:n}))}async function Xg({peer:e,subscriptionId:t}){return await xc(new fe.jI.payments.FulfillStarsSubscription({peer:e?wi(e.id,e.accessHash):new fe.jI.InputPeerSelf,subscriptionId:t}))}async function Zg(){const e=await xc(new fe.jI.payments.GetStarsTopupOptions);if(e)return e.map(ud)}async function eI({slug:e}){const t=await xc(new fe.jI.payments.GetUniqueStarGift({slug:e}));if(!t)return;const n=Ho(t.gift);return"starGiftUnique"===n.type?n:void 0}async function tI({giftId:e}){const t=await xc(new fe.jI.payments.GetStarGiftUpgradePreview({giftId:vt()(e)}));if(t)return t.sampleAttributes.map(Go).filter(Boolean)}function nI({inputSavedGift:e,shouldKeepOriginalDetails:t}){return xc(new fe.jI.payments.UpgradeStarGift({stargift:Ji(e),keepOriginalDetails:t}),{shouldReturnTrue:!0})}async function sI({inputGift:e,password:t}){try{const n=await vp(t);if(!n)return;if("error"in n)return n;const s=await xc(new fe.jI.payments.GetStarGiftWithdrawalUrl({stargift:Ji(e),password:n}),{shouldThrow:!0});if(!s)return;return{url:s.url}}catch(e){if(!Ts(e))return;return ks(e)}}async function iI(e){const t="username"in e?new fe.jI.InputCollectibleUsername({username:e.username}):new fe.jI.InputCollectiblePhone({phone:e.phone}),n=await xc(new fe.jI.fragment.GetCollectibleInfo({collectible:t}));if(n)return function(e){const{amount:t,currency:n,cryptoAmount:s,cryptoCurrency:i,purchaseDate:o,url:a}=e;return{amount:t.toJSNumber(),currency:n,cryptoAmount:s.toJSNumber(),cryptoCurrency:i,purchaseDate:o,url:a}}(n)}function oI(e,t,n){var s;!function(e){Ls=e}(e),n&&(s=n,Object.assign(Os,Gs(s))),async function(e){d&&console.log(">>> START INIT API");const{userAgent:t,platform:n,sessionData:s,isWebmSupported:i,maxBufferSize:r,webAuthToken:c,dcId:u,mockScenario:l,shouldForceHttpTransport:f,shouldAllowHttpTransport:h,shouldDebugExportedSenders:p,langCode:m,isTestServerRequested:g}=e,I=new mn(s,Dc);self.isWebmSupported=i,self.maxBufferSize=r,Mc=new ds(I,Number("1456095"),"a93a0ef15a108a2cf421466edfc0094e",{deviceModel:navigator.userAgent||t||Sc,systemVersion:n||jc,appVersion:`10.9.39 ${o}`,useWSS:!0,additionalDcsDisabled:a,shouldDebugExportedSenders:p,shouldForceHttpTransport:f,shouldAllowHttpTransport:h,dcId:u,langPack:K,langCode:m,systemLangCode:navigator.language,isTestServerRequested:g}),Mc.addEventHandler(Uc,Cc);try{d&&(Ms("CONNECTING"),self.invoke=xc,self.GramJs=fe.jI);try{Mc.setPingCallback(Bd),await Mc.start({phoneNumber:Kd,phoneCode:Jd,password:Qd,firstAndLastNames:Yd,qrCode:Xd,onError:Zd,initialMethod:"iOS"===n||"Android"===n?"phoneNumber":"qrCode",shouldThrowIfUnauthorized:Boolean(s),webAuthToken:c,webAuthTokenFailed:Wd,mockScenario:l})}catch(e){if(console.error(e),"Disconnect"!==e.message&&"Cannot send requests while disconnected"!==e.message)return void zs({"@type":"updateConnectionState",connectionState:"connectionStateBroken"})}d&&(console.log(">>> FINISH INIT API"),Ms("CONNECTED")),zs(ec("authorizationStateReady")),Dc(I.getSessionData()),zs({"@type":"updateApiReady"}),async function(e){Sd=e,await Fd(),Cd=!0,xd()}(xc),Fc()}catch(e){throw d&&Ms("CONNECTING ERROR",e),e}}(t)}const aI=ae.reduce(((e,t)=>(e[t]=console[t],e)),{});self.onerror=e=>{console.error(e),fI({type:"unhandledError",error:{message:e.error.message||"Uncaught exception in worker"}})},self.addEventListener("unhandledrejection",(e=>{console.error(e),fI({type:"unhandledError",error:{message:e.reason.message||"Uncaught rejection in worker"}})}));let rI=[],dI=[],cI=[];const uI=new Map;d&&console.log(">>> FINISH LOAD WORKER"),onmessage=({data:e})=>{e.payloads.forEach((async e=>{switch(e.type){case"initApi":{const{messageId:t,args:n}=e;await oI(hI,n[0],n[1]),t&&fI({type:"methodResponse",messageId:t,response:!0});break}case"callMethod":{const{messageId:t,name:n,args:s,withCallback:o}=e;try{if(t&&o){const e=(...e)=>{const n=e[e.length-1];fI({type:"methodCallback",messageId:t,callbackArgs:e},n instanceof ArrayBuffer?n:void 0)};uI.set(t,e),s.push(e)}const e=await function(e,...t){return i[e](...t)}(n,...s);d&&"object"==typeof e&&"CONSTRUCTOR_ID"in e&&Ms("UNEXPECTED RESPONSE",`${n}: ${e.className}`);const{arrayBuffer:a}="object"==typeof e&&"arrayBuffer"in e&&e||{};t&&fI({type:"methodResponse",messageId:t,response:e},a)}catch(e){d&&console.error(e),t&&fI({type:"methodResponse",messageId:t,error:{message:e.message}})}t&&uI.delete(t);break}case"cancelProgress":{const t=uI.get(e.messageId);t&&(t.isCanceled=!0);break}case"ping":fI({type:"methodResponse",messageId:e.messageId});break;case"toggleDebugMode":e.isEnabled?ae.forEach((e=>{console[e]=(...t)=>{postMessage({type:"debugLog",level:e,args:JSON.parse(JSON.stringify(t,((e,t)=>"bigint"==typeof t?t.toString():t)))})}})):ae.forEach((e=>{console[e]=aI[e]}))}}))};const lI=de((()=>{cI.length&&rI.unshift({type:"updates",updates:cI});const e={payloads:rI},t=dI;cI=[],rI=[],dI=[],t.length?postMessage(e,t):postMessage(e)}));function fI(e,t){rI.push(e),t&&dI.push(t),lI()}function hI(e){d&&"updateUserStatus"!==e["@type"]&&"updateServerTimeOffset"!==e["@type"]&&Ms("UPDATE",e["@type"],e),cI.push(e),lI()}},91157:(e,t,n)=>{n.d(t,{Gg:()=>h,Jk:()=>m,MN:()=>S,ON:()=>y,QR:()=>C,YT:()=>c,by:()=>u,e8:()=>g,gS:()=>w,hw:()=>v,ik:()=>p,op:()=>r,qV:()=>f,sc:()=>I,yr:()=>d,yy:()=>b,zi:()=>l});var s=n(92096),i=n.n(s),o=n(33313),a=n(48287).hp;function r(e,t=!0,n=!1){let s=a.from(e);const o=s.length;t&&(s=s.reverse());let r=i()(s.toString("hex"),16);return n&&Math.floor(r.toString(2).length/8)>=o&&(r=r.subtract(i()(2).pow(i()(8*o)))),r}function d(e,t=8){const n=i()(e),s=[];for(let e=0;e<t;e++)s[e]=n.shiftRight(8*e).and(255).toJSNumber();return a.from(s)}function c(e,t,n=!0,s=!1){const o=e.bitLength().toJSNumber();if(t<Math.ceil(o/8))throw new Error("OverflowError: int too big to convert");if(!s&&e.lesser(i()(0)))throw new Error("Cannot convert to unsigned");let r=!1;e.lesser(i()(0))&&(r=!0,e=e.abs());const d=e.toString(16).padStart(2*t,"0");let c=a.from(d,"hex");if(s&&r){c[c.length-1]=256-c[c.length-1];for(let e=0;e<c.length-1;e++)c[e]=255-c[e]}return n&&(c=c.reverse()),c}function u(e=!0){return r(h(8),!0,e)}function l(e,t){return(e%t+t)%t}function f(e,t){return e.remainder(t).add(t).remainder(t)}function h(e){return a.from((0,o.po)(e))}async function p(e,t){const n=d(e,16),s=d(t,32),[i,o,r]=await Promise.all([g(a.concat([s,n])),g(a.concat([n,s])),g(a.concat([s,s]))]);return{key:a.concat([i,o.slice(0,12)]),iv:a.concat([o.slice(12,20),r,s.slice(0,4)])}}function m(e){const t=a.alloc(4*e.length);for(let n=0;n<e.length;n++)t.writeUInt32BE(e[n],4*n);return t}function g(e){const t=(0,o.n1)("sha1");return t.update(e),t.digest()}function I(e){const t=(0,o.n1)("sha256");return t.update(e),t.digest()}function w(e,t,n){e=e.remainder(n);let s=i().one,o=e;for(;t.greater(i().zero);){const e=t.remainder(i()(2));t=t.divide(i()(2)),e.eq(i().one)&&(s=s.multiply(o),s=s.remainder(n)),o=o.multiply(o),o=o.remainder(n)}return s}function y(e,t=!1){const n=e.toString(2).length,s=Math.floor((n+8-1)/8);return c(i()(e),s,!1,t)}function v(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function b(e){return new Promise((t=>{setTimeout(t,e)}))}function S(e,t){const n=[];for(let s=0;s<e.length;s++)n.push(e[s]^t[s]);return a.from(n)}const j=(()=>{let e;const t=[];for(let n=0;n<256;n++){e=n;for(let t=0;t<8;t++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})();function C(e){a.isBuffer(e)||(e=a.from(e));let t=-1;for(let n=0;n<e.length;n++){const s=e[n];t=j[255&(t^s)]^t>>>8}return~t>>>0}},33313:(e,t,n)=>{n.d(t,{Tt:()=>h,_7:()=>f,n1:()=>I,Az:()=>g,po:()=>p});var s=n(7692);const i=1===new Uint8Array(new Uint32Array([16909060]))[0],o=i?function(e){return e.buffer}:function(e){const t=new Uint8Array(4*e.length);let n=0;for(let s=0;s<e.length;s++){const i=e[s];t[n++]=i>>>24,t[n++]=i>>16&255,t[n++]=i>>8&255,t[n++]=255&i}return t.buffer},a=i?function(e){return new Uint32Array(e)}:function(e){const t=new Uint8Array(e),n=new Uint32Array(t.length/4);for(let e=0;e<t.length;e+=4)n[e/4]=t[e]<<24^t[e+1]<<16^t[e+2]<<8^t[e+3];return n};var r=n(86001),d=n(48287).hp;function c(e,t,n){var s;return(t="symbol"==typeof(s=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(t))?s:s+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class u{constructor(e){c(this,"_counter",void 0),this._counter=d.from(e)}increment(){for(let e=15;e>=0;e--){if(255!==this._counter[e]){this._counter[e]++;break}this._counter[e]=0}}}class l{constructor(e,t){c(this,"_counter",void 0),c(this,"_remainingCounter",void 0),c(this,"_remainingCounterIndex",void 0),c(this,"_aes",void 0),t instanceof u||(t=new u(t)),this._counter=t,this._remainingCounter=void 0,this._remainingCounterIndex=16,this._aes=new s.Ay((0,r.gB)(e))}update(e){return this.encrypt(e)}encrypt(e){const t=d.from(e);for(let e=0;e<t.length;e++)16===this._remainingCounterIndex&&(this._remainingCounter=d.from(o(this._aes.encrypt(a(this._counter._counter)))),this._remainingCounterIndex=0,this._counter.increment()),this._remainingCounter&&(t[e]^=this._remainingCounter[this._remainingCounterIndex++]);return t}}function f(e,t,n){if(e.includes("ECB"))throw new Error("Not supported");return new l(t,n)}function h(e,t,n){if(e.includes("ECB"))throw new Error("Not supported");return new l(t,n)}function p(e){const t=new Uint8Array(e);return crypto.getRandomValues(t),t}class m{constructor(e){this.algorithm=e,c(this,"data",new Uint8Array(0))}update(e){this.data=new Uint8Array(e)}async digest(){return"sha1"===this.algorithm?d.from(await self.crypto.subtle.digest("SHA-1",this.data)):d.from(await self.crypto.subtle.digest("SHA-256",this.data))}}async function g(e,t,n){const s=await crypto.subtle.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]);return d.from(await crypto.subtle.deriveBits({name:"PBKDF2",hash:"SHA-512",salt:t,iterations:n},s,512))}function I(e){return new m(e)}},86001:(e,t,n)=>{function s(e){if(e instanceof Uint32Array)return e;if("string"==typeof e){if(e.length%4!=0)for(let t=e.length%4;t<=4;t++)e+="\0x00";const s=new Uint32Array(e.length/4);for(let i=0;i<e.length;i+=4)s[i/4]=(n=i,(t=e).charCodeAt(n)<<24^t.charCodeAt(n+1)<<16^t.charCodeAt(n+2)<<8^t.charCodeAt(n+3));return s}var t,n;if(e instanceof Uint8Array){const t=new Uint32Array(e.length/4);for(let n=0;n<e.length;n+=4)t[n/4]=e[n]<<24^e[n+1]<<16^e[n+2]<<8^e[n+3];return t}throw new Error("Unable to create 32-bit words")}n.d(t,{gB:()=>s})},59430:(e,t,n)=>{n.d(t,{A9:()=>l,Ce:()=>u,ls:()=>f});var s=n(91157),i=n(48287).hp;const o=new Set([3162085175,2574415285,1072550713,3300522427,1450380236]),a=new Set([85337187,2211011308,2851430293,1013613780,1459478408,3504867164,3045658042,1715713620,3608339646,4110704415,812830625]),r=(e,t,n=[])=>{e.flags.includes("g")||(e=new RegExp(e.source,"g"));const s=e.exec(t);return s&&(n.push(s.slice(1)),r(e,t,n)),n},d=(e,t)=>{const n=e.match(/([\w.]+)(?:#([0-9a-fA-F]+))?(?:\s{?\w+:[\w\d<>#.?!]+}?)*\s=\s([\w\d<>#.?]+);$/);if(!n)throw new Error(`Cannot parse TLObject ${e}`);const o=r(/({)?(\w+):([\w\d<>#.?!]+)}?/,e),a={name:n[1],constructorId:parseInt(n[2],16),argsConfig:{},subclassOfId:(0,s.QR)(n[3]),result:n[3],isFunction:t,namespace:void 0};if(!a.constructorId){const e="";let t;t=Object.values(a.argsConfig).length?` ${Object.keys(a.argsConfig).map((e=>e.toString())).join(" ")}`:"";const n=`${a.name}${e}${t} = ${a.result}`.replace(/(:|\?)bytes /g,"$1string ").replace(/</g," ").replace(/>|{|}/g,"").replace(/ \w+:flags\d*\.\d+\?true/g,"");"inputMediaInvoice"===a.name&&a.name,a.constructorId=(0,s.QR)(i.from(n,"utf8"))}for(const[e,t,n]of o)void 0===e&&(a.argsConfig[(d=t,d.replace(/([-_][a-z])/g,(e=>e.toUpperCase().replace("-","").replace("_",""))))]=c(t,n));var d;return a.name.includes(".")&&([a.namespace,a.name]=a.name.split(/\.(.+)/)),a.name=a.name.replace(/(?:^|_)([a-z])/g,((e,t)=>t.toUpperCase())).replace(/_/g,""),a};function c(e,t){e="self"===e?"is_self":e;const n={isVector:!1,isFlag:!1,skipConstructorId:!1,flagGroup:0,flagIndex:-1,flagIndicator:!0,type:"",useVectorId:void 0};if("#"!==t){n.flagIndicator=!1,n.type=t.replace(/^!+/,"");const e=n.type.match(/flags(\d*)\.(\d+)\?([\w<>.]+)/);e&&(n.isFlag=!0,n.flagGroup=Number(e[1]||1),n.flagIndex=Number(e[2]),[,,,n.type]=e);const s=n.type.match(/[Vv]ector<([\w\d.]+)>/);s&&(n.isVector=!0,n.useVectorId="V"===n.type.charAt(0),[,n.type]=s),/^[a-z]$/.test(n.type.split(".").pop().charAt(0))&&(n.skipConstructorId=!0)}return n}function*u(e,t=[],n=o){(t||[]).reduce(((e,t)=>({...e,[t.name]:t})),{});const s=[],i={},r={},c=e;let u=!1;for(let e of c.split("\n")){const t=e.indexOf("//");if(-1!==t&&(e=e.slice(0,t)),e=e.trim(),!e)continue;const o=e.match(/---(\w+)---/);if(o){const[,e]=o;u="functions"===e}else try{const t=d(e,u);if(n.has(t.constructorId))continue;s.push(t),t.isFunction||(r[t.result]||(r[t.result]=[]),i[t.name]=t,r[t.result].push(t))}catch(e){if(!e.toString().includes("vector#1cb5c415"))throw e}}for(const e of s)if(a.has(e.constructorId))for(const t in e.argsConfig)"string"===e.argsConfig[t].type&&(e.argsConfig[t].type="bytes");for(const e of s)yield e}function l(e){if(!(e instanceof i)){if("string"!=typeof e)throw Error(`Bytes or str expected, not ${e.constructor.name}`);e=i.from(e)}const t=[];let n;return e.length<254?(n=(e.length+1)%4,0!==n&&(n=4-n),t.push(i.from([e.length])),t.push(e)):(n=e.length%4,0!==n&&(n=4-n),t.push(i.from([254,e.length%256,(e.length>>8)%256,(e.length>>16)%256])),t.push(e)),t.push(i.alloc(n).fill(0)),i.concat(t)}function f(e){if(!e)return i.alloc(4).fill(0);if(e instanceof Date&&(e=Math.floor((Date.now()-e.getTime())/1e3)),"number"==typeof e){const t=i.alloc(4);return t.writeInt32LE(e,0),t}throw Error(`Cannot interpret "${e}" as a date`)}},17473:(e,t,n)=>{n.d(t,{A9:()=>i.A9,jI:()=>s.A});var s=n(18320),i=n(59430)}},s={};function i(e){var t=s[e];if(void 0!==t)return t.exports;var o=s[e]={id:e,loaded:!1,exports:{}};return n[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=n,i.x=()=>{var e=i.O(void 0,[7784,8287,2786,580],(()=>i(38570)));return i.O(e)},e=[],i.O=(t,n,s,o)=>{if(!n){var a=1/0;for(u=0;u<e.length;u++){for(var[n,s,o]=e[u],r=!0,d=0;d<n.length;d++)(!1&o||a>=o)&&Object.keys(i.O).every((e=>i.O[e](n[d])))?n.splice(d--,1):(r=!1,o<a&&(a=o));if(r){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,s,o]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+"."+{580:"a127a10ebeaf6e15ce62",2786:"8822cfc420377e0acc77",7784:"4e167a928464165e6412",8287:"9cf863b4d9b47c10d271"}[e]+".js",i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var s=n.length-1;s>-1&&(!e||!/^http(s?):/.test(e));)e=n[s--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={8570:1};i.f.i=(t,n)=>{e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunktelegram_t=self.webpackChunktelegram_t||[],n=t.push.bind(t);t.push=t=>{var[s,o,a]=t;for(var r in o)i.o(o,r)&&(i.m[r]=o[r]);for(a&&a(i);s.length;)e[s.pop()]=1;n(t)}})(),t=i.x,i.x=()=>Promise.all([7784,8287,2786,580].map(i.e,i)).then(t),i.x()})();
//# sourceMappingURL=8570.c92e71a7d0937609dbfa.js.map